%!PS-Adobe-3.0
%%BoundingBox: 24 24 588 768
%%Title: enscript output
%%For: Jeff Donahoo
%%Creator: GNU enscript 1.4.0
%%CreationDate: Tue Aug 29 15:37:02 2000
%%Orientation: Landscape
%%Pages: (atend)
%%DocumentMedia: Letter 612 792 0 () ()
%%DocumentNeededResources: (atend)
%%EndComments
%%BeginProlog
%%BeginResource: procset Enscript-Prolog 1.4 0
%
% Procedures.
%

/_S {	% save current state
  /_s save def
} def
/_R {	% restore from saved state
  _s restore
} def

/S {	% showpage protecting gstate
  gsave
  showpage
  grestore
} bind def

/MF {	% fontname newfontname -> -	make a new encoded font
  /newfontname exch def
  /fontname exch def

  /fontdict fontname findfont def
  /newfont fontdict maxlength dict def

  fontdict {
    exch 
    dup /FID eq {
      % skip FID pair
      pop pop
    } {
      % copy to the new font dictionary
      exch newfont 3 1 roll put
    } ifelse
  } forall
  
  newfont /FontName newfontname put

  % insert only valid encoding vectors
  encoding_vector length 256 eq {
    newfont /Encoding encoding_vector put
  } if
  
  newfontname newfont definefont pop
} def

/M {moveto} bind def
/s {show} bind def

/Box {	% x y w h -> -			define box path
  /d_h exch def /d_w exch def /d_y exch def /d_x exch def
  d_x d_y  moveto 
  d_w 0 rlineto 
  0 d_h rlineto 
  d_w neg 0 rlineto 
  closepath
} def

% Highlight bars.
/highlight_bars {	% nlines lineheight output_y_margin gray -> -
  gsave
    setgray
    /ymarg exch def
    /lineheight exch def
    /nlines exch def

    % This 2 is just a magic number to sync highlight lines to text.
    0 d_header_y ymarg sub 2 sub translate
    
    /cw d_output_w cols div def
    /nrows d_output_h ymarg 2 mul sub lineheight div floor def

    % for each column
    0 1 cols 1 sub {
      cw mul /xp exch def

      % for each rows
      0 1 nrows 1 sub {
        /rn exch def 
        rn lineheight mul neg /yp exch def
        rn nlines idiv 2 mod 0 eq {
	  % Draw highlight bar.  4 is just a magic indentation.
	  xp 4 add yp cw 8 sub lineheight neg Box fill	  
	} if
      } for
    } for
    
  grestore
} def

% Line highlight bar.
/line_highlight {	% x y width height gray -> -
  gsave
    /gray exch def
    Box gray setgray fill
  grestore
} def

% Column separator lines.
/column_lines {
  gsave
    .1 setlinewidth
    0 d_footer_h translate
    /cw d_output_w cols div def
    1 1 cols 1 sub {
      cw mul 0 moveto
      0 d_output_h rlineto stroke
    } for
  grestore
} def

% Column borders.
/column_borders {
  gsave
    .1 setlinewidth
    0 d_footer_h moveto 
    0 d_output_h rlineto
    d_output_w 0 rlineto
    0 d_output_h neg rlineto
    closepath stroke
  grestore
} def

% Do the actual underlay drawing
/draw_underlay {
  ul_style 0 eq {
    ul_str true charpath stroke
  } { 
    ul_str show
  } ifelse
} def

% Underlay
/underlay {	% - -> -
  gsave
    0 d_page_h translate
    d_page_h neg d_page_w atan rotate

    ul_gray setgray
    ul_font setfont
    /dw d_page_h dup mul d_page_w dup mul add sqrt def
    ul_str stringwidth pop dw exch sub 2 div ul_ptsize -2 div moveto 
    draw_underlay
  grestore
} def

/user_underlay {	% - -> -
  gsave
    ul_x ul_y translate
    ul_angle rotate
    ul_gray setgray
    ul_font setfont 
    0 0 ul_ptsize 2 div sub moveto 
    draw_underlay
  grestore
} def

% Page prefeed
/page_prefeed {		% bool -> -
  statusdict /prefeed known {
    statusdict exch /prefeed exch put
  } {
    pop
  } ifelse
} def

% EPSF import.

/BeginEPSF {
  /b4_Inc_state save def    		% Save state for cleanup
  /dict_count countdictstack def	% Count objects on dict stack
  /op_count count 1 sub def		% Count objects on operand stack 
  userdict begin
  /showpage { } def
  0 setgray 0 setlinecap
  1 setlinewidth 0 setlinejoin
  10 setmiterlimit [ ] 0 setdash newpath
  /languagelevel where {
    pop languagelevel
    1 ne {
      false setstrokeadjust false setoverprint 
    } if
  } if
} bind def

/EndEPSF {
  count op_count sub { pos } repeat	% Clean up stacks
  countdictstack dict_count sub { end } repeat
  b4_Inc_state restore
} bind def

% Check PostScript language level.
/languagelevel where {
  pop /gs_languagelevel languagelevel def
} {
  /gs_languagelevel 1 def
} ifelse
%%EndResource
%%BeginResource: procset Enscript-Encoding-latin1 1.4 0
/encoding_vector [
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/space        	/exclam       	/quotedbl     	/numbersign   	
/dollar       	/percent      	/ampersand    	/quoteright   	
/parenleft    	/parenright   	/asterisk     	/plus         	
/comma        	/minus        	/period       	/slash        	
/zero         	/one          	/two          	/three        	
/four         	/five         	/six          	/seven        	
/eight        	/nine         	/colon        	/semicolon    	
/less         	/equal        	/greater      	/question     	
/at           	/A            	/B            	/C            	
/D            	/E            	/F            	/G            	
/H            	/I            	/J            	/K            	
/L            	/M            	/N            	/O            	
/P            	/Q            	/R            	/S            	
/T            	/U            	/V            	/W            	
/X            	/Y            	/Z            	/bracketleft  	
/backslash    	/bracketright 	/asciicircum  	/underscore   	
/quoteleft    	/a            	/b            	/c            	
/d            	/e            	/f            	/g            	
/h            	/i            	/j            	/k            	
/l            	/m            	/n            	/o            	
/p            	/q            	/r            	/s            	
/t            	/u            	/v            	/w            	
/x            	/y            	/z            	/braceleft    	
/bar          	/braceright   	/tilde        	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/space        	/exclamdown   	/cent         	/sterling     	
/currency     	/yen          	/brokenbar    	/section      	
/dieresis     	/copyright    	/ordfeminine  	/guillemotleft	
/logicalnot   	/hyphen       	/registered   	/macron       	
/degree       	/plusminus    	/twosuperior  	/threesuperior	
/acute        	/mu           	/paragraph    	/bullet       	
/cedilla      	/dotlessi     	/ordmasculine 	/guillemotright	
/onequarter   	/onehalf      	/threequarters	/questiondown 	
/Agrave       	/Aacute       	/Acircumflex  	/Atilde       	
/Adieresis    	/Aring        	/AE           	/Ccedilla     	
/Egrave       	/Eacute       	/Ecircumflex  	/Edieresis    	
/Igrave       	/Iacute       	/Icircumflex  	/Idieresis    	
/Eth          	/Ntilde       	/Ograve       	/Oacute       	
/Ocircumflex  	/Otilde       	/Odieresis    	/multiply     	
/Oslash       	/Ugrave       	/Uacute       	/Ucircumflex  	
/Udieresis    	/Yacute       	/Thorn        	/germandbls   	
/agrave       	/aacute       	/acircumflex  	/atilde       	
/adieresis    	/aring        	/ae           	/ccedilla     	
/egrave       	/eacute       	/ecircumflex  	/edieresis    	
/igrave       	/iacute       	/icircumflex  	/idieresis    	
/eth          	/ntilde       	/ograve       	/oacute       	
/ocircumflex  	/otilde       	/odieresis    	/divide       	
/oslash       	/ugrave       	/uacute       	/ucircumflex  	
/udieresis    	/yacute       	/thorn        	/ydieresis    	
] def
%%EndResource
%%EndProlog
%%BeginSetup
%%IncludeResource: font Courier-Bold
%%IncludeResource: font Courier
/user_header_p false def
/HFpt 10 def
/Courier-Bold /HF-gs-font MF
/HF /HF-gs-font findfont HFpt scalefont def
/Courier /F-gs-font MF
/F-gs-font findfont 7 scalefont setfont
/#copies 1 def
%%BeginResource: procset Enscript-Header-simple 1.4 0

/do_header {	% print default simple header
  gsave
    d_header_x d_header_y HFpt 3 div add translate

    HF setfont
    user_header_p {
      5 0 moveto user_header_str show
    } {
      5 0 moveto fname show
      45 0 rmoveto fmodstr show
      45 0 rmoveto pagenum 10 string cvs show
    } ifelse

  grestore
} def
%%EndResource
/d_page_w 744 def
/d_page_h 564 def
/d_header_x 0 def
/d_header_y 549 def
/d_header_w 744 def
/d_header_h 15 def
/d_footer_x 0 def
/d_footer_y 0 def
/d_footer_w 744 def
/d_footer_h 0 def
/d_output_w 744 def
/d_output_h 549 def
/cols 2 def
%%EndSetup
%%Page: (1) 1
%%BeginPageSetup
_S
90 rotate
24 -588 translate
/pagenum 1 def
/fname (rfc793.txt) def
/fdir () def
/ftail (rfc793.txt) def
% User defined strings:
/fmodstr (Thu Aug %2d 13:52:57 2000) def
%%EndPageSetup
do_header
5 539 M
(rfc793rfc793) s
5 531 M
(Press here to go to the top of the rfc 'tree'.) s
5 523 M
( ) s
5 515 M
( ) s
5 507 M
(RFC: 793) s
5 499 M
(                                    ) s
5 491 M
(                                    ) s
5 483 M
(                                    ) s
5 475 M
(                                    ) s
5 467 M
(                                    ) s
5 459 M
(                                    ) s
5 451 M
(                                    ) s
5 443 M
(                     TRANSMISSION CONTROL PROTOCOL) s
5 435 M
(                                    ) s
5 427 M
(                                    ) s
5 419 M
(                         DARPA INTERNET PROGRAM) s
5 411 M
(                                    ) s
5 403 M
(                         PROTOCOL SPECIFICATION) s
5 395 M
(                                    ) s
5 387 M
(                                    ) s
5 379 M
(                                    ) s
5 371 M
(                             September 1981) s
5 363 M
( ) s
5 355 M
( ) s
5 347 M
( ) s
5 339 M
( ) s
5 331 M
( ) s
5 323 M
( ) s
5 315 M
( ) s
5 307 M
( ) s
5 299 M
( ) s
5 291 M
( ) s
5 283 M
( ) s
5 275 M
( ) s
5 267 M
( ) s
5 259 M
(                              prepared for) s
5 251 M
(                                    ) s
5 243 M
(               Defense Advanced Research Projects Agency) s
5 235 M
(                Information Processing Techniques Office) s
5 227 M
(                         1400 Wilson Boulevard) s
5 219 M
(                       Arlington, Virginia  22209) s
5 211 M
( ) s
5 203 M
( ) s
5 195 M
( ) s
5 187 M
( ) s
5 179 M
( ) s
5 171 M
( ) s
5 163 M
( ) s
5 155 M
(                                   by) s
5 147 M
( ) s
5 139 M
(                     Information Sciences Institute) s
5 131 M
(                   University of Southern California) s
5 123 M
(                           4676 Admiralty Way) s
5 115 M
(                   Marina del Rey, California  90291) s
_R
S
%%Page: (2) 2
%%BeginPageSetup
_S
90 rotate
24 -588 translate
/pagenum 2 def
/fname (rfc793.txt) def
/fdir () def
/ftail (rfc793.txt) def
% User defined strings:
/fmodstr (Thu Aug %2d 13:52:57 2000) def
%%EndPageSetup
do_header
5 531 M
( ) s
5 523 M
(September 1981                                                          ) s
5 515 M
(                                           Transmission Control Protocol) s
5 507 M
( ) s
5 499 M
( ) s
5 491 M
( ) s
5 483 M
(                           TABLE OF CONTENTS) s
5 475 M
( ) s
5 467 M
(    PREFACE ........................................................ iii) s
5 459 M
( ) s
5 451 M
(1.  INTRODUCTION ..................................................... 1) s
5 443 M
( ) s
5 435 M
(  1.1  Motivation .................................................... 1) s
5 427 M
(  1.2  Scope ......................................................... 2) s
5 419 M
(  1.3  About This Document ........................................... 2) s
5 411 M
(  1.4  Interfaces .................................................... 3) s
5 403 M
(  1.5  Operation ..................................................... 3) s
5 395 M
( ) s
5 387 M
(2.  PHILOSOPHY ....................................................... 7) s
5 379 M
( ) s
5 371 M
(  2.1  Elements of the Internetwork System ........................... 7) s
5 363 M
(  2.2  Model of Operation ............................................ 7) s
5 355 M
(  2.3  The Host Environment .......................................... 8) s
5 347 M
(  2.4  Interfaces .................................................... 9) s
5 339 M
(  2.5  Relation to Other Protocols ................................... 9) s
5 331 M
(  2.6  Reliable Communication ........................................ 9) s
5 323 M
(  2.7  Connection Establishment and Clearing ........................ 10) s
5 315 M
(  2.8  Data Communication ........................................... 12) s
5 307 M
(  2.9  Precedence and Security ...................................... 13) s
5 299 M
(  2.10 Robustness Principle ......................................... 13) s
5 291 M
( ) s
5 283 M
(3.  FUNCTIONAL SPECIFICATION ........................................ 15) s
5 275 M
( ) s
5 267 M
(  3.1  Header Format ................................................ 15) s
5 259 M
(  3.2  Terminology .................................................. 19) s
5 251 M
(  3.3  Sequence Numbers ............................................. 24) s
5 243 M
(  3.4  Establishing a connection .................................... 30) s
5 235 M
(  3.5  Closing a Connection ......................................... 37) s
5 227 M
(  3.6  Precedence and Security ...................................... 40) s
5 219 M
(  3.7  Data Communication ........................................... 40) s
5 211 M
(  3.8  Interfaces ................................................... 44) s
5 203 M
(  3.9  Event Processing ............................................. 52) s
5 195 M
( ) s
5 187 M
(GLOSSARY ............................................................ 79) s
5 179 M
( ) s
5 171 M
(REFERENCES .......................................................... 85) s
5 163 M
( ) s
5 155 M
( ) s
5 147 M
( ) s
5 139 M
( ) s
5 131 M
( ) s
5 123 M
( ) s
5 115 M
( ) s
5 107 M
( ) s
5 99 M
( ) s
5 91 M
( ) s
5 83 M
( ) s
5 75 M
(                                                                [Page i]) s
377 531 M
( ) s
377 523 M
(                                                          September 1981) s
377 515 M
(Transmission Control Protocol) s
377 507 M
( ) s
377 499 M
( ) s
377 491 M
( ) s
377 483 M
( ) s
377 475 M
( ) s
377 467 M
( ) s
377 459 M
( ) s
377 451 M
( ) s
377 443 M
( ) s
377 435 M
( ) s
377 427 M
( ) s
377 419 M
( ) s
377 411 M
( ) s
377 403 M
( ) s
377 395 M
( ) s
377 387 M
( ) s
377 379 M
( ) s
377 371 M
( ) s
377 363 M
( ) s
377 355 M
( ) s
377 347 M
( ) s
377 339 M
( ) s
377 331 M
( ) s
377 323 M
( ) s
377 315 M
( ) s
377 307 M
( ) s
377 299 M
( ) s
377 291 M
( ) s
377 283 M
( ) s
377 275 M
( ) s
377 267 M
( ) s
377 259 M
( ) s
377 251 M
( ) s
377 243 M
( ) s
377 235 M
( ) s
377 227 M
( ) s
377 219 M
( ) s
377 211 M
( ) s
377 203 M
( ) s
377 195 M
( ) s
377 187 M
( ) s
377 179 M
( ) s
377 171 M
( ) s
377 163 M
( ) s
377 155 M
( ) s
377 147 M
( ) s
377 139 M
( ) s
377 131 M
( ) s
377 123 M
( ) s
377 115 M
( ) s
377 107 M
( ) s
377 99 M
( ) s
377 91 M
( ) s
377 83 M
( ) s
377 75 M
([Page ii]                                                               ) s
_R
S
%%Page: (3) 3
%%BeginPageSetup
_S
90 rotate
24 -588 translate
/pagenum 3 def
/fname (rfc793.txt) def
/fdir () def
/ftail (rfc793.txt) def
% User defined strings:
/fmodstr (Thu Aug %2d 13:52:57 2000) def
%%EndPageSetup
do_header
5 531 M
( ) s
5 523 M
(September 1981                                                          ) s
5 515 M
(                                           Transmission Control Protocol) s
5 507 M
( ) s
5 499 M
( ) s
5 491 M
( ) s
5 483 M
(                                PREFACE) s
5 475 M
( ) s
5 467 M
( ) s
5 459 M
( ) s
5 451 M
(This document describes the DoD Standard Transmission Control Protocol) s
5 443 M
(\(TCP\).  There have been nine earlier editions of the ARPA TCP) s
5 435 M
(specification on which this standard is based, and the present text) s
5 427 M
(draws heavily from them.  There have been many contributors to this work) s
5 419 M
(both in terms of concepts and in terms of text.  This edition clarifies) s
5 411 M
(several details and removes the end-of-letter buffer-size adjustments,) s
5 403 M
(and redescribes the letter mechanism as a push function.) s
5 395 M
( ) s
5 387 M
(                                                           Jon Postel) s
5 379 M
( ) s
5 371 M
(                                                           Editor) s
5 363 M
( ) s
5 355 M
( ) s
5 347 M
( ) s
5 339 M
( ) s
5 331 M
( ) s
5 323 M
( ) s
5 315 M
( ) s
5 307 M
( ) s
5 299 M
( ) s
5 291 M
( ) s
5 283 M
( ) s
5 275 M
( ) s
5 267 M
( ) s
5 259 M
( ) s
5 251 M
( ) s
5 243 M
( ) s
5 235 M
( ) s
5 227 M
( ) s
5 219 M
( ) s
5 211 M
( ) s
5 203 M
( ) s
5 195 M
( ) s
5 187 M
( ) s
5 179 M
( ) s
5 171 M
( ) s
5 163 M
( ) s
5 155 M
( ) s
5 147 M
( ) s
5 139 M
( ) s
5 131 M
( ) s
5 123 M
( ) s
5 115 M
( ) s
5 107 M
( ) s
5 99 M
( ) s
5 91 M
( ) s
5 83 M
( ) s
5 75 M
(                                                              [Page iii]) s
_R
S
%%Page: (4) 4
%%BeginPageSetup
_S
90 rotate
24 -588 translate
/pagenum 4 def
/fname (rfc793.txt) def
/fdir () def
/ftail (rfc793.txt) def
% User defined strings:
/fmodstr (Thu Aug %2d 13:52:57 2000) def
%%EndPageSetup
do_header
5 531 M
( ) s
5 523 M
( ) s
5 515 M
(RFC:  793) s
5 507 M
(Replaces: RFC 761) s
5 499 M
(IENs:  129, 124, 112, 81,) s
5 491 M
(55, 44, 40, 27, 21, 5) s
5 483 M
( ) s
5 475 M
(                     TRANSMISSION CONTROL PROTOCOL) s
5 467 M
( ) s
5 459 M
(                         DARPA INTERNET PROGRAM) s
5 451 M
(                         PROTOCOL SPECIFICATION) s
5 443 M
( ) s
5 435 M
( ) s
5 427 M
( ) s
5 419 M
(                            1.  INTRODUCTION) s
5 411 M
( ) s
5 403 M
(The Transmission Control Protocol \(TCP\) is intended for use as a highly) s
5 395 M
(reliable host-to-host protocol between hosts in packet-switched computer) s
5 387 M
(communication networks, and in interconnected systems of such networks.) s
5 379 M
( ) s
5 371 M
(This document describes the functions to be performed by the) s
5 363 M
(Transmission Control Protocol, the program that implements it, and its) s
5 355 M
(interface to programs or users that require its services.) s
5 347 M
( ) s
5 339 M
(1.1.  Motivation) s
5 331 M
( ) s
5 323 M
(  Computer communication systems are playing an increasingly important) s
5 315 M
(  role in military, government, and civilian environments.  This) s
5 307 M
(  document focuses its attention primarily on military computer) s
5 299 M
(  communication requirements, especially robustness in the presence of) s
5 291 M
(  communication unreliability and availability in the presence of) s
5 283 M
(  congestion, but many of these problems are found in the civilian and) s
5 275 M
(  government sector as well.) s
5 267 M
( ) s
5 259 M
(  As strategic and tactical computer communication networks are) s
5 251 M
(  developed and deployed, it is essential to provide means of) s
5 243 M
(  interconnecting them and to provide standard interprocess) s
5 235 M
(  communication protocols which can support a broad range of) s
5 227 M
(  applications.  In anticipation of the need for such standards, the) s
5 219 M
(  Deputy Undersecretary of Defense for Research and Engineering has) s
5 211 M
(  declared the Transmission Control Protocol \(TCP\) described herein to) s
5 203 M
(  be a basis for DoD-wide inter-process communication protocol) s
5 195 M
(  standardization.) s
5 187 M
( ) s
5 179 M
(  TCP is a connection-oriented, end-to-end reliable protocol designed to) s
5 171 M
(  fit into a layered hierarchy of protocols which support multi-network) s
5 163 M
(  applications.  The TCP provides for reliable inter-process) s
5 155 M
(  communication between pairs of processes in host computers attached to) s
5 147 M
(  distinct but interconnected computer communication networks.  Very few) s
5 139 M
(  assumptions are made as to the reliability of the communication) s
5 131 M
(  protocols below the TCP layer.  TCP assumes it can obtain a simple,) s
5 123 M
(  potentially unreliable datagram service from the lower level) s
5 115 M
(  protocols.  In principle, the TCP should be able to operate above a) s
5 107 M
(  wide spectrum of communication systems ranging from hard-wired) s
5 99 M
(  connections to packet-switched or circuit-switched networks.) s
5 91 M
( ) s
5 83 M
( ) s
5 75 M
(                                                                [Page 1]) s
377 531 M
( ) s
377 523 M
(                                                          September 1981) s
377 515 M
(Transmission Control Protocol) s
377 507 M
(Introduction) s
377 499 M
( ) s
377 491 M
( ) s
377 483 M
( ) s
377 475 M
(  TCP is based on concepts first described by Cerf and Kahn in [1].  The) s
377 467 M
(  TCP fits into a layered protocol architecture just above a basic) s
377 459 M
(  Internet Protocol [2] which provides a way for the TCP to send and) s
377 451 M
(  receive variable-length segments of information enclosed in internet) s
377 443 M
(  datagram "envelopes".  The internet datagram provides a means for) s
377 435 M
(  addressing source and destination TCPs in different networks.  The) s
377 427 M
(  internet protocol also deals with any fragmentation or reassembly of) s
377 419 M
(  the TCP segments required to achieve transport and delivery through) s
377 411 M
(  multiple networks and interconnecting gateways.  The internet protocol) s
377 403 M
(  also carries information on the precedence, security classification) s
377 395 M
(  and compartmentation of the TCP segments, so this information can be) s
377 387 M
(  communicated end-to-end across multiple networks.) s
377 379 M
( ) s
377 371 M
(                           Protocol Layering) s
377 363 M
( ) s
377 355 M
(                        +---------------------+) s
377 347 M
(                        |     higher-level    |) s
377 339 M
(                        +---------------------+) s
377 331 M
(                        |        TCP          |) s
377 323 M
(                        +---------------------+) s
377 315 M
(                        |  internet protocol  |) s
377 307 M
(                        +---------------------+) s
377 299 M
(                        |communication network|) s
377 291 M
(                        +---------------------+) s
377 283 M
( ) s
377 275 M
(                                Figure 1) s
377 267 M
( ) s
377 259 M
(  Much of this document is written in the context of TCP implementations) s
377 251 M
(  which are co-resident with higher level protocols in the host) s
377 243 M
(  computer.  Some computer systems will be connected to networks via) s
377 235 M
(  front-end computers which house the TCP and internet protocol layers,) s
377 227 M
(  as well as network specific software.  The TCP specification describes) s
377 219 M
(  an interface to the higher level protocols which appears to be) s
377 211 M
(  implementable even for the front-end case, as long as a suitable) s
377 203 M
(  host-to-front end protocol is implemented.) s
377 195 M
( ) s
377 187 M
(1.2.  Scope) s
377 179 M
( ) s
377 171 M
(  The TCP is intended to provide a reliable process-to-process) s
377 163 M
(  communication service in a multinetwork environment.  The TCP is) s
377 155 M
(  intended to be a host-to-host protocol in common use in multiple) s
377 147 M
(  networks.) s
377 139 M
( ) s
377 131 M
(1.3.  About this Document) s
377 123 M
( ) s
377 115 M
(  This document represents a specification of the behavior required of) s
377 107 M
(  any TCP implementation, both in its interactions with higher level) s
377 99 M
(  protocols and in its interactions with other TCPs.  The rest of this) s
377 91 M
( ) s
377 83 M
( ) s
377 75 M
([Page 2]                                                                ) s
_R
S
%%Page: (5) 5
%%BeginPageSetup
_S
90 rotate
24 -588 translate
/pagenum 5 def
/fname (rfc793.txt) def
/fdir () def
/ftail (rfc793.txt) def
% User defined strings:
/fmodstr (Thu Aug %2d 13:52:57 2000) def
%%EndPageSetup
do_header
5 531 M
( ) s
5 523 M
(September 1981                                                          ) s
5 515 M
(                                           Transmission Control Protocol) s
5 507 M
(                                                            Introduction) s
5 499 M
( ) s
5 491 M
( ) s
5 483 M
( ) s
5 475 M
(  section offers a very brief view of the protocol interfaces and) s
5 467 M
(  operation.  Section 2 summarizes the philosophical basis for the TCP) s
5 459 M
(  design.  Section 3 offers both a detailed description of the actions) s
5 451 M
(  required of TCP when various events occur \(arrival of new segments,) s
5 443 M
(  user calls, errors, etc.\) and the details of the formats of TCP) s
5 435 M
(  segments.) s
5 427 M
( ) s
5 419 M
(1.4.  Interfaces) s
5 411 M
( ) s
5 403 M
(  The TCP interfaces on one side to user or application processes and on) s
5 395 M
(  the other side to a lower level protocol such as Internet Protocol.) s
5 387 M
( ) s
5 379 M
(  The interface between an application process and the TCP is) s
5 371 M
(  illustrated in reasonable detail.  This interface consists of a set of) s
5 363 M
(  calls much like the calls an operating system provides to an) s
5 355 M
(  application process for manipulating files.  For example, there are) s
5 347 M
(  calls to open and close connections and to send and receive data on) s
5 339 M
(  established connections.  It is also expected that the TCP can) s
5 331 M
(  asynchronously communicate with application programs.  Although) s
5 323 M
(  considerable freedom is permitted to TCP implementors to design) s
5 315 M
(  interfaces which are appropriate to a particular operating system) s
5 307 M
(  environment, a minimum functionality is required at the TCP/user) s
5 299 M
(  interface for any valid implementation.) s
5 291 M
( ) s
5 283 M
(  The interface between TCP and lower level protocol is essentially) s
5 275 M
(  unspecified except that it is assumed there is a mechanism whereby the) s
5 267 M
(  two levels can asynchronously pass information to each other.) s
5 259 M
(  Typically, one expects the lower level protocol to specify this) s
5 251 M
(  interface.  TCP is designed to work in a very general environment of) s
5 243 M
(  interconnected networks.  The lower level protocol which is assumed) s
5 235 M
(  throughout this document is the Internet Protocol [2].) s
5 227 M
( ) s
5 219 M
(1.5.  Operation) s
5 211 M
( ) s
5 203 M
(  As noted above, the primary purpose of the TCP is to provide reliable,) s
5 195 M
(  securable logical circuit or connection service between pairs of) s
5 187 M
(  processes.  To provide this service on top of a less reliable internet) s
5 179 M
(  communication system requires facilities in the following areas:) s
5 171 M
( ) s
5 163 M
(    Basic Data Transfer) s
5 155 M
(    Reliability) s
5 147 M
(    Flow Control) s
5 139 M
(    Multiplexing) s
5 131 M
(    Connections) s
5 123 M
(    Precedence and Security) s
5 115 M
( ) s
5 107 M
(  The basic operation of the TCP in each of these areas is described in) s
5 99 M
(  the following paragraphs.) s
5 91 M
( ) s
5 83 M
( ) s
5 75 M
(                                                                [Page 3]) s
377 531 M
( ) s
377 523 M
(                                                          September 1981) s
377 515 M
(Transmission Control Protocol) s
377 507 M
(Introduction) s
377 499 M
( ) s
377 491 M
( ) s
377 483 M
( ) s
377 475 M
(  Basic Data Transfer:) s
377 467 M
( ) s
377 459 M
(    The TCP is able to transfer a continuous stream of octets in each) s
377 451 M
(    direction between its users by packaging some number of octets into) s
377 443 M
(    segments for transmission through the internet system.  In general,) s
377 435 M
(    the TCPs decide when to block and forward data at their own) s
377 427 M
(    convenience.) s
377 419 M
( ) s
377 411 M
(    Sometimes users need to be sure that all the data they have) s
377 403 M
(    submitted to the TCP has been transmitted.  For this purpose a push) s
377 395 M
(    function is defined.  To assure that data submitted to a TCP is) s
377 387 M
(    actually transmitted the sending user indicates that it should be) s
377 379 M
(    pushed through to the receiving user.  A push causes the TCPs to) s
377 371 M
(    promptly forward and deliver data up to that point to the receiver.) s
377 363 M
(    The exact push point might not be visible to the receiving user and) s
377 355 M
(    the push function does not supply a record boundary marker.) s
377 347 M
( ) s
377 339 M
(  Reliability:) s
377 331 M
( ) s
377 323 M
(    The TCP must recover from data that is damaged, lost, duplicated, or) s
377 315 M
(    delivered out of order by the internet communication system.  This) s
377 307 M
(    is achieved by assigning a sequence number to each octet) s
377 299 M
(    transmitted, and requiring a positive acknowledgment \(ACK\) from the) s
377 291 M
(    receiving TCP.  If the ACK is not received within a timeout) s
377 283 M
(    interval, the data is retransmitted.  At the receiver, the sequence) s
377 275 M
(    numbers are used to correctly order segments that may be received) s
377 267 M
(    out of order and to eliminate duplicates.  Damage is handled by) s
377 259 M
(    adding a checksum to each segment transmitted, checking it at the) s
377 251 M
(    receiver, and discarding damaged segments.) s
377 243 M
( ) s
377 235 M
(    As long as the TCPs continue to function properly and the internet) s
377 227 M
(    system does not become completely partitioned, no transmission) s
377 219 M
(    errors will affect the correct delivery of data.  TCP recovers from) s
377 211 M
(    internet communication system errors.) s
377 203 M
( ) s
377 195 M
(  Flow Control:) s
377 187 M
( ) s
377 179 M
(    TCP provides a means for the receiver to govern the amount of data) s
377 171 M
(    sent by the sender.  This is achieved by returning a "window" with) s
377 163 M
(    every ACK indicating a range of acceptable sequence numbers beyond) s
377 155 M
(    the last segment successfully received.  The window indicates an) s
377 147 M
(    allowed number of octets that the sender may transmit before) s
377 139 M
(    receiving further permission.) s
377 131 M
( ) s
377 123 M
( ) s
377 115 M
( ) s
377 107 M
( ) s
377 99 M
( ) s
377 91 M
( ) s
377 83 M
( ) s
377 75 M
([Page 4]                                                                ) s
_R
S
%%Page: (6) 6
%%BeginPageSetup
_S
90 rotate
24 -588 translate
/pagenum 6 def
/fname (rfc793.txt) def
/fdir () def
/ftail (rfc793.txt) def
% User defined strings:
/fmodstr (Thu Aug %2d 13:52:57 2000) def
%%EndPageSetup
do_header
5 531 M
( ) s
5 523 M
(September 1981                                                          ) s
5 515 M
(                                           Transmission Control Protocol) s
5 507 M
(                                                            Introduction) s
5 499 M
( ) s
5 491 M
( ) s
5 483 M
( ) s
5 475 M
(  Multiplexing:) s
5 467 M
( ) s
5 459 M
(    To allow for many processes within a single Host to use TCP) s
5 451 M
(    communication facilities simultaneously, the TCP provides a set of) s
5 443 M
(    addresses or ports within each host.  Concatenated with the network) s
5 435 M
(    and host addresses from the internet communication layer, this forms) s
5 427 M
(    a socket.  A pair of sockets uniquely identifies each connection.) s
5 419 M
(    That is, a socket may be simultaneously used in multiple) s
5 411 M
(    connections.) s
5 403 M
( ) s
5 395 M
(    The binding of ports to processes is handled independently by each) s
5 387 M
(    Host.  However, it proves useful to attach frequently used processes) s
5 379 M
(    \(e.g., a "logger" or timesharing service\) to fixed sockets which are) s
5 371 M
(    made known to the public.  These services can then be accessed) s
5 363 M
(    through the known addresses.  Establishing and learning the port) s
5 355 M
(    addresses of other processes may involve more dynamic mechanisms.) s
5 347 M
( ) s
5 339 M
(  Connections:) s
5 331 M
( ) s
5 323 M
(    The reliability and flow control mechanisms described above require) s
5 315 M
(    that TCPs initialize and maintain certain status information for) s
5 307 M
(    each data stream.  The combination of this information, including) s
5 299 M
(    sockets, sequence numbers, and window sizes, is called a connection.) s
5 291 M
(    Each connection is uniquely specified by a pair of sockets) s
5 283 M
(    identifying its two sides.) s
5 275 M
( ) s
5 267 M
(    When two processes wish to communicate, their TCP's must first) s
5 259 M
(    establish a connection \(initialize the status information on each) s
5 251 M
(    side\).  When their communication is complete, the connection is) s
5 243 M
(    terminated or closed to free the resources for other uses.) s
5 235 M
( ) s
5 227 M
(    Since connections must be established between unreliable hosts and) s
5 219 M
(    over the unreliable internet communication system, a handshake) s
5 211 M
(    mechanism with clock-based sequence numbers is used to avoid) s
5 203 M
(    erroneous initialization of connections.) s
5 195 M
( ) s
5 187 M
(  Precedence and Security:) s
5 179 M
( ) s
5 171 M
(    The users of TCP may indicate the security and precedence of their) s
5 163 M
(    communication.  Provision is made for default values to be used when) s
5 155 M
(    these features are not needed.) s
5 147 M
( ) s
5 139 M
(    ) s
5 131 M
( ) s
5 123 M
( ) s
5 115 M
( ) s
5 107 M
( ) s
5 99 M
( ) s
5 91 M
( ) s
5 83 M
( ) s
5 75 M
(                                                                [Page 5]) s
377 531 M
( ) s
377 523 M
(                                                          September 1981) s
377 515 M
(Transmission Control Protocol) s
377 507 M
( ) s
377 499 M
( ) s
377 491 M
( ) s
377 483 M
( ) s
377 475 M
( ) s
377 467 M
( ) s
377 459 M
( ) s
377 451 M
( ) s
377 443 M
( ) s
377 435 M
( ) s
377 427 M
( ) s
377 419 M
( ) s
377 411 M
( ) s
377 403 M
( ) s
377 395 M
( ) s
377 387 M
( ) s
377 379 M
( ) s
377 371 M
( ) s
377 363 M
( ) s
377 355 M
( ) s
377 347 M
( ) s
377 339 M
( ) s
377 331 M
( ) s
377 323 M
( ) s
377 315 M
( ) s
377 307 M
( ) s
377 299 M
( ) s
377 291 M
( ) s
377 283 M
( ) s
377 275 M
( ) s
377 267 M
( ) s
377 259 M
( ) s
377 251 M
( ) s
377 243 M
( ) s
377 235 M
( ) s
377 227 M
( ) s
377 219 M
( ) s
377 211 M
( ) s
377 203 M
( ) s
377 195 M
( ) s
377 187 M
( ) s
377 179 M
( ) s
377 171 M
( ) s
377 163 M
( ) s
377 155 M
( ) s
377 147 M
( ) s
377 139 M
( ) s
377 131 M
( ) s
377 123 M
( ) s
377 115 M
( ) s
377 107 M
( ) s
377 99 M
( ) s
377 91 M
( ) s
377 83 M
( ) s
377 75 M
([Page 6]                                                                ) s
_R
S
%%Page: (7) 7
%%BeginPageSetup
_S
90 rotate
24 -588 translate
/pagenum 7 def
/fname (rfc793.txt) def
/fdir () def
/ftail (rfc793.txt) def
% User defined strings:
/fmodstr (Thu Aug %2d 13:52:57 2000) def
%%EndPageSetup
do_header
5 531 M
( ) s
5 523 M
(September 1981                                                          ) s
5 515 M
(                                           Transmission Control Protocol) s
5 507 M
( ) s
5 499 M
( ) s
5 491 M
( ) s
5 483 M
(                             2.  PHILOSOPHY) s
5 475 M
( ) s
5 467 M
(2.1.  Elements of the Internetwork System) s
5 459 M
( ) s
5 451 M
(  The internetwork environment consists of hosts connected to networks) s
5 443 M
(  which are in turn interconnected via gateways.  It is assumed here) s
5 435 M
(  that the networks may be either local networks \(e.g., the ETHERNET\) or) s
5 427 M
(  large networks \(e.g., the ARPANET\), but in any case are based on) s
5 419 M
(  packet switching technology.  The active agents that produce and) s
5 411 M
(  consume messages are processes.  Various levels of protocols in the) s
5 403 M
(  networks, the gateways, and the hosts support an interprocess) s
5 395 M
(  communication system that provides two-way data flow on logical) s
5 387 M
(  connections between process ports.) s
5 379 M
( ) s
5 371 M
(  The term packet is used generically here to mean the data of one) s
5 363 M
(  transaction between a host and its network.  The format of data blocks) s
5 355 M
(  exchanged within the a network will generally not be of concern to us.) s
5 347 M
( ) s
5 339 M
(  Hosts are computers attached to a network, and from the communication) s
5 331 M
(  network's point of view, are the sources and destinations of packets.) s
5 323 M
(  Processes are viewed as the active elements in host computers \(in) s
5 315 M
(  accordance with the fairly common definition of a process as a program) s
5 307 M
(  in execution\).  Even terminals and files or other I/O devices are) s
5 299 M
(  viewed as communicating with each other through the use of processes.) s
5 291 M
(  Thus, all communication is viewed as inter-process communication.) s
5 283 M
( ) s
5 275 M
(  Since a process may need to distinguish among several communication) s
5 267 M
(  streams between itself and another process \(or processes\), we imagine) s
5 259 M
(  that each process may have a number of ports through which it) s
5 251 M
(  communicates with the ports of other processes.) s
5 243 M
( ) s
5 235 M
(2.2.  Model of Operation) s
5 227 M
( ) s
5 219 M
(  Processes transmit data by calling on the TCP and passing buffers of) s
5 211 M
(  data as arguments.  The TCP packages the data from these buffers into) s
5 203 M
(  segments and calls on the internet module to transmit each segment to) s
5 195 M
(  the destination TCP.  The receiving TCP places the data from a segment) s
5 187 M
(  into the receiving user's buffer and notifies the receiving user.  The) s
5 179 M
(  TCPs include control information in the segments which they use to) s
5 171 M
(  ensure reliable ordered data transmission.) s
5 163 M
( ) s
5 155 M
(  The model of internet communication is that there is an internet) s
5 147 M
(  protocol module associated with each TCP which provides an interface) s
5 139 M
(  to the local network.  This internet module packages TCP segments) s
5 131 M
(  inside internet datagrams and routes these datagrams to a destination) s
5 123 M
(  internet module or intermediate gateway.  To transmit the datagram) s
5 115 M
(  through the local network, it is embedded in a local network packet.) s
5 107 M
( ) s
5 99 M
(  The packet switches may perform further packaging, fragmentation, or) s
5 91 M
( ) s
5 83 M
( ) s
5 75 M
(                                                                [Page 7]) s
377 531 M
( ) s
377 523 M
(                                                          September 1981) s
377 515 M
(Transmission Control Protocol) s
377 507 M
(Philosophy) s
377 499 M
( ) s
377 491 M
( ) s
377 483 M
( ) s
377 475 M
(  other operations to achieve the delivery of the local packet to the) s
377 467 M
(  destination internet module.) s
377 459 M
( ) s
377 451 M
(  At a gateway between networks, the internet datagram is "unwrapped") s
377 443 M
(  from its local packet and examined to determine through which network) s
377 435 M
(  the internet datagram should travel next.  The internet datagram is) s
377 427 M
(  then "wrapped" in a local packet suitable to the next network and) s
377 419 M
(  routed to the next gateway, or to the final destination.) s
377 411 M
( ) s
377 403 M
(  A gateway is permitted to break up an internet datagram into smaller) s
377 395 M
(  internet datagram fragments if this is necessary for transmission) s
377 387 M
(  through the next network.  To do this, the gateway produces a set of) s
377 379 M
(  internet datagrams; each carrying a fragment.  Fragments may be) s
377 371 M
(  further broken into smaller fragments at subsequent gateways.  The) s
377 363 M
(  internet datagram fragment format is designed so that the destination) s
377 355 M
(  internet module can reassemble fragments into internet datagrams.) s
377 347 M
( ) s
377 339 M
(  A destination internet module unwraps the segment from the datagram) s
377 331 M
(  \(after reassembling the datagram, if necessary\) and passes it to the) s
377 323 M
(  destination TCP.) s
377 315 M
( ) s
377 307 M
(  This simple model of the operation glosses over many details.  One) s
377 299 M
(  important feature is the type of service.  This provides information) s
377 291 M
(  to the gateway \(or internet module\) to guide it in selecting the) s
377 283 M
(  service parameters to be used in traversing the next network.) s
377 275 M
(  Included in the type of service information is the precedence of the) s
377 267 M
(  datagram.  Datagrams may also carry security information to permit) s
377 259 M
(  host and gateways that operate in multilevel secure environments to) s
377 251 M
(  properly segregate datagrams for security considerations.) s
377 243 M
( ) s
377 235 M
(2.3.  The Host Environment) s
377 227 M
( ) s
377 219 M
(  The TCP is assumed to be a module in an operating system.  The users) s
377 211 M
(  access the TCP much like they would access the file system.  The TCP) s
377 203 M
(  may call on other operating system functions, for example, to manage) s
377 195 M
(  data structures.  The actual interface to the network is assumed to be) s
377 187 M
(  controlled by a device driver module.  The TCP does not call on the) s
377 179 M
(  network device driver directly, but rather calls on the internet) s
377 171 M
(  datagram protocol module which may in turn call on the device driver.) s
377 163 M
( ) s
377 155 M
(  The mechanisms of TCP do not preclude implementation of the TCP in a) s
377 147 M
(  front-end processor.  However, in such an implementation, a) s
377 139 M
(  host-to-front-end protocol must provide the functionality to support) s
377 131 M
(  the type of TCP-user interface described in this document.) s
377 123 M
( ) s
377 115 M
( ) s
377 107 M
( ) s
377 99 M
( ) s
377 91 M
( ) s
377 83 M
( ) s
377 75 M
([Page 8]                                                                ) s
_R
S
%%Page: (8) 8
%%BeginPageSetup
_S
90 rotate
24 -588 translate
/pagenum 8 def
/fname (rfc793.txt) def
/fdir () def
/ftail (rfc793.txt) def
% User defined strings:
/fmodstr (Thu Aug %2d 13:52:57 2000) def
%%EndPageSetup
do_header
5 531 M
( ) s
5 523 M
(September 1981                                                          ) s
5 515 M
(                                           Transmission Control Protocol) s
5 507 M
(                                                              Philosophy) s
5 499 M
( ) s
5 491 M
( ) s
5 483 M
( ) s
5 475 M
(2.4.  Interfaces) s
5 467 M
( ) s
5 459 M
(  The TCP/user interface provides for calls made by the user on the TCP) s
5 451 M
(  to OPEN or CLOSE a connection, to SEND or RECEIVE data, or to obtain) s
5 443 M
(  STATUS about a connection.  These calls are like other calls from user) s
5 435 M
(  programs on the operating system, for example, the calls to open, read) s
5 427 M
(  from, and close a file.) s
5 419 M
( ) s
5 411 M
(  The TCP/internet interface provides calls to send and receive) s
5 403 M
(  datagrams addressed to TCP modules in hosts anywhere in the internet) s
5 395 M
(  system.  These calls have parameters for passing the address, type of) s
5 387 M
(  service, precedence, security, and other control information.) s
5 379 M
( ) s
5 371 M
(2.5.  Relation to Other Protocols) s
5 363 M
( ) s
5 355 M
(  The following diagram illustrates the place of the TCP in the protocol) s
5 347 M
(  hierarchy:) s
5 339 M
( ) s
5 331 M
(                                    ) s
5 323 M
(       +------+ +-----+ +-----+       +-----+                    ) s
5 315 M
(       |Telnet| | FTP | |Voice|  ...  |     |  Application Level ) s
5 307 M
(       +------+ +-----+ +-----+       +-----+                    ) s
5 299 M
(             |   |         |             |                       ) s
5 291 M
(            +-----+     +-----+       +-----+                    ) s
5 283 M
(            | TCP |     | RTP |  ...  |     |  Host Level        ) s
5 275 M
(            +-----+     +-----+       +-----+                    ) s
5 267 M
(               |           |             |                       ) s
5 259 M
(            +-------------------------------+                    ) s
5 251 M
(            |    Internet Protocol & ICMP   |  Gateway Level     ) s
5 243 M
(            +-------------------------------+                    ) s
5 235 M
(                           |                                     ) s
5 227 M
(              +---------------------------+                      ) s
5 219 M
(              |   Local Network Protocol  |    Network Level     ) s
5 211 M
(              +---------------------------+                      ) s
5 203 M
( ) s
5 195 M
(                         Protocol Relationships) s
5 187 M
( ) s
5 179 M
(                               Figure 2.) s
5 171 M
( ) s
5 163 M
(  It is expected that the TCP will be able to support higher level) s
5 155 M
(  protocols efficiently.  It should be easy to interface higher level) s
5 147 M
(  protocols like the ARPANET Telnet or AUTODIN II THP to the TCP.) s
5 139 M
( ) s
5 131 M
(2.6.  Reliable Communication) s
5 123 M
( ) s
5 115 M
(  A stream of data sent on a TCP connection is delivered reliably and in) s
5 107 M
(  order at the destination.) s
5 99 M
( ) s
5 91 M
( ) s
5 83 M
( ) s
5 75 M
(                                                                [Page 9]) s
377 531 M
( ) s
377 523 M
(                                                          September 1981) s
377 515 M
(Transmission Control Protocol) s
377 507 M
(Philosophy) s
377 499 M
( ) s
377 491 M
( ) s
377 483 M
( ) s
377 475 M
(  Transmission is made reliable via the use of sequence numbers and) s
377 467 M
(  acknowledgments.  Conceptually, each octet of data is assigned a) s
377 459 M
(  sequence number.  The sequence number of the first octet of data in a) s
377 451 M
(  segment is transmitted with that segment and is called the segment) s
377 443 M
(  sequence number.  Segments also carry an acknowledgment number which) s
377 435 M
(  is the sequence number of the next expected data octet of) s
377 427 M
(  transmissions in the reverse direction.  When the TCP transmits a) s
377 419 M
(  segment containing data, it puts a copy on a retransmission queue and) s
377 411 M
(  starts a timer; when the acknowledgment for that data is received, the) s
377 403 M
(  segment is deleted from the queue.  If the acknowledgment is not) s
377 395 M
(  received before the timer runs out, the segment is retransmitted.) s
377 387 M
( ) s
377 379 M
(  An acknowledgment by TCP does not guarantee that the data has been) s
377 371 M
(  delivered to the end user, but only that the receiving TCP has taken) s
377 363 M
(  the responsibility to do so.) s
377 355 M
( ) s
377 347 M
(  To govern the flow of data between TCPs, a flow control mechanism is) s
377 339 M
(  employed.  The receiving TCP reports a "window" to the sending TCP.) s
377 331 M
(  This window specifies the number of octets, starting with the) s
377 323 M
(  acknowledgment number, that the receiving TCP is currently prepared to) s
377 315 M
(  receive.) s
377 307 M
( ) s
377 299 M
(2.7.  Connection Establishment and Clearing) s
377 291 M
( ) s
377 283 M
(  To identify the separate data streams that a TCP may handle, the TCP) s
377 275 M
(  provides a port identifier.  Since port identifiers are selected) s
377 267 M
(  independently by each TCP they might not be unique.  To provide for) s
377 259 M
(  unique addresses within each TCP, we concatenate an internet address) s
377 251 M
(  identifying the TCP with a port identifier to create a socket which) s
377 243 M
(  will be unique throughout all networks connected together.) s
377 235 M
( ) s
377 227 M
(  A connection is fully specified by the pair of sockets at the ends.  A) s
377 219 M
(  local socket may participate in many connections to different foreign) s
377 211 M
(  sockets.  A connection can be used to carry data in both directions,) s
377 203 M
(  that is, it is "full duplex".) s
377 195 M
( ) s
377 187 M
(  TCPs are free to associate ports with processes however they choose.) s
377 179 M
(  However, several basic concepts are necessary in any implementation.) s
377 171 M
(  There must be well-known sockets which the TCP associates only with) s
377 163 M
(  the "appropriate" processes by some means.  We envision that processes) s
377 155 M
(  may "own" ports, and that processes can initiate connections only on) s
377 147 M
(  the ports they own.  \(Means for implementing ownership is a local) s
377 139 M
(  issue, but we envision a Request Port user command, or a method of) s
377 131 M
(  uniquely allocating a group of ports to a given process, e.g., by) s
377 123 M
(  associating the high order bits of a port name with a given process.\)) s
377 115 M
( ) s
377 107 M
(  A connection is specified in the OPEN call by the local port and) s
377 99 M
(  foreign socket arguments.  In return, the TCP supplies a \(short\) local) s
377 91 M
( ) s
377 83 M
( ) s
377 75 M
([Page 10]                                                               ) s
_R
S
%%Page: (9) 9
%%BeginPageSetup
_S
90 rotate
24 -588 translate
/pagenum 9 def
/fname (rfc793.txt) def
/fdir () def
/ftail (rfc793.txt) def
% User defined strings:
/fmodstr (Thu Aug %2d 13:52:57 2000) def
%%EndPageSetup
do_header
5 531 M
( ) s
5 523 M
(September 1981                                                          ) s
5 515 M
(                                           Transmission Control Protocol) s
5 507 M
(                                                              Philosophy) s
5 499 M
( ) s
5 491 M
( ) s
5 483 M
( ) s
5 475 M
(  connection name by which the user refers to the connection in) s
5 467 M
(  subsequent calls.  There are several things that must be remembered) s
5 459 M
(  about a connection.  To store this information we imagine that there) s
5 451 M
(  is a data structure called a Transmission Control Block \(TCB\).  One) s
5 443 M
(  implementation strategy would have the local connection name be a) s
5 435 M
(  pointer to the TCB for this connection.  The OPEN call also specifies) s
5 427 M
(  whether the connection establishment is to be actively pursued, or to) s
5 419 M
(  be passively waited for.) s
5 411 M
( ) s
5 403 M
(  A passive OPEN request means that the process wants to accept incoming) s
5 395 M
(  connection requests rather than attempting to initiate a connection.) s
5 387 M
(  Often the process requesting a passive OPEN will accept a connection) s
5 379 M
(  request from any caller.  In this case a foreign socket of all zeros) s
5 371 M
(  is used to denote an unspecified socket.  Unspecified foreign sockets) s
5 363 M
(  are allowed only on passive OPENs.) s
5 355 M
( ) s
5 347 M
(  A service process that wished to provide services for unknown other) s
5 339 M
(  processes would issue a passive OPEN request with an unspecified) s
5 331 M
(  foreign socket.  Then a connection could be made with any process that) s
5 323 M
(  requested a connection to this local socket.  It would help if this) s
5 315 M
(  local socket were known to be associated with this service.) s
5 307 M
( ) s
5 299 M
(  Well-known sockets are a convenient mechanism for a priori associating) s
5 291 M
(  a socket address with a standard service.  For instance, the) s
5 283 M
(  "Telnet-Server" process is permanently assigned to a particular) s
5 275 M
(  socket, and other sockets are reserved for File Transfer, Remote Job) s
5 267 M
(  Entry, Text Generator, Echoer, and Sink processes \(the last three) s
5 259 M
(  being for test purposes\).  A socket address might be reserved for) s
5 251 M
(  access to a "Look-Up" service which would return the specific socket) s
5 243 M
(  at which a newly created service would be provided.  The concept of a) s
5 235 M
(  well-known socket is part of the TCP specification, but the assignment) s
5 227 M
(  of sockets to services is outside this specification.  \(See [4].\)) s
5 219 M
( ) s
5 211 M
(  Processes can issue passive OPENs and wait for matching active OPENs) s
5 203 M
(  from other processes and be informed by the TCP when connections have) s
5 195 M
(  been established.  Two processes which issue active OPENs to each) s
5 187 M
(  other at the same time will be correctly connected.  This flexibility) s
5 179 M
(  is critical for the support of distributed computing in which) s
5 171 M
(  components act asynchronously with respect to each other.) s
5 163 M
( ) s
5 155 M
(  There are two principal cases for matching the sockets in the local) s
5 147 M
(  passive OPENs and an foreign active OPENs.  In the first case, the) s
5 139 M
(  local passive OPENs has fully specified the foreign socket.  In this) s
5 131 M
(  case, the match must be exact.  In the second case, the local passive) s
5 123 M
(  OPENs has left the foreign socket unspecified.  In this case, any) s
5 115 M
(  foreign socket is acceptable as long as the local sockets match.) s
5 107 M
(  Other possibilities include partially restricted matches.) s
5 99 M
( ) s
5 91 M
( ) s
5 83 M
( ) s
5 75 M
(                                                               [Page 11]) s
377 531 M
( ) s
377 523 M
(                                                          September 1981) s
377 515 M
(Transmission Control Protocol) s
377 507 M
(Philosophy) s
377 499 M
( ) s
377 491 M
( ) s
377 483 M
( ) s
377 475 M
(  If there are several pending passive OPENs \(recorded in TCBs\) with the) s
377 467 M
(  same local socket, an foreign active OPEN will be matched to a TCB) s
377 459 M
(  with the specific foreign socket in the foreign active OPEN, if such a) s
377 451 M
(  TCB exists, before selecting a TCB with an unspecified foreign socket.) s
377 443 M
( ) s
377 435 M
(  The procedures to establish connections utilize the synchronize \(SYN\)) s
377 427 M
(  control flag and involves an exchange of three messages.  This) s
377 419 M
(  exchange has been termed a three-way hand shake [3].) s
377 411 M
( ) s
377 403 M
(  A connection is initiated by the rendezvous of an arriving segment) s
377 395 M
(  containing a SYN and a waiting TCB entry each created by a user OPEN) s
377 387 M
(  command.  The matching of local and foreign sockets determines when a) s
377 379 M
(  connection has been initiated.  The connection becomes "established") s
377 371 M
(  when sequence numbers have been synchronized in both directions.) s
377 363 M
( ) s
377 355 M
(  The clearing of a connection also involves the exchange of segments,) s
377 347 M
(  in this case carrying the FIN control flag.) s
377 339 M
( ) s
377 331 M
(2.8.  Data Communication) s
377 323 M
( ) s
377 315 M
(  The data that flows on a connection may be thought of as a stream of) s
377 307 M
(  octets.  The sending user indicates in each SEND call whether the data) s
377 299 M
(  in that call \(and any preceeding calls\) should be immediately pushed) s
377 291 M
(  through to the receiving user by the setting of the PUSH flag.) s
377 283 M
( ) s
377 275 M
(  A sending TCP is allowed to collect data from the sending user and to) s
377 267 M
(  send that data in segments at its own convenience, until the push) s
377 259 M
(  function is signaled, then it must send all unsent data.  When a) s
377 251 M
(  receiving TCP sees the PUSH flag, it must not wait for more data from) s
377 243 M
(  the sending TCP before passing the data to the receiving process.) s
377 235 M
( ) s
377 227 M
(  There is no necessary relationship between push functions and segment) s
377 219 M
(  boundaries.  The data in any particular segment may be the result of a) s
377 211 M
(  single SEND call, in whole or part, or of multiple SEND calls.) s
377 203 M
( ) s
377 195 M
(  The purpose of push function and the PUSH flag is to push data through) s
377 187 M
(  from the sending user to the receiving user.  It does not provide a) s
377 179 M
(  record service.) s
377 171 M
( ) s
377 163 M
(  There is a coupling between the push function and the use of buffers) s
377 155 M
(  of data that cross the TCP/user interface.  Each time a PUSH flag is) s
377 147 M
(  associated with data placed into the receiving user's buffer, the) s
377 139 M
(  buffer is returned to the user for processing even if the buffer is) s
377 131 M
(  not filled.  If data arrives that fills the user's buffer before a) s
377 123 M
(  PUSH is seen, the data is passed to the user in buffer size units.) s
377 115 M
( ) s
377 107 M
(  TCP also provides a means to communicate to the receiver of data that) s
377 99 M
(  at some point further along in the data stream than the receiver is) s
377 91 M
( ) s
377 83 M
( ) s
377 75 M
([Page 12]                                                               ) s
_R
S
%%Page: (10) 10
%%BeginPageSetup
_S
90 rotate
24 -588 translate
/pagenum 10 def
/fname (rfc793.txt) def
/fdir () def
/ftail (rfc793.txt) def
% User defined strings:
/fmodstr (Thu Aug %2d 13:52:57 2000) def
%%EndPageSetup
do_header
5 531 M
( ) s
5 523 M
(September 1981                                                          ) s
5 515 M
(                                           Transmission Control Protocol) s
5 507 M
(                                                              Philosophy) s
5 499 M
( ) s
5 491 M
( ) s
5 483 M
( ) s
5 475 M
(  currently reading there is urgent data.  TCP does not attempt to) s
5 467 M
(  define what the user specifically does upon being notified of pending) s
5 459 M
(  urgent data, but the general notion is that the receiving process will) s
5 451 M
(  take action to process the urgent data quickly.) s
5 443 M
( ) s
5 435 M
(2.9.  Precedence and Security) s
5 427 M
( ) s
5 419 M
(  The TCP makes use of the internet protocol type of service field and) s
5 411 M
(  security option to provide precedence and security on a per connection) s
5 403 M
(  basis to TCP users.  Not all TCP modules will necessarily function in) s
5 395 M
(  a multilevel secure environment; some may be limited to unclassified) s
5 387 M
(  use only, and others may operate at only one security level and) s
5 379 M
(  compartment.  Consequently, some TCP implementations and services to) s
5 371 M
(  users may be limited to a subset of the multilevel secure case.) s
5 363 M
( ) s
5 355 M
(  TCP modules which operate in a multilevel secure environment must) s
5 347 M
(  properly mark outgoing segments with the security, compartment, and) s
5 339 M
(  precedence.  Such TCP modules must also provide to their users or) s
5 331 M
(  higher level protocols such as Telnet or THP an interface to allow) s
5 323 M
(  them to specify the desired security level, compartment, and) s
5 315 M
(  precedence of connections.) s
5 307 M
( ) s
5 299 M
(2.10.  Robustness Principle) s
5 291 M
( ) s
5 283 M
(  TCP implementations will follow a general principle of robustness:  be) s
5 275 M
(  conservative in what you do, be liberal in what you accept from) s
5 267 M
(  others.) s
5 259 M
( ) s
5 251 M
(  ) s
5 243 M
( ) s
5 235 M
( ) s
5 227 M
( ) s
5 219 M
( ) s
5 211 M
( ) s
5 203 M
( ) s
5 195 M
( ) s
5 187 M
( ) s
5 179 M
( ) s
5 171 M
( ) s
5 163 M
( ) s
5 155 M
( ) s
5 147 M
( ) s
5 139 M
( ) s
5 131 M
( ) s
5 123 M
( ) s
5 115 M
( ) s
5 107 M
( ) s
5 99 M
( ) s
5 91 M
( ) s
5 83 M
( ) s
5 75 M
(                                                               [Page 13]) s
377 531 M
( ) s
377 523 M
(                                                          September 1981) s
377 515 M
(Transmission Control Protocol) s
377 507 M
( ) s
377 499 M
( ) s
377 491 M
( ) s
377 483 M
( ) s
377 475 M
( ) s
377 467 M
( ) s
377 459 M
( ) s
377 451 M
( ) s
377 443 M
( ) s
377 435 M
( ) s
377 427 M
( ) s
377 419 M
( ) s
377 411 M
( ) s
377 403 M
( ) s
377 395 M
( ) s
377 387 M
( ) s
377 379 M
( ) s
377 371 M
( ) s
377 363 M
( ) s
377 355 M
( ) s
377 347 M
( ) s
377 339 M
( ) s
377 331 M
( ) s
377 323 M
( ) s
377 315 M
( ) s
377 307 M
( ) s
377 299 M
( ) s
377 291 M
( ) s
377 283 M
( ) s
377 275 M
( ) s
377 267 M
( ) s
377 259 M
( ) s
377 251 M
( ) s
377 243 M
( ) s
377 235 M
( ) s
377 227 M
( ) s
377 219 M
( ) s
377 211 M
( ) s
377 203 M
( ) s
377 195 M
( ) s
377 187 M
( ) s
377 179 M
( ) s
377 171 M
( ) s
377 163 M
( ) s
377 155 M
( ) s
377 147 M
( ) s
377 139 M
( ) s
377 131 M
( ) s
377 123 M
( ) s
377 115 M
( ) s
377 107 M
( ) s
377 99 M
( ) s
377 91 M
( ) s
377 83 M
( ) s
377 75 M
([Page 14]                                                               ) s
_R
S
%%Page: (11) 11
%%BeginPageSetup
_S
90 rotate
24 -588 translate
/pagenum 11 def
/fname (rfc793.txt) def
/fdir () def
/ftail (rfc793.txt) def
% User defined strings:
/fmodstr (Thu Aug %2d 13:52:57 2000) def
%%EndPageSetup
do_header
5 531 M
( ) s
5 523 M
(September 1981                                                          ) s
5 515 M
(                                           Transmission Control Protocol) s
5 507 M
( ) s
5 499 M
( ) s
5 491 M
( ) s
5 483 M
(                      3.  FUNCTIONAL SPECIFICATION) s
5 475 M
( ) s
5 467 M
(3.1.  Header Format) s
5 459 M
( ) s
5 451 M
(  TCP segments are sent as internet datagrams.  The Internet Protocol) s
5 443 M
(  header carries several information fields, including the source and) s
5 435 M
(  destination host addresses [2].  A TCP header follows the internet) s
5 427 M
(  header, supplying information specific to the TCP protocol.  This) s
5 419 M
(  division allows for the existence of host level protocols other than) s
5 411 M
(  TCP.) s
5 403 M
( ) s
5 395 M
(  TCP Header Format) s
5 387 M
( ) s
5 379 M
(                                    ) s
5 371 M
(    0                   1                   2                   3   ) s
5 363 M
(    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 ) s
5 355 M
(   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+) s
5 347 M
(   |          Source Port          |       Destination Port        |) s
5 339 M
(   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+) s
5 331 M
(   |                        Sequence Number                        |) s
5 323 M
(   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+) s
5 315 M
(   |                    Acknowledgment Number                      |) s
5 307 M
(   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+) s
5 299 M
(   |  Data |           |U|A|P|R|S|F|                               |) s
5 291 M
(   | Offset| Reserved  |R|C|S|S|Y|I|            Window             |) s
5 283 M
(   |       |           |G|K|H|T|N|N|                               |) s
5 275 M
(   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+) s
5 267 M
(   |           Checksum            |         Urgent Pointer        |) s
5 259 M
(   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+) s
5 251 M
(   |                    Options                    |    Padding    |) s
5 243 M
(   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+) s
5 235 M
(   |                             data                              |) s
5 227 M
(   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+) s
5 219 M
( ) s
5 211 M
(                            TCP Header Format) s
5 203 M
( ) s
5 195 M
(          Note that one tick mark represents one bit position.) s
5 187 M
( ) s
5 179 M
(                               Figure 3.) s
5 171 M
( ) s
5 163 M
(  Source Port:  16 bits) s
5 155 M
( ) s
5 147 M
(    The source port number.) s
5 139 M
( ) s
5 131 M
(  Destination Port:  16 bits) s
5 123 M
( ) s
5 115 M
(    The destination port number.) s
5 107 M
( ) s
5 99 M
( ) s
5 91 M
( ) s
5 83 M
( ) s
5 75 M
(                                                               [Page 15]) s
377 531 M
( ) s
377 523 M
(                                                          September 1981) s
377 515 M
(Transmission Control Protocol) s
377 507 M
(Functional Specification) s
377 499 M
( ) s
377 491 M
( ) s
377 483 M
( ) s
377 475 M
(  Sequence Number:  32 bits) s
377 467 M
( ) s
377 459 M
(    The sequence number of the first data octet in this segment \(except) s
377 451 M
(    when SYN is present\). If SYN is present the sequence number is the) s
377 443 M
(    initial sequence number \(ISN\) and the first data octet is ISN+1.) s
377 435 M
( ) s
377 427 M
(  Acknowledgment Number:  32 bits) s
377 419 M
( ) s
377 411 M
(    If the ACK control bit is set this field contains the value of the) s
377 403 M
(    next sequence number the sender of the segment is expecting to) s
377 395 M
(    receive.  Once a connection is established this is always sent.) s
377 387 M
( ) s
377 379 M
(  Data Offset:  4 bits) s
377 371 M
( ) s
377 363 M
(    The number of 32 bit words in the TCP Header.  This indicates where) s
377 355 M
(    the data begins.  The TCP header \(even one including options\) is an) s
377 347 M
(    integral number of 32 bits long.) s
377 339 M
( ) s
377 331 M
(  Reserved:  6 bits) s
377 323 M
( ) s
377 315 M
(    Reserved for future use.  Must be zero.) s
377 307 M
( ) s
377 299 M
(  Control Bits:  6 bits \(from left to right\):) s
377 291 M
( ) s
377 283 M
(    URG:  Urgent Pointer field significant) s
377 275 M
(    ACK:  Acknowledgment field significant) s
377 267 M
(    PSH:  Push Function) s
377 259 M
(    RST:  Reset the connection) s
377 251 M
(    SYN:  Synchronize sequence numbers) s
377 243 M
(    FIN:  No more data from sender) s
377 235 M
( ) s
377 227 M
(  Window:  16 bits) s
377 219 M
( ) s
377 211 M
(    The number of data octets beginning with the one indicated in the) s
377 203 M
(    acknowledgment field which the sender of this segment is willing to) s
377 195 M
(    accept.) s
377 187 M
( ) s
377 179 M
(  Checksum:  16 bits) s
377 171 M
( ) s
377 163 M
(    The checksum field is the 16 bit one's complement of the one's) s
377 155 M
(    complement sum of all 16 bit words in the header and text.  If a) s
377 147 M
(    segment contains an odd number of header and text octets to be) s
377 139 M
(    checksummed, the last octet is padded on the right with zeros to) s
377 131 M
(    form a 16 bit word for checksum purposes.  The pad is not) s
377 123 M
(    transmitted as part of the segment.  While computing the checksum,) s
377 115 M
(    the checksum field itself is replaced with zeros.) s
377 107 M
( ) s
377 99 M
(    The checksum also covers a 96 bit pseudo header conceptually) s
377 91 M
( ) s
377 83 M
( ) s
377 75 M
([Page 16]                                                               ) s
_R
S
%%Page: (12) 12
%%BeginPageSetup
_S
90 rotate
24 -588 translate
/pagenum 12 def
/fname (rfc793.txt) def
/fdir () def
/ftail (rfc793.txt) def
% User defined strings:
/fmodstr (Thu Aug %2d 13:52:57 2000) def
%%EndPageSetup
do_header
5 531 M
( ) s
5 523 M
(September 1981                                                          ) s
5 515 M
(                                           Transmission Control Protocol) s
5 507 M
(                                                Functional Specification) s
5 499 M
( ) s
5 491 M
( ) s
5 483 M
( ) s
5 475 M
(    prefixed to the TCP header.  This pseudo header contains the Source) s
5 467 M
(    Address, the Destination Address, the Protocol, and TCP length.) s
5 459 M
(    This gives the TCP protection against misrouted segments.  This) s
5 451 M
(    information is carried in the Internet Protocol and is transferred) s
5 443 M
(    across the TCP/Network interface in the arguments or results of) s
5 435 M
(    calls by the TCP on the IP.) s
5 427 M
( ) s
5 419 M
(                     +--------+--------+--------+--------+) s
5 411 M
(                     |           Source Address          |) s
5 403 M
(                     +--------+--------+--------+--------+) s
5 395 M
(                     |         Destination Address       |) s
5 387 M
(                     +--------+--------+--------+--------+) s
5 379 M
(                     |  zero  |  PTCL  |    TCP Length   |) s
5 371 M
(                     +--------+--------+--------+--------+) s
5 363 M
( ) s
5 355 M
(      The TCP Length is the TCP header length plus the data length in) s
5 347 M
(      octets \(this is not an explicitly transmitted quantity, but is) s
5 339 M
(      computed\), and it does not count the 12 octets of the pseudo) s
5 331 M
(      header.) s
5 323 M
( ) s
5 315 M
(  Urgent Pointer:  16 bits) s
5 307 M
( ) s
5 299 M
(    This field communicates the current value of the urgent pointer as a) s
5 291 M
(    positive offset from the sequence number in this segment.  The) s
5 283 M
(    urgent pointer points to the sequence number of the octet following) s
5 275 M
(    the urgent data.  This field is only be interpreted in segments with) s
5 267 M
(    the URG control bit set.) s
5 259 M
( ) s
5 251 M
(  Options:  variable) s
5 243 M
( ) s
5 235 M
(    Options may occupy space at the end of the TCP header and are a) s
5 227 M
(    multiple of 8 bits in length.  All options are included in the) s
5 219 M
(    checksum.  An option may begin on any octet boundary.  There are two) s
5 211 M
(    cases for the format of an option:) s
5 203 M
( ) s
5 195 M
(      Case 1:  A single octet of option-kind.) s
5 187 M
( ) s
5 179 M
(      Case 2:  An octet of option-kind, an octet of option-length, and) s
5 171 M
(               the actual option-data octets.) s
5 163 M
( ) s
5 155 M
(    The option-length counts the two octets of option-kind and) s
5 147 M
(    option-length as well as the option-data octets.) s
5 139 M
( ) s
5 131 M
(    Note that the list of options may be shorter than the data offset) s
5 123 M
(    field might imply.  The content of the header beyond the) s
5 115 M
(    End-of-Option option must be header padding \(i.e., zero\).) s
5 107 M
( ) s
5 99 M
(    A TCP must implement all options.) s
5 91 M
( ) s
5 83 M
( ) s
5 75 M
(                                                               [Page 17]) s
377 531 M
( ) s
377 523 M
(                                                          September 1981) s
377 515 M
(Transmission Control Protocol) s
377 507 M
(Functional Specification) s
377 499 M
( ) s
377 491 M
( ) s
377 483 M
( ) s
377 475 M
(    Currently defined options include \(kind indicated in octal\):) s
377 467 M
( ) s
377 459 M
(      Kind     Length    Meaning) s
377 451 M
(      ----     ------    -------) s
377 443 M
(       0         -       End of option list.) s
377 435 M
(       1         -       No-Operation.) s
377 427 M
(       2         4       Maximum Segment Size.) s
377 419 M
(      ) s
377 411 M
( ) s
377 403 M
(    Specific Option Definitions) s
377 395 M
( ) s
377 387 M
(      End of Option List) s
377 379 M
( ) s
377 371 M
(        +--------+) s
377 363 M
(        |00000000|) s
377 355 M
(        +--------+) s
377 347 M
(         Kind=0) s
377 339 M
( ) s
377 331 M
(        This option code indicates the end of the option list.  This) s
377 323 M
(        might not coincide with the end of the TCP header according to) s
377 315 M
(        the Data Offset field.  This is used at the end of all options,) s
377 307 M
(        not the end of each option, and need only be used if the end of) s
377 299 M
(        the options would not otherwise coincide with the end of the TCP) s
377 291 M
(        header.) s
377 283 M
( ) s
377 275 M
(      No-Operation) s
377 267 M
( ) s
377 259 M
(        +--------+) s
377 251 M
(        |00000001|) s
377 243 M
(        +--------+) s
377 235 M
(         Kind=1) s
377 227 M
( ) s
377 219 M
(        This option code may be used between options, for example, to) s
377 211 M
(        align the beginning of a subsequent option on a word boundary.) s
377 203 M
(        There is no guarantee that senders will use this option, so) s
377 195 M
(        receivers must be prepared to process options even if they do) s
377 187 M
(        not begin on a word boundary.) s
377 179 M
( ) s
377 171 M
(      Maximum Segment Size) s
377 163 M
( ) s
377 155 M
(        +--------+--------+---------+--------+) s
377 147 M
(        |00000010|00000100|   max seg size   |) s
377 139 M
(        +--------+--------+---------+--------+) s
377 131 M
(         Kind=2   Length=4) s
377 123 M
( ) s
377 115 M
( ) s
377 107 M
( ) s
377 99 M
( ) s
377 91 M
( ) s
377 83 M
( ) s
377 75 M
([Page 18]                                                               ) s
_R
S
%%Page: (13) 13
%%BeginPageSetup
_S
90 rotate
24 -588 translate
/pagenum 13 def
/fname (rfc793.txt) def
/fdir () def
/ftail (rfc793.txt) def
% User defined strings:
/fmodstr (Thu Aug %2d 13:52:57 2000) def
%%EndPageSetup
do_header
5 531 M
( ) s
5 523 M
(September 1981                                                          ) s
5 515 M
(                                           Transmission Control Protocol) s
5 507 M
(                                                Functional Specification) s
5 499 M
( ) s
5 491 M
( ) s
5 483 M
( ) s
5 475 M
(        Maximum Segment Size Option Data:  16 bits) s
5 467 M
( ) s
5 459 M
(          If this option is present, then it communicates the maximum) s
5 451 M
(          receive segment size at the TCP which sends this segment.) s
5 443 M
(          This field must only be sent in the initial connection request) s
5 435 M
(          \(i.e., in segments with the SYN control bit set\).  If this) s
5 427 M
(          option is not used, any segment size is allowed.) s
5 419 M
( ) s
5 411 M
(  Padding:  variable) s
5 403 M
( ) s
5 395 M
(    The TCP header padding is used to ensure that the TCP header ends) s
5 387 M
(    and data begins on a 32 bit boundary.  The padding is composed of) s
5 379 M
(    zeros.) s
5 371 M
( ) s
5 363 M
(3.2.  Terminology) s
5 355 M
( ) s
5 347 M
(  Before we can discuss very much about the operation of the TCP we need) s
5 339 M
(  to introduce some detailed terminology.  The maintenance of a TCP) s
5 331 M
(  connection requires the remembering of several variables.  We conceive) s
5 323 M
(  of these variables being stored in a connection record called a) s
5 315 M
(  Transmission Control Block or TCB.  Among the variables stored in the) s
5 307 M
(  TCB are the local and remote socket numbers, the security and) s
5 299 M
(  precedence of the connection, pointers to the user's send and receive) s
5 291 M
(  buffers, pointers to the retransmit queue and to the current segment.) s
5 283 M
(  In addition several variables relating to the send and receive) s
5 275 M
(  sequence numbers are stored in the TCB.) s
5 267 M
( ) s
5 259 M
(    Send Sequence Variables) s
5 251 M
( ) s
5 243 M
(      SND.UNA - send unacknowledged) s
5 235 M
(      SND.NXT - send next) s
5 227 M
(      SND.WND - send window) s
5 219 M
(      SND.UP  - send urgent pointer) s
5 211 M
(      SND.WL1 - segment sequence number used for last window update) s
5 203 M
(      SND.WL2 - segment acknowledgment number used for last window) s
5 195 M
(                update) s
5 187 M
(      ISS     - initial send sequence number) s
5 179 M
( ) s
5 171 M
(    Receive Sequence Variables) s
5 163 M
( ) s
5 155 M
(      RCV.NXT - receive next) s
5 147 M
(      RCV.WND - receive window) s
5 139 M
(      RCV.UP  - receive urgent pointer) s
5 131 M
(      IRS     - initial receive sequence number) s
5 123 M
( ) s
5 115 M
( ) s
5 107 M
( ) s
5 99 M
( ) s
5 91 M
( ) s
5 83 M
( ) s
5 75 M
(                                                               [Page 19]) s
377 531 M
( ) s
377 523 M
(                                                          September 1981) s
377 515 M
(Transmission Control Protocol) s
377 507 M
(Functional Specification) s
377 499 M
( ) s
377 491 M
( ) s
377 483 M
( ) s
377 475 M
(  The following diagrams may help to relate some of these variables to) s
377 467 M
(  the sequence space.) s
377 459 M
( ) s
377 451 M
(  Send Sequence Space) s
377 443 M
( ) s
377 435 M
(                   1         2          3          4      ) s
377 427 M
(              ----------|----------|----------|---------- ) s
377 419 M
(                     SND.UNA    SND.NXT    SND.UNA        ) s
377 411 M
(                                          +SND.WND        ) s
377 403 M
( ) s
377 395 M
(        1 - old sequence numbers which have been acknowledged  ) s
377 387 M
(        2 - sequence numbers of unacknowledged data            ) s
377 379 M
(        3 - sequence numbers allowed for new data transmission ) s
377 371 M
(        4 - future sequence numbers which are not yet allowed  ) s
377 363 M
( ) s
377 355 M
(                          Send Sequence Space) s
377 347 M
( ) s
377 339 M
(                               Figure 4.) s
377 331 M
(    ) s
377 323 M
(    ) s
377 315 M
( ) s
377 307 M
(  The send window is the portion of the sequence space labeled 3 in) s
377 299 M
(  figure 4.) s
377 291 M
( ) s
377 283 M
(  Receive Sequence Space) s
377 275 M
( ) s
377 267 M
(                       1          2          3      ) s
377 259 M
(                   ----------|----------|---------- ) s
377 251 M
(                          RCV.NXT    RCV.NXT        ) s
377 243 M
(                                    +RCV.WND        ) s
377 235 M
( ) s
377 227 M
(        1 - old sequence numbers which have been acknowledged  ) s
377 219 M
(        2 - sequence numbers allowed for new reception         ) s
377 211 M
(        3 - future sequence numbers which are not yet allowed  ) s
377 203 M
( ) s
377 195 M
(                         Receive Sequence Space) s
377 187 M
( ) s
377 179 M
(                               Figure 5.) s
377 171 M
(    ) s
377 163 M
(    ) s
377 155 M
( ) s
377 147 M
(  The receive window is the portion of the sequence space labeled 2 in) s
377 139 M
(  figure 5.) s
377 131 M
( ) s
377 123 M
(  There are also some variables used frequently in the discussion that) s
377 115 M
(  take their values from the fields of the current segment.) s
377 107 M
( ) s
377 99 M
( ) s
377 91 M
( ) s
377 83 M
( ) s
377 75 M
([Page 20]                                                               ) s
_R
S
%%Page: (14) 14
%%BeginPageSetup
_S
90 rotate
24 -588 translate
/pagenum 14 def
/fname (rfc793.txt) def
/fdir () def
/ftail (rfc793.txt) def
% User defined strings:
/fmodstr (Thu Aug %2d 13:52:57 2000) def
%%EndPageSetup
do_header
5 531 M
( ) s
5 523 M
(September 1981                                                          ) s
5 515 M
(                                           Transmission Control Protocol) s
5 507 M
(                                                Functional Specification) s
5 499 M
( ) s
5 491 M
( ) s
5 483 M
( ) s
5 475 M
(    Current Segment Variables) s
5 467 M
( ) s
5 459 M
(      SEG.SEQ - segment sequence number) s
5 451 M
(      SEG.ACK - segment acknowledgment number) s
5 443 M
(      SEG.LEN - segment length) s
5 435 M
(      SEG.WND - segment window) s
5 427 M
(      SEG.UP  - segment urgent pointer) s
5 419 M
(      SEG.PRC - segment precedence value) s
5 411 M
( ) s
5 403 M
(  A connection progresses through a series of states during its) s
5 395 M
(  lifetime.  The states are:  LISTEN, SYN-SENT, SYN-RECEIVED,) s
5 387 M
(  ESTABLISHED, FIN-WAIT-1, FIN-WAIT-2, CLOSE-WAIT, CLOSING, LAST-ACK,) s
5 379 M
(  TIME-WAIT, and the fictional state CLOSED.  CLOSED is fictional) s
5 371 M
(  because it represents the state when there is no TCB, and therefore,) s
5 363 M
(  no connection.  Briefly the meanings of the states are:) s
5 355 M
( ) s
5 347 M
(    LISTEN - represents waiting for a connection request from any remote) s
5 339 M
(    TCP and port.) s
5 331 M
( ) s
5 323 M
(    SYN-SENT - represents waiting for a matching connection request) s
5 315 M
(    after having sent a connection request.) s
5 307 M
( ) s
5 299 M
(    SYN-RECEIVED - represents waiting for a confirming connection) s
5 291 M
(    request acknowledgment after having both received and sent a) s
5 283 M
(    connection request.) s
5 275 M
( ) s
5 267 M
(    ESTABLISHED - represents an open connection, data received can be) s
5 259 M
(    delivered to the user.  The normal state for the data transfer phase) s
5 251 M
(    of the connection.) s
5 243 M
( ) s
5 235 M
(    FIN-WAIT-1 - represents waiting for a connection termination request) s
5 227 M
(    from the remote TCP, or an acknowledgment of the connection) s
5 219 M
(    termination request previously sent.) s
5 211 M
( ) s
5 203 M
(    FIN-WAIT-2 - represents waiting for a connection termination request) s
5 195 M
(    from the remote TCP.) s
5 187 M
( ) s
5 179 M
(    CLOSE-WAIT - represents waiting for a connection termination request) s
5 171 M
(    from the local user.) s
5 163 M
( ) s
5 155 M
(    CLOSING - represents waiting for a connection termination request) s
5 147 M
(    acknowledgment from the remote TCP.) s
5 139 M
( ) s
5 131 M
(    LAST-ACK - represents waiting for an acknowledgment of the) s
5 123 M
(    connection termination request previously sent to the remote TCP) s
5 115 M
(    \(which includes an acknowledgment of its connection termination) s
5 107 M
(    request\).) s
5 99 M
( ) s
5 91 M
( ) s
5 83 M
( ) s
5 75 M
(                                                               [Page 21]) s
377 531 M
( ) s
377 523 M
(                                                          September 1981) s
377 515 M
(Transmission Control Protocol) s
377 507 M
(Functional Specification) s
377 499 M
( ) s
377 491 M
( ) s
377 483 M
( ) s
377 475 M
(    TIME-WAIT - represents waiting for enough time to pass to be sure) s
377 467 M
(    the remote TCP received the acknowledgment of its connection) s
377 459 M
(    termination request.) s
377 451 M
( ) s
377 443 M
(    CLOSED - represents no connection state at all.) s
377 435 M
( ) s
377 427 M
(  A TCP connection progresses from one state to another in response to) s
377 419 M
(  events.  The events are the user calls, OPEN, SEND, RECEIVE, CLOSE,) s
377 411 M
(  ABORT, and STATUS; the incoming segments, particularly those) s
377 403 M
(  containing the SYN, ACK, RST and FIN flags; and timeouts.) s
377 395 M
( ) s
377 387 M
(  The state diagram in figure 6 illustrates only state changes, together) s
377 379 M
(  with the causing events and resulting actions, but addresses neither) s
377 371 M
(  error conditions nor actions which are not connected with state) s
377 363 M
(  changes.  In a later section, more detail is offered with respect to) s
377 355 M
(  the reaction of the TCP to events.) s
377 347 M
( ) s
377 339 M
(  NOTE BENE:  this diagram is only a summary and must not be taken as) s
377 331 M
(  the total specification.) s
377 323 M
( ) s
377 315 M
( ) s
377 307 M
( ) s
377 299 M
( ) s
377 291 M
( ) s
377 283 M
( ) s
377 275 M
( ) s
377 267 M
( ) s
377 259 M
( ) s
377 251 M
( ) s
377 243 M
( ) s
377 235 M
( ) s
377 227 M
( ) s
377 219 M
( ) s
377 211 M
( ) s
377 203 M
( ) s
377 195 M
( ) s
377 187 M
( ) s
377 179 M
( ) s
377 171 M
( ) s
377 163 M
( ) s
377 155 M
( ) s
377 147 M
( ) s
377 139 M
( ) s
377 131 M
( ) s
377 123 M
( ) s
377 115 M
( ) s
377 107 M
( ) s
377 99 M
( ) s
377 91 M
( ) s
377 83 M
( ) s
377 75 M
([Page 22]                                                               ) s
_R
S
%%Page: (15) 15
%%BeginPageSetup
_S
90 rotate
24 -588 translate
/pagenum 15 def
/fname (rfc793.txt) def
/fdir () def
/ftail (rfc793.txt) def
% User defined strings:
/fmodstr (Thu Aug %2d 13:52:57 2000) def
%%EndPageSetup
do_header
5 531 M
( ) s
5 523 M
(September 1981                                                          ) s
5 515 M
(                                           Transmission Control Protocol) s
5 507 M
(                                                Functional Specification) s
5 499 M
( ) s
5 491 M
( ) s
5 483 M
( ) s
5 475 M
(                                    ) s
5 467 M
(                              +---------+ ---------\\      active OPEN  ) s
5 459 M
(                              |  CLOSED |            \\    -----------  ) s
5 451 M
(                              +---------+<---------\\   \\   create TCB  ) s
5 443 M
(                                |     ^              \\   \\  snd SYN    ) s
5 435 M
(                   passive OPEN |     |   CLOSE        \\   \\           ) s
5 427 M
(                   ------------ |     | ----------       \\   \\         ) s
5 419 M
(                    create TCB  |     | delete TCB         \\   \\       ) s
5 411 M
(                                V     |                      \\   \\     ) s
5 403 M
(                              +---------+            CLOSE    |    \\   ) s
5 395 M
(                              |  LISTEN |          ---------- |     |  ) s
5 387 M
(                              +---------+          delete TCB |     |  ) s
5 379 M
(                   rcv SYN      |     |     SEND              |     |  ) s
5 371 M
(                  -----------   |     |    -------            |     V  ) s
5 363 M
( +---------+      snd SYN,ACK  /       \\   snd SYN          +---------+) s
5 355 M
( |         |<-----------------           ------------------>|         |) s
5 347 M
( |   SYN   |                    rcv SYN                     |   SYN   |) s
5 339 M
( |   RCVD  |<-----------------------------------------------|   SENT  |) s
5 331 M
( |         |                    snd ACK                     |         |) s
5 323 M
( |         |------------------           -------------------|         |) s
5 315 M
( +---------+   rcv ACK of SYN  \\       /  rcv SYN,ACK       +---------+) s
5 307 M
(   |           --------------   |     |   -----------                  ) s
5 299 M
(   |                  x         |     |     snd ACK                    ) s
5 291 M
(   |                            V     V                                ) s
5 283 M
(   |  CLOSE                   +---------+                              ) s
5 275 M
(   | -------                  |  ESTAB  |                              ) s
5 267 M
(   | snd FIN                  +---------+                              ) s
5 259 M
(   |                   CLOSE    |     |    rcv FIN                     ) s
5 251 M
(   V                  -------   |     |    -------                     ) s
5 243 M
( +---------+          snd FIN  /       \\   snd ACK          +---------+) s
5 235 M
( |  FIN    |<-----------------           ------------------>|  CLOSE  |) s
5 227 M
( | WAIT-1  |------------------                              |   WAIT  |) s
5 219 M
( +---------+          rcv FIN  \\                            +---------+) s
5 211 M
(   | rcv ACK of FIN   -------   |                            CLOSE  |  ) s
5 203 M
(   | --------------   snd ACK   |                           ------- |  ) s
5 195 M
(   V        x                   V                           snd FIN V  ) s
5 187 M
( +---------+                  +---------+                   +---------+) s
5 179 M
( |FINWAIT-2|                  | CLOSING |                   | LAST-ACK|) s
5 171 M
( +---------+                  +---------+                   +---------+) s
5 163 M
(   |                rcv ACK of FIN |                 rcv ACK of FIN |  ) s
5 155 M
(   |  rcv FIN       -------------- |    Timeout=2MSL -------------- |  ) s
5 147 M
(   |  -------              x       V    ------------        x       V  ) s
5 139 M
(    \\ snd ACK                 +---------+delete TCB         +---------+) s
5 131 M
(     ------------------------>|TIME WAIT|------------------>| CLOSED  |) s
5 123 M
(                              +---------+                   +---------+) s
5 115 M
( ) s
5 107 M
(                      TCP Connection State Diagram) s
5 99 M
(                               Figure 6.) s
5 91 M
( ) s
5 83 M
( ) s
5 75 M
(                                                               [Page 23]) s
377 531 M
( ) s
377 523 M
(                                                          September 1981) s
377 515 M
(Transmission Control Protocol) s
377 507 M
(Functional Specification) s
377 499 M
( ) s
377 491 M
( ) s
377 483 M
( ) s
377 475 M
(3.3.  Sequence Numbers) s
377 467 M
( ) s
377 459 M
(  A fundamental notion in the design is that every octet of data sent) s
377 451 M
(  over a TCP connection has a sequence number.  Since every octet is) s
377 443 M
(  sequenced, each of them can be acknowledged.  The acknowledgment) s
377 435 M
(  mechanism employed is cumulative so that an acknowledgment of sequence) s
377 427 M
(  number X indicates that all octets up to but not including X have been) s
377 419 M
(  received.  This mechanism allows for straight-forward duplicate) s
377 411 M
(  detection in the presence of retransmission.  Numbering of octets) s
377 403 M
(  within a segment is that the first data octet immediately following) s
377 395 M
(  the header is the lowest numbered, and the following octets are) s
377 387 M
(  numbered consecutively.) s
377 379 M
( ) s
377 371 M
(  It is essential to remember that the actual sequence number space is) s
377 363 M
(  finite, though very large.  This space ranges from 0 to 2**32 - 1.) s
377 355 M
(  Since the space is finite, all arithmetic dealing with sequence) s
377 347 M
(  numbers must be performed modulo 2**32.  This unsigned arithmetic) s
377 339 M
(  preserves the relationship of sequence numbers as they cycle from) s
377 331 M
(  2**32 - 1 to 0 again.  There are some subtleties to computer modulo) s
377 323 M
(  arithmetic, so great care should be taken in programming the) s
377 315 M
(  comparison of such values.  The symbol "=<" means "less than or equal") s
377 307 M
(  \(modulo 2**32\).) s
377 299 M
( ) s
377 291 M
(  The typical kinds of sequence number comparisons which the TCP must) s
377 283 M
(  perform include:) s
377 275 M
( ) s
377 267 M
(    \(a\)  Determining that an acknowledgment refers to some sequence) s
377 259 M
(         number sent but not yet acknowledged.) s
377 251 M
( ) s
377 243 M
(    \(b\)  Determining that all sequence numbers occupied by a segment) s
377 235 M
(         have been acknowledged \(e.g., to remove the segment from a) s
377 227 M
(         retransmission queue\).) s
377 219 M
( ) s
377 211 M
(    \(c\)  Determining that an incoming segment contains sequence numbers) s
377 203 M
(         which are expected \(i.e., that the segment "overlaps" the) s
377 195 M
(         receive window\).) s
377 187 M
( ) s
377 179 M
( ) s
377 171 M
( ) s
377 163 M
( ) s
377 155 M
( ) s
377 147 M
( ) s
377 139 M
( ) s
377 131 M
( ) s
377 123 M
( ) s
377 115 M
( ) s
377 107 M
( ) s
377 99 M
( ) s
377 91 M
( ) s
377 83 M
( ) s
377 75 M
([Page 24]                                                               ) s
_R
S
%%Page: (16) 16
%%BeginPageSetup
_S
90 rotate
24 -588 translate
/pagenum 16 def
/fname (rfc793.txt) def
/fdir () def
/ftail (rfc793.txt) def
% User defined strings:
/fmodstr (Thu Aug %2d 13:52:57 2000) def
%%EndPageSetup
do_header
5 531 M
( ) s
5 523 M
(September 1981                                                          ) s
5 515 M
(                                           Transmission Control Protocol) s
5 507 M
(                                                Functional Specification) s
5 499 M
( ) s
5 491 M
( ) s
5 483 M
( ) s
5 475 M
(  In response to sending data the TCP will receive acknowledgments.  The) s
5 467 M
(  following comparisons are needed to process the acknowledgments.) s
5 459 M
( ) s
5 451 M
(    SND.UNA = oldest unacknowledged sequence number) s
5 443 M
( ) s
5 435 M
(    SND.NXT = next sequence number to be sent) s
5 427 M
( ) s
5 419 M
(    SEG.ACK = acknowledgment from the receiving TCP \(next sequence) s
5 411 M
(              number expected by the receiving TCP\)) s
5 403 M
( ) s
5 395 M
(    SEG.SEQ = first sequence number of a segment) s
5 387 M
( ) s
5 379 M
(    SEG.LEN = the number of octets occupied by the data in the segment) s
5 371 M
(              \(counting SYN and FIN\)) s
5 363 M
( ) s
5 355 M
(    SEG.SEQ+SEG.LEN-1 = last sequence number of a segment) s
5 347 M
( ) s
5 339 M
(  A new acknowledgment \(called an "acceptable ack"\), is one for which) s
5 331 M
(  the inequality below holds:) s
5 323 M
( ) s
5 315 M
(    SND.UNA < SEG.ACK =< SND.NXT) s
5 307 M
( ) s
5 299 M
(  A segment on the retransmission queue is fully acknowledged if the sum) s
5 291 M
(  of its sequence number and length is less or equal than the) s
5 283 M
(  acknowledgment value in the incoming segment.) s
5 275 M
( ) s
5 267 M
(  When data is received the following comparisons are needed:) s
5 259 M
( ) s
5 251 M
(    RCV.NXT = next sequence number expected on an incoming segments, and) s
5 243 M
(        is the left or lower edge of the receive window) s
5 235 M
( ) s
5 227 M
(    RCV.NXT+RCV.WND-1 = last sequence number expected on an incoming) s
5 219 M
(        segment, and is the right or upper edge of the receive window) s
5 211 M
( ) s
5 203 M
(    SEG.SEQ = first sequence number occupied by the incoming segment) s
5 195 M
( ) s
5 187 M
(    SEG.SEQ+SEG.LEN-1 = last sequence number occupied by the incoming) s
5 179 M
(        segment) s
5 171 M
( ) s
5 163 M
(  A segment is judged to occupy a portion of valid receive sequence) s
5 155 M
(  space if) s
5 147 M
( ) s
5 139 M
(    RCV.NXT =< SEG.SEQ < RCV.NXT+RCV.WND) s
5 131 M
( ) s
5 123 M
(  or) s
5 115 M
( ) s
5 107 M
(    RCV.NXT =< SEG.SEQ+SEG.LEN-1 < RCV.NXT+RCV.WND) s
5 99 M
( ) s
5 91 M
( ) s
5 83 M
( ) s
5 75 M
(                                                               [Page 25]) s
377 531 M
( ) s
377 523 M
(                                                          September 1981) s
377 515 M
(Transmission Control Protocol) s
377 507 M
(Functional Specification) s
377 499 M
( ) s
377 491 M
( ) s
377 483 M
( ) s
377 475 M
(  The first part of this test checks to see if the beginning of the) s
377 467 M
(  segment falls in the window, the second part of the test checks to see) s
377 459 M
(  if the end of the segment falls in the window; if the segment passes) s
377 451 M
(  either part of the test it contains data in the window.) s
377 443 M
( ) s
377 435 M
(  Actually, it is a little more complicated than this.  Due to zero) s
377 427 M
(  windows and zero length segments, we have four cases for the) s
377 419 M
(  acceptability of an incoming segment:) s
377 411 M
( ) s
377 403 M
(    Segment Receive  Test) s
377 395 M
(    Length  Window) s
377 387 M
(    ------- -------  -------------------------------------------) s
377 379 M
( ) s
377 371 M
(       0       0     SEG.SEQ = RCV.NXT) s
377 363 M
( ) s
377 355 M
(       0      >0     RCV.NXT =< SEG.SEQ < RCV.NXT+RCV.WND) s
377 347 M
( ) s
377 339 M
(      >0       0     not acceptable) s
377 331 M
( ) s
377 323 M
(      >0      >0     RCV.NXT =< SEG.SEQ < RCV.NXT+RCV.WND) s
377 315 M
(                  or RCV.NXT =< SEG.SEQ+SEG.LEN-1 < RCV.NXT+RCV.WND) s
377 307 M
( ) s
377 299 M
(  Note that when the receive window is zero no segments should be) s
377 291 M
(  acceptable except ACK segments.  Thus, it is be possible for a TCP to) s
377 283 M
(  maintain a zero receive window while transmitting data and receiving) s
377 275 M
(  ACKs.  However, even when the receive window is zero, a TCP must) s
377 267 M
(  process the RST and URG fields of all incoming segments.) s
377 259 M
( ) s
377 251 M
(  We have taken advantage of the numbering scheme to protect certain) s
377 243 M
(  control information as well.  This is achieved by implicitly including) s
377 235 M
(  some control flags in the sequence space so they can be retransmitted) s
377 227 M
(  and acknowledged without confusion \(i.e., one and only one copy of the) s
377 219 M
(  control will be acted upon\).  Control information is not physically) s
377 211 M
(  carried in the segment data space.  Consequently, we must adopt rules) s
377 203 M
(  for implicitly assigning sequence numbers to control.  The SYN and FIN) s
377 195 M
(  are the only controls requiring this protection, and these controls) s
377 187 M
(  are used only at connection opening and closing.  For sequence number) s
377 179 M
(  purposes, the SYN is considered to occur before the first actual data) s
377 171 M
(  octet of the segment in which it occurs, while the FIN is considered) s
377 163 M
(  to occur after the last actual data octet in a segment in which it) s
377 155 M
(  occurs.  The segment length \(SEG.LEN\) includes both data and sequence) s
377 147 M
(  space occupying controls.  When a SYN is present then SEG.SEQ is the) s
377 139 M
(  sequence number of the SYN.) s
377 131 M
( ) s
377 123 M
( ) s
377 115 M
( ) s
377 107 M
( ) s
377 99 M
( ) s
377 91 M
( ) s
377 83 M
( ) s
377 75 M
([Page 26]                                                               ) s
_R
S
%%Page: (17) 17
%%BeginPageSetup
_S
90 rotate
24 -588 translate
/pagenum 17 def
/fname (rfc793.txt) def
/fdir () def
/ftail (rfc793.txt) def
% User defined strings:
/fmodstr (Thu Aug %2d 13:52:57 2000) def
%%EndPageSetup
do_header
5 531 M
( ) s
5 523 M
(September 1981                                                          ) s
5 515 M
(                                           Transmission Control Protocol) s
5 507 M
(                                                Functional Specification) s
5 499 M
( ) s
5 491 M
( ) s
5 483 M
( ) s
5 475 M
(  Initial Sequence Number Selection) s
5 467 M
( ) s
5 459 M
(  The protocol places no restriction on a particular connection being) s
5 451 M
(  used over and over again.  A connection is defined by a pair of) s
5 443 M
(  sockets.  New instances of a connection will be referred to as) s
5 435 M
(  incarnations of the connection.  The problem that arises from this is) s
5 427 M
(  -- "how does the TCP identify duplicate segments from previous) s
5 419 M
(  incarnations of the connection?"  This problem becomes apparent if the) s
5 411 M
(  connection is being opened and closed in quick succession, or if the) s
5 403 M
(  connection breaks with loss of memory and is then reestablished.) s
5 395 M
( ) s
5 387 M
(  To avoid confusion we must prevent segments from one incarnation of a) s
5 379 M
(  connection from being used while the same sequence numbers may still) s
5 371 M
(  be present in the network from an earlier incarnation.  We want to) s
5 363 M
(  assure this, even if a TCP crashes and loses all knowledge of the) s
5 355 M
(  sequence numbers it has been using.  When new connections are created,) s
5 347 M
(  an initial sequence number \(ISN\) generator is employed which selects a) s
5 339 M
(  new 32 bit ISN.  The generator is bound to a \(possibly fictitious\) 32) s
5 331 M
(  bit clock whose low order bit is incremented roughly every 4) s
5 323 M
(  microseconds.  Thus, the ISN cycles approximately every 4.55 hours.) s
5 315 M
(  Since we assume that segments will stay in the network no more than) s
5 307 M
(  the Maximum Segment Lifetime \(MSL\) and that the MSL is less than 4.55) s
5 299 M
(  hours we can reasonably assume that ISN's will be unique.) s
5 291 M
( ) s
5 283 M
(  For each connection there is a send sequence number and a receive) s
5 275 M
(  sequence number.  The initial send sequence number \(ISS\) is chosen by) s
5 267 M
(  the data sending TCP, and the initial receive sequence number \(IRS\) is) s
5 259 M
(  learned during the connection establishing procedure.) s
5 251 M
( ) s
5 243 M
(  For a connection to be established or initialized, the two TCPs must) s
5 235 M
(  synchronize on each other's initial sequence numbers.  This is done in) s
5 227 M
(  an exchange of connection establishing segments carrying a control bit) s
5 219 M
(  called "SYN" \(for synchronize\) and the initial sequence numbers.  As a) s
5 211 M
(  shorthand, segments carrying the SYN bit are also called "SYNs".) s
5 203 M
(  Hence, the solution requires a suitable mechanism for picking an) s
5 195 M
(  initial sequence number and a slightly involved handshake to exchange) s
5 187 M
(  the ISN's.) s
5 179 M
( ) s
5 171 M
(  The synchronization requires each side to send it's own initial) s
5 163 M
(  sequence number and to receive a confirmation of it in acknowledgment) s
5 155 M
(  from the other side.  Each side must also receive the other side's) s
5 147 M
(  initial sequence number and send a confirming acknowledgment.) s
5 139 M
( ) s
5 131 M
(    1\) A --> B  SYN my sequence number is X) s
5 123 M
(    2\) A <-- B  ACK your sequence number is X) s
5 115 M
(    3\) A <-- B  SYN my sequence number is Y) s
5 107 M
(    4\) A --> B  ACK your sequence number is Y) s
5 99 M
( ) s
5 91 M
( ) s
5 83 M
( ) s
5 75 M
(                                                               [Page 27]) s
377 531 M
( ) s
377 523 M
(                                                          September 1981) s
377 515 M
(Transmission Control Protocol) s
377 507 M
(Functional Specification) s
377 499 M
( ) s
377 491 M
( ) s
377 483 M
( ) s
377 475 M
(  Because steps 2 and 3 can be combined in a single message this is) s
377 467 M
(  called the three way \(or three message\) handshake.) s
377 459 M
( ) s
377 451 M
(  A three way handshake is necessary because sequence numbers are not) s
377 443 M
(  tied to a global clock in the network, and TCPs may have different) s
377 435 M
(  mechanisms for picking the ISN's.  The receiver of the first SYN has) s
377 427 M
(  no way of knowing whether the segment was an old delayed one or not,) s
377 419 M
(  unless it remembers the last sequence number used on the connection) s
377 411 M
(  \(which is not always possible\), and so it must ask the sender to) s
377 403 M
(  verify this SYN.  The three way handshake and the advantages of a) s
377 395 M
(  clock-driven scheme are discussed in [3].) s
377 387 M
( ) s
377 379 M
(  Knowing When to Keep Quiet) s
377 371 M
( ) s
377 363 M
(  To be sure that a TCP does not create a segment that carries a) s
377 355 M
(  sequence number which may be duplicated by an old segment remaining in) s
377 347 M
(  the network, the TCP must keep quiet for a maximum segment lifetime) s
377 339 M
(  \(MSL\) before assigning any sequence numbers upon starting up or) s
377 331 M
(  recovering from a crash in which memory of sequence numbers in use was) s
377 323 M
(  lost.  For this specification the MSL is taken to be 2 minutes.  This) s
377 315 M
(  is an engineering choice, and may be changed if experience indicates) s
377 307 M
(  it is desirable to do so.  Note that if a TCP is reinitialized in some) s
377 299 M
(  sense, yet retains its memory of sequence numbers in use, then it need) s
377 291 M
(  not wait at all; it must only be sure to use sequence numbers larger) s
377 283 M
(  than those recently used.) s
377 275 M
( ) s
377 267 M
(  The TCP Quiet Time Concept) s
377 259 M
( ) s
377 251 M
(    This specification provides that hosts which "crash" without) s
377 243 M
(    retaining any knowledge of the last sequence numbers transmitted on) s
377 235 M
(    each active \(i.e., not closed\) connection shall delay emitting any) s
377 227 M
(    TCP segments for at least the agreed Maximum Segment Lifetime \(MSL\)) s
377 219 M
(    in the internet system of which the host is a part.  In the) s
377 211 M
(    paragraphs below, an explanation for this specification is given.) s
377 203 M
(    TCP implementors may violate the "quiet time" restriction, but only) s
377 195 M
(    at the risk of causing some old data to be accepted as new or new) s
377 187 M
(    data rejected as old duplicated by some receivers in the internet) s
377 179 M
(    system.) s
377 171 M
( ) s
377 163 M
(    TCPs consume sequence number space each time a segment is formed and) s
377 155 M
(    entered into the network output queue at a source host. The) s
377 147 M
(    duplicate detection and sequencing algorithm in the TCP protocol) s
377 139 M
(    relies on the unique binding of segment data to sequence space to) s
377 131 M
(    the extent that sequence numbers will not cycle through all 2**32) s
377 123 M
(    values before the segment data bound to those sequence numbers has) s
377 115 M
(    been delivered and acknowledged by the receiver and all duplicate) s
377 107 M
(    copies of the segments have "drained" from the internet.  Without) s
377 99 M
(    such an assumption, two distinct TCP segments could conceivably be) s
377 91 M
( ) s
377 83 M
( ) s
377 75 M
([Page 28]                                                               ) s
_R
S
%%Page: (18) 18
%%BeginPageSetup
_S
90 rotate
24 -588 translate
/pagenum 18 def
/fname (rfc793.txt) def
/fdir () def
/ftail (rfc793.txt) def
% User defined strings:
/fmodstr (Thu Aug %2d 13:52:57 2000) def
%%EndPageSetup
do_header
5 531 M
( ) s
5 523 M
(September 1981                                                          ) s
5 515 M
(                                           Transmission Control Protocol) s
5 507 M
(                                                Functional Specification) s
5 499 M
( ) s
5 491 M
( ) s
5 483 M
( ) s
5 475 M
(    assigned the same or overlapping sequence numbers, causing confusion) s
5 467 M
(    at the receiver as to which data is new and which is old.  Remember) s
5 459 M
(    that each segment is bound to as many consecutive sequence numbers) s
5 451 M
(    as there are octets of data in the segment.) s
5 443 M
( ) s
5 435 M
(    Under normal conditions, TCPs keep track of the next sequence number) s
5 427 M
(    to emit and the oldest awaiting acknowledgment so as to avoid) s
5 419 M
(    mistakenly using a sequence number over before its first use has) s
5 411 M
(    been acknowledged.  This alone does not guarantee that old duplicate) s
5 403 M
(    data is drained from the net, so the sequence space has been made) s
5 395 M
(    very large to reduce the probability that a wandering duplicate will) s
5 387 M
(    cause trouble upon arrival.  At 2 megabits/sec. it takes 4.5 hours) s
5 379 M
(    to use up 2**32 octets of sequence space.  Since the maximum segment) s
5 371 M
(    lifetime in the net is not likely to exceed a few tens of seconds,) s
5 363 M
(    this is deemed ample protection for foreseeable nets, even if data) s
5 355 M
(    rates escalate to l0's of megabits/sec.  At 100 megabits/sec, the) s
5 347 M
(    cycle time is 5.4 minutes which may be a little short, but still) s
5 339 M
(    within reason.) s
5 331 M
( ) s
5 323 M
(    The basic duplicate detection and sequencing algorithm in TCP can be) s
5 315 M
(    defeated, however, if a source TCP does not have any memory of the) s
5 307 M
(    sequence numbers it last used on a given connection. For example, if) s
5 299 M
(    the TCP were to start all connections with sequence number 0, then) s
5 291 M
(    upon crashing and restarting, a TCP might re-form an earlier) s
5 283 M
(    connection \(possibly after half-open connection resolution\) and emit) s
5 275 M
(    packets with sequence numbers identical to or overlapping with) s
5 267 M
(    packets still in the network which were emitted on an earlier) s
5 259 M
(    incarnation of the same connection.  In the absence of knowledge) s
5 251 M
(    about the sequence numbers used on a particular connection, the TCP) s
5 243 M
(    specification recommends that the source delay for MSL seconds) s
5 235 M
(    before emitting segments on the connection, to allow time for) s
5 227 M
(    segments from the earlier connection incarnation to drain from the) s
5 219 M
(    system.) s
5 211 M
( ) s
5 203 M
(    Even hosts which can remember the time of day and used it to select) s
5 195 M
(    initial sequence number values are not immune from this problem) s
5 187 M
(    \(i.e., even if time of day is used to select an initial sequence) s
5 179 M
(    number for each new connection incarnation\).) s
5 171 M
( ) s
5 163 M
(    Suppose, for example, that a connection is opened starting with) s
5 155 M
(    sequence number S.  Suppose that this connection is not used much) s
5 147 M
(    and that eventually the initial sequence number function \(ISN\(t\)\)) s
5 139 M
(    takes on a value equal to the sequence number, say S1, of the last) s
5 131 M
(    segment sent by this TCP on a particular connection.  Now suppose,) s
5 123 M
(    at this instant, the host crashes, recovers, and establishes a new) s
5 115 M
(    incarnation of the connection. The initial sequence number chosen is) s
5 107 M
(    S1 = ISN\(t\) -- last used sequence number on old incarnation of) s
5 99 M
(    connection!  If the recovery occurs quickly enough, any old) s
5 91 M
( ) s
5 83 M
( ) s
5 75 M
(                                                               [Page 29]) s
377 531 M
( ) s
377 523 M
(                                                          September 1981) s
377 515 M
(Transmission Control Protocol) s
377 507 M
(Functional Specification) s
377 499 M
( ) s
377 491 M
( ) s
377 483 M
( ) s
377 475 M
(    duplicates in the net bearing sequence numbers in the neighborhood) s
377 467 M
(    of S1 may arrive and be treated as new packets by the receiver of) s
377 459 M
(    the new incarnation of the connection.) s
377 451 M
( ) s
377 443 M
(    The problem is that the recovering host may not know for how long it) s
377 435 M
(    crashed nor does it know whether there are still old duplicates in) s
377 427 M
(    the system from earlier connection incarnations.) s
377 419 M
( ) s
377 411 M
(    One way to deal with this problem is to deliberately delay emitting) s
377 403 M
(    segments for one MSL after recovery from a crash- this is the "quite) s
377 395 M
(    time" specification.  Hosts which prefer to avoid waiting are) s
377 387 M
(    willing to risk possible confusion of old and new packets at a given) s
377 379 M
(    destination may choose not to wait for the "quite time".) s
377 371 M
(    Implementors may provide TCP users with the ability to select on a) s
377 363 M
(    connection by connection basis whether to wait after a crash, or may) s
377 355 M
(    informally implement the "quite time" for all connections.) s
377 347 M
(    Obviously, even where a user selects to "wait," this is not) s
377 339 M
(    necessary after the host has been "up" for at least MSL seconds.) s
377 331 M
( ) s
377 323 M
(    To summarize: every segment emitted occupies one or more sequence) s
377 315 M
(    numbers in the sequence space, the numbers occupied by a segment are) s
377 307 M
(    "busy" or "in use" until MSL seconds have passed, upon crashing a) s
377 299 M
(    block of space-time is occupied by the octets of the last emitted) s
377 291 M
(    segment, if a new connection is started too soon and uses any of the) s
377 283 M
(    sequence numbers in the space-time footprint of the last segment of) s
377 275 M
(    the previous connection incarnation, there is a potential sequence) s
377 267 M
(    number overlap area which could cause confusion at the receiver.) s
377 259 M
( ) s
377 251 M
(3.4.  Establishing a connection) s
377 243 M
( ) s
377 235 M
(  The "three-way handshake" is the procedure used to establish a) s
377 227 M
(  connection.  This procedure normally is initiated by one TCP and) s
377 219 M
(  responded to by another TCP.  The procedure also works if two TCP) s
377 211 M
(  simultaneously initiate the procedure.  When simultaneous attempt) s
377 203 M
(  occurs, each TCP receives a "SYN" segment which carries no) s
377 195 M
(  acknowledgment after it has sent a "SYN".  Of course, the arrival of) s
377 187 M
(  an old duplicate "SYN" segment can potentially make it appear, to the) s
377 179 M
(  recipient, that a simultaneous connection initiation is in progress.) s
377 171 M
(  Proper use of "reset" segments can disambiguate these cases.) s
377 163 M
( ) s
377 155 M
(  Several examples of connection initiation follow.  Although these) s
377 147 M
(  examples do not show connection synchronization using data-carrying) s
377 139 M
(  segments, this is perfectly legitimate, so long as the receiving TCP) s
377 131 M
(  doesn't deliver the data to the user until it is clear the data is) s
377 123 M
(  valid \(i.e., the data must be buffered at the receiver until the) s
377 115 M
(  connection reaches the ESTABLISHED state\).  The three-way handshake) s
377 107 M
(  reduces the possibility of false connections.  It is the) s
377 99 M
( ) s
377 91 M
( ) s
377 83 M
( ) s
377 75 M
([Page 30]                                                               ) s
_R
S
%%Page: (19) 19
%%BeginPageSetup
_S
90 rotate
24 -588 translate
/pagenum 19 def
/fname (rfc793.txt) def
/fdir () def
/ftail (rfc793.txt) def
% User defined strings:
/fmodstr (Thu Aug %2d 13:52:57 2000) def
%%EndPageSetup
do_header
5 531 M
( ) s
5 523 M
(September 1981                                                          ) s
5 515 M
(                                           Transmission Control Protocol) s
5 507 M
(                                                Functional Specification) s
5 499 M
( ) s
5 491 M
( ) s
5 483 M
( ) s
5 475 M
(  implementation of a trade-off between memory and messages to provide) s
5 467 M
(  information for this checking.) s
5 459 M
( ) s
5 451 M
(  The simplest three-way handshake is shown in figure 7 below.  The) s
5 443 M
(  figures should be interpreted in the following way.  Each line is) s
5 435 M
(  numbered for reference purposes.  Right arrows \(-->\) indicate) s
5 427 M
(  departure of a TCP segment from TCP A to TCP B, or arrival of a) s
5 419 M
(  segment at B from A.  Left arrows \(<--\), indicate the reverse.) s
5 411 M
(  Ellipsis \(...\) indicates a segment which is still in the network) s
5 403 M
(  \(delayed\).  An "XXX" indicates a segment which is lost or rejected.) s
5 395 M
(  Comments appear in parentheses.  TCP states represent the state AFTER) s
5 387 M
(  the departure or arrival of the segment \(whose contents are shown in) s
5 379 M
(  the center of each line\).  Segment contents are shown in abbreviated) s
5 371 M
(  form, with sequence number, control flags, and ACK field.  Other) s
5 363 M
(  fields such as window, addresses, lengths, and text have been left out) s
5 355 M
(  in the interest of clarity.) s
5 347 M
( ) s
5 339 M
(  ) s
5 331 M
( ) s
5 323 M
(      TCP A                                                TCP B) s
5 315 M
( ) s
5 307 M
(  1.  CLOSED                                               LISTEN) s
5 299 M
( ) s
5 291 M
(  2.  SYN-SENT    --> <SEQ=100><CTL=SYN>               --> SYN-RECEIVED) s
5 283 M
( ) s
5 275 M
(  3.  ESTABLISHED <-- <SEQ=300><ACK=101><CTL=SYN,ACK>  <-- SYN-RECEIVED) s
5 267 M
( ) s
5 259 M
(  4.  ESTABLISHED --> <SEQ=101><ACK=301><CTL=ACK>       --> ESTABLISHED) s
5 251 M
( ) s
5 243 M
(  5.  ESTABLISHED --> <SEQ=101><ACK=301><CTL=ACK><DATA> --> ESTABLISHED) s
5 235 M
( ) s
5 227 M
(          Basic 3-Way Handshake for Connection Synchronization) s
5 219 M
( ) s
5 211 M
(                                Figure 7.) s
5 203 M
( ) s
5 195 M
(  In line 2 of figure 7, TCP A begins by sending a SYN segment) s
5 187 M
(  indicating that it will use sequence numbers starting with sequence) s
5 179 M
(  number 100.  In line 3, TCP B sends a SYN and acknowledges the SYN it) s
5 171 M
(  received from TCP A.  Note that the acknowledgment field indicates TCP) s
5 163 M
(  B is now expecting to hear sequence 101, acknowledging the SYN which) s
5 155 M
(  occupied sequence 100.) s
5 147 M
( ) s
5 139 M
(  At line 4, TCP A responds with an empty segment containing an ACK for) s
5 131 M
(  TCP B's SYN; and in line 5, TCP A sends some data.  Note that the) s
5 123 M
(  sequence number of the segment in line 5 is the same as in line 4) s
5 115 M
(  because the ACK does not occupy sequence number space \(if it did, we) s
5 107 M
(  would wind up ACKing ACK's!\).) s
5 99 M
( ) s
5 91 M
( ) s
5 83 M
( ) s
5 75 M
(                                                               [Page 31]) s
377 531 M
( ) s
377 523 M
(                                                          September 1981) s
377 515 M
(Transmission Control Protocol) s
377 507 M
(Functional Specification) s
377 499 M
( ) s
377 491 M
( ) s
377 483 M
( ) s
377 475 M
(  Simultaneous initiation is only slightly more complex, as is shown in) s
377 467 M
(  figure 8.  Each TCP cycles from CLOSED to SYN-SENT to SYN-RECEIVED to) s
377 459 M
(  ESTABLISHED.) s
377 451 M
( ) s
377 443 M
(  ) s
377 435 M
( ) s
377 427 M
(      TCP A                                            TCP B) s
377 419 M
( ) s
377 411 M
(  1.  CLOSED                                           CLOSED) s
377 403 M
( ) s
377 395 M
(  2.  SYN-SENT     --> <SEQ=100><CTL=SYN>              ...) s
377 387 M
( ) s
377 379 M
(  3.  SYN-RECEIVED <-- <SEQ=300><CTL=SYN>              <-- SYN-SENT) s
377 371 M
( ) s
377 363 M
(  4.               ... <SEQ=100><CTL=SYN>              --> SYN-RECEIVED) s
377 355 M
( ) s
377 347 M
(  5.  SYN-RECEIVED --> <SEQ=100><ACK=301><CTL=SYN,ACK> ...) s
377 339 M
( ) s
377 331 M
(  6.  ESTABLISHED  <-- <SEQ=300><ACK=101><CTL=SYN,ACK> <-- SYN-RECEIVED) s
377 323 M
( ) s
377 315 M
(  7.               ... <SEQ=101><ACK=301><CTL=ACK>     --> ESTABLISHED) s
377 307 M
( ) s
377 299 M
(                Simultaneous Connection Synchronization) s
377 291 M
( ) s
377 283 M
(                               Figure 8.) s
377 275 M
( ) s
377 267 M
(  The principle reason for the three-way handshake is to prevent old) s
377 259 M
(  duplicate connection initiations from causing confusion.  To deal with) s
377 251 M
(  this, a special control message, reset, has been devised.  If the) s
377 243 M
(  receiving TCP is in a  non-synchronized state \(i.e., SYN-SENT,) s
377 235 M
(  SYN-RECEIVED\), it returns to LISTEN on receiving an acceptable reset.) s
377 227 M
(  If the TCP is in one of the synchronized states \(ESTABLISHED,) s
377 219 M
(  FIN-WAIT-1, FIN-WAIT-2, CLOSE-WAIT, CLOSING, LAST-ACK, TIME-WAIT\), it) s
377 211 M
(  aborts the connection and informs its user.  We discuss this latter) s
377 203 M
(  case under "half-open" connections below.) s
377 195 M
( ) s
377 187 M
( ) s
377 179 M
( ) s
377 171 M
( ) s
377 163 M
( ) s
377 155 M
( ) s
377 147 M
( ) s
377 139 M
( ) s
377 131 M
( ) s
377 123 M
( ) s
377 115 M
( ) s
377 107 M
( ) s
377 99 M
( ) s
377 91 M
( ) s
377 83 M
( ) s
377 75 M
([Page 32]                                                               ) s
_R
S
%%Page: (20) 20
%%BeginPageSetup
_S
90 rotate
24 -588 translate
/pagenum 20 def
/fname (rfc793.txt) def
/fdir () def
/ftail (rfc793.txt) def
% User defined strings:
/fmodstr (Thu Aug %2d 13:52:57 2000) def
%%EndPageSetup
do_header
5 531 M
( ) s
5 523 M
(September 1981                                                          ) s
5 515 M
(                                           Transmission Control Protocol) s
5 507 M
(                                                Functional Specification) s
5 499 M
( ) s
5 491 M
( ) s
5 483 M
( ) s
5 475 M
(  ) s
5 467 M
( ) s
5 459 M
(      TCP A                                                TCP B) s
5 451 M
( ) s
5 443 M
(  1.  CLOSED                                               LISTEN) s
5 435 M
( ) s
5 427 M
(  2.  SYN-SENT    --> <SEQ=100><CTL=SYN>               ...) s
5 419 M
( ) s
5 411 M
(  3.  \(duplicate\) ... <SEQ=90><CTL=SYN>               --> SYN-RECEIVED) s
5 403 M
( ) s
5 395 M
(  4.  SYN-SENT    <-- <SEQ=300><ACK=91><CTL=SYN,ACK>  <-- SYN-RECEIVED) s
5 387 M
( ) s
5 379 M
(  5.  SYN-SENT    --> <SEQ=91><CTL=RST>               --> LISTEN) s
5 371 M
(  ) s
5 363 M
( ) s
5 355 M
(  6.              ... <SEQ=100><CTL=SYN>               --> SYN-RECEIVED) s
5 347 M
( ) s
5 339 M
(  7.  SYN-SENT    <-- <SEQ=400><ACK=101><CTL=SYN,ACK>  <-- SYN-RECEIVED) s
5 331 M
( ) s
5 323 M
(  8.  ESTABLISHED --> <SEQ=101><ACK=401><CTL=ACK>      --> ESTABLISHED) s
5 315 M
( ) s
5 307 M
(                    Recovery from Old Duplicate SYN) s
5 299 M
( ) s
5 291 M
(                               Figure 9.) s
5 283 M
( ) s
5 275 M
(  As a simple example of recovery from old duplicates, consider) s
5 267 M
(  figure 9.  At line 3, an old duplicate SYN arrives at TCP B.  TCP B) s
5 259 M
(  cannot tell that this is an old duplicate, so it responds normally) s
5 251 M
(  \(line 4\).  TCP A detects that the ACK field is incorrect and returns a) s
5 243 M
(  RST \(reset\) with its SEQ field selected to make the segment) s
5 235 M
(  believable.  TCP B, on receiving the RST, returns to the LISTEN state.) s
5 227 M
(  When the original SYN \(pun intended\) finally arrives at line 6, the) s
5 219 M
(  synchronization proceeds normally.  If the SYN at line 6 had arrived) s
5 211 M
(  before the RST, a more complex exchange might have occurred with RST's) s
5 203 M
(  sent in both directions.) s
5 195 M
( ) s
5 187 M
(  Half-Open Connections and Other Anomalies) s
5 179 M
( ) s
5 171 M
(  An established connection is said to be  "half-open" if one of the) s
5 163 M
(  TCPs has closed or aborted the connection at its end without the) s
5 155 M
(  knowledge of the other, or if the two ends of the connection have) s
5 147 M
(  become desynchronized owing to a crash that resulted in loss of) s
5 139 M
(  memory.  Such connections will automatically become reset if an) s
5 131 M
(  attempt is made to send data in either direction.  However, half-open) s
5 123 M
(  connections are expected to be unusual, and the recovery procedure is) s
5 115 M
(  mildly involved.) s
5 107 M
( ) s
5 99 M
(  If at site A the connection no longer exists, then an attempt by the) s
5 91 M
( ) s
5 83 M
( ) s
5 75 M
(                                                               [Page 33]) s
377 531 M
( ) s
377 523 M
(                                                          September 1981) s
377 515 M
(Transmission Control Protocol) s
377 507 M
(Functional Specification) s
377 499 M
( ) s
377 491 M
( ) s
377 483 M
( ) s
377 475 M
(  user at site B to send any data on it will result in the site B TCP) s
377 467 M
(  receiving a reset control message.  Such a message indicates to the) s
377 459 M
(  site B TCP that something is wrong, and it is expected to abort the) s
377 451 M
(  connection.) s
377 443 M
( ) s
377 435 M
(  Assume that two user processes A and B are communicating with one) s
377 427 M
(  another when a crash occurs causing loss of memory to A's TCP.) s
377 419 M
(  Depending on the operating system supporting A's TCP, it is likely) s
377 411 M
(  that some error recovery mechanism exists.  When the TCP is up again,) s
377 403 M
(  A is likely to start again from the beginning or from a recovery) s
377 395 M
(  point.  As a result, A will probably try to OPEN the connection again) s
377 387 M
(  or try to SEND on the connection it believes open.  In the latter) s
377 379 M
(  case, it receives the error message "connection not open" from the) s
377 371 M
(  local \(A's\) TCP.  In an attempt to establish the connection, A's TCP) s
377 363 M
(  will send a segment containing SYN.  This scenario leads to the) s
377 355 M
(  example shown in figure 10.  After TCP A crashes, the user attempts to) s
377 347 M
(  re-open the connection.  TCP B, in the meantime, thinks the connection) s
377 339 M
(  is open.) s
377 331 M
( ) s
377 323 M
(  ) s
377 315 M
( ) s
377 307 M
(      TCP A                                           TCP B) s
377 299 M
( ) s
377 291 M
(  1.  \(CRASH\)                               \(send 300,receive 100\)) s
377 283 M
( ) s
377 275 M
(  2.  CLOSED                                           ESTABLISHED) s
377 267 M
( ) s
377 259 M
(  3.  SYN-SENT --> <SEQ=400><CTL=SYN>              --> \(??\)) s
377 251 M
( ) s
377 243 M
(  4.  \(!!\)     <-- <SEQ=300><ACK=100><CTL=ACK>     <-- ESTABLISHED) s
377 235 M
( ) s
377 227 M
(  5.  SYN-SENT --> <SEQ=100><CTL=RST>              --> \(Abort!!\)) s
377 219 M
( ) s
377 211 M
(  6.  SYN-SENT                                         CLOSED) s
377 203 M
( ) s
377 195 M
(  7.  SYN-SENT --> <SEQ=400><CTL=SYN>              -->) s
377 187 M
( ) s
377 179 M
(                     Half-Open Connection Discovery) s
377 171 M
( ) s
377 163 M
(                               Figure 10.) s
377 155 M
( ) s
377 147 M
(  When the SYN arrives at line 3, TCP B, being in a synchronized state,) s
377 139 M
(  and the incoming segment outside the window, responds with an) s
377 131 M
(  acknowledgment indicating what sequence it next expects to hear \(ACK) s
377 123 M
(  100\).  TCP A sees that this segment does not acknowledge anything it) s
377 115 M
(  sent and, being unsynchronized, sends a reset \(RST\) because it has) s
377 107 M
(  detected a half-open connection.  TCP B aborts at line 5.  TCP A will) s
377 99 M
( ) s
377 91 M
( ) s
377 83 M
( ) s
377 75 M
([Page 34]                                                               ) s
_R
S
%%Page: (21) 21
%%BeginPageSetup
_S
90 rotate
24 -588 translate
/pagenum 21 def
/fname (rfc793.txt) def
/fdir () def
/ftail (rfc793.txt) def
% User defined strings:
/fmodstr (Thu Aug %2d 13:52:57 2000) def
%%EndPageSetup
do_header
5 531 M
( ) s
5 523 M
(September 1981                                                          ) s
5 515 M
(                                           Transmission Control Protocol) s
5 507 M
(                                                Functional Specification) s
5 499 M
( ) s
5 491 M
( ) s
5 483 M
( ) s
5 475 M
(  continue to try to establish the connection; the problem is now) s
5 467 M
(  reduced to the basic 3-way handshake of figure 7.) s
5 459 M
( ) s
5 451 M
(  An interesting alternative case occurs when TCP A crashes and TCP B) s
5 443 M
(  tries to send data on what it thinks is a synchronized connection.) s
5 435 M
(  This is illustrated in figure 11.  In this case, the data arriving at) s
5 427 M
(  TCP A from TCP B \(line 2\) is unacceptable because no such connection) s
5 419 M
(  exists, so TCP A sends a RST.  The RST is acceptable so TCP B) s
5 411 M
(  processes it and aborts the connection.) s
5 403 M
( ) s
5 395 M
(  ) s
5 387 M
( ) s
5 379 M
(        TCP A                                              TCP B) s
5 371 M
( ) s
5 363 M
(  1.  \(CRASH\)                                   \(send 300,receive 100\)) s
5 355 M
( ) s
5 347 M
(  2.  \(??\)    <-- <SEQ=300><ACK=100><DATA=10><CTL=ACK> <-- ESTABLISHED) s
5 339 M
( ) s
5 331 M
(  3.          --> <SEQ=100><CTL=RST>                   --> \(ABORT!!\)) s
5 323 M
( ) s
5 315 M
(           Active Side Causes Half-Open Connection Discovery) s
5 307 M
( ) s
5 299 M
(                               Figure 11.) s
5 291 M
( ) s
5 283 M
(  In figure 12, we find the two TCPs A and B with passive connections) s
5 275 M
(  waiting for SYN.  An old duplicate arriving at TCP B \(line 2\) stirs B) s
5 267 M
(  into action.  A SYN-ACK is returned \(line 3\) and causes TCP A to) s
5 259 M
(  generate a RST \(the ACK in line 3 is not acceptable\).  TCP B accepts) s
5 251 M
(  the reset and returns to its passive LISTEN state.) s
5 243 M
( ) s
5 235 M
(  ) s
5 227 M
( ) s
5 219 M
(      TCP A                                         TCP B) s
5 211 M
( ) s
5 203 M
(  1.  LISTEN                                        LISTEN) s
5 195 M
( ) s
5 187 M
(  2.       ... <SEQ=Z><CTL=SYN>                -->  SYN-RECEIVED) s
5 179 M
( ) s
5 171 M
(  3.  \(??\) <-- <SEQ=X><ACK=Z+1><CTL=SYN,ACK>   <--  SYN-RECEIVED) s
5 163 M
( ) s
5 155 M
(  4.       --> <SEQ=Z+1><CTL=RST>              -->  \(return to LISTEN!\)) s
5 147 M
( ) s
5 139 M
(  5.  LISTEN                                        LISTEN) s
5 131 M
( ) s
5 123 M
(       Old Duplicate SYN Initiates a Reset on two Passive Sockets) s
5 115 M
( ) s
5 107 M
(                               Figure 12.) s
5 99 M
( ) s
5 91 M
( ) s
5 83 M
( ) s
5 75 M
(                                                               [Page 35]) s
377 531 M
( ) s
377 523 M
(                                                          September 1981) s
377 515 M
(Transmission Control Protocol) s
377 507 M
(Functional Specification) s
377 499 M
( ) s
377 491 M
( ) s
377 483 M
( ) s
377 475 M
(  A variety of other cases are possible, all of which are accounted for) s
377 467 M
(  by the following rules for RST generation and processing.) s
377 459 M
( ) s
377 451 M
(  Reset Generation) s
377 443 M
( ) s
377 435 M
(  As a general rule, reset \(RST\) must be sent whenever a segment arrives) s
377 427 M
(  which apparently is not intended for the current connection.  A reset) s
377 419 M
(  must not be sent if it is not clear that this is the case.) s
377 411 M
( ) s
377 403 M
(  There are three groups of states:) s
377 395 M
( ) s
377 387 M
(    1.  If the connection does not exist \(CLOSED\) then a reset is sent) s
377 379 M
(    in response to any incoming segment except another reset.  In) s
377 371 M
(    particular, SYNs addressed to a non-existent connection are rejected) s
377 363 M
(    by this means.) s
377 355 M
( ) s
377 347 M
(    If the incoming segment has an ACK field, the reset takes its) s
377 339 M
(    sequence number from the ACK field of the segment, otherwise the) s
377 331 M
(    reset has sequence number zero and the ACK field is set to the sum) s
377 323 M
(    of the sequence number and segment length of the incoming segment.) s
377 315 M
(    The connection remains in the CLOSED state.) s
377 307 M
( ) s
377 299 M
(    2.  If the connection is in any non-synchronized state \(LISTEN,) s
377 291 M
(    SYN-SENT, SYN-RECEIVED\), and the incoming segment acknowledges) s
377 283 M
(    something not yet sent \(the segment carries an unacceptable ACK\), or) s
377 275 M
(    if an incoming segment has a security level or compartment which) s
377 267 M
(    does not exactly match the level and compartment requested for the) s
377 259 M
(    connection, a reset is sent.) s
377 251 M
( ) s
377 243 M
(    If our SYN has not been acknowledged and the precedence level of the) s
377 235 M
(    incoming segment is higher than the precedence level requested then) s
377 227 M
(    either raise the local precedence level \(if allowed by the user and) s
377 219 M
(    the system\) or send a reset; or if the precedence level of the) s
377 211 M
(    incoming segment is lower than the precedence level requested then) s
377 203 M
(    continue as if the precedence matched exactly \(if the remote TCP) s
377 195 M
(    cannot raise the precedence level to match ours this will be) s
377 187 M
(    detected in the next segment it sends, and the connection will be) s
377 179 M
(    terminated then\).  If our SYN has been acknowledged \(perhaps in this) s
377 171 M
(    incoming segment\) the precedence level of the incoming segment must) s
377 163 M
(    match the local precedence level exactly, if it does not a reset) s
377 155 M
(    must be sent.) s
377 147 M
( ) s
377 139 M
(    If the incoming segment has an ACK field, the reset takes its) s
377 131 M
(    sequence number from the ACK field of the segment, otherwise the) s
377 123 M
(    reset has sequence number zero and the ACK field is set to the sum) s
377 115 M
(    of the sequence number and segment length of the incoming segment.) s
377 107 M
(    The connection remains in the same state.) s
377 99 M
( ) s
377 91 M
( ) s
377 83 M
( ) s
377 75 M
([Page 36]                                                               ) s
_R
S
%%Page: (22) 22
%%BeginPageSetup
_S
90 rotate
24 -588 translate
/pagenum 22 def
/fname (rfc793.txt) def
/fdir () def
/ftail (rfc793.txt) def
% User defined strings:
/fmodstr (Thu Aug %2d 13:52:57 2000) def
%%EndPageSetup
do_header
5 531 M
( ) s
5 523 M
(September 1981                                                          ) s
5 515 M
(                                           Transmission Control Protocol) s
5 507 M
(                                                Functional Specification) s
5 499 M
( ) s
5 491 M
( ) s
5 483 M
( ) s
5 475 M
(    3.  If the connection is in a synchronized state \(ESTABLISHED,) s
5 467 M
(    FIN-WAIT-1, FIN-WAIT-2, CLOSE-WAIT, CLOSING, LAST-ACK, TIME-WAIT\),) s
5 459 M
(    any unacceptable segment \(out of window sequence number or) s
5 451 M
(    unacceptible acknowledgment number\) must elicit only an empty) s
5 443 M
(    acknowledgment segment containing the current send-sequence number) s
5 435 M
(    and an acknowledgment indicating the next sequence number expected) s
5 427 M
(    to be received, and the connection remains in the same state.) s
5 419 M
( ) s
5 411 M
(    If an incoming segment has a security level, or compartment, or) s
5 403 M
(    precedence which does not exactly match the level, and compartment,) s
5 395 M
(    and precedence requested for the connection,a reset is sent and) s
5 387 M
(    connection goes to the CLOSED state.  The reset takes its sequence) s
5 379 M
(    number from the ACK field of the incoming segment.) s
5 371 M
( ) s
5 363 M
(  Reset Processing) s
5 355 M
( ) s
5 347 M
(  In all states except SYN-SENT, all reset \(RST\) segments are validated) s
5 339 M
(  by checking their SEQ-fields.  A reset is valid if its sequence number) s
5 331 M
(  is in the window.  In the SYN-SENT state \(a RST received in response) s
5 323 M
(  to an initial SYN\), the RST is acceptable if the ACK field) s
5 315 M
(  acknowledges the SYN.) s
5 307 M
( ) s
5 299 M
(  The receiver of a RST first validates it, then changes state.  If the) s
5 291 M
(  receiver was in the LISTEN state, it ignores it.  If the receiver was) s
5 283 M
(  in SYN-RECEIVED state and had previously been in the LISTEN state,) s
5 275 M
(  then the receiver returns to the LISTEN state, otherwise the receiver) s
5 267 M
(  aborts the connection and goes to the CLOSED state.  If the receiver) s
5 259 M
(  was in any other state, it aborts the connection and advises the user) s
5 251 M
(  and goes to the CLOSED state.) s
5 243 M
( ) s
5 235 M
(3.5.  Closing a Connection) s
5 227 M
( ) s
5 219 M
(  CLOSE is an operation meaning "I have no more data to send."  The) s
5 211 M
(  notion of closing a full-duplex connection is subject to ambiguous) s
5 203 M
(  interpretation, of course, since it may not be obvious how to treat) s
5 195 M
(  the receiving side of the connection.  We have chosen to treat CLOSE) s
5 187 M
(  in a simplex fashion.  The user who CLOSEs may continue to RECEIVE) s
5 179 M
(  until he is told that the other side has CLOSED also.  Thus, a program) s
5 171 M
(  could initiate several SENDs followed by a CLOSE, and then continue to) s
5 163 M
(  RECEIVE until signaled that a RECEIVE failed because the other side) s
5 155 M
(  has CLOSED.  We assume that the TCP will signal a user, even if no) s
5 147 M
(  RECEIVEs are outstanding, that the other side has closed, so the user) s
5 139 M
(  can terminate his side gracefully.  A TCP will reliably deliver all) s
5 131 M
(  buffers SENT before the connection was CLOSED so a user who expects no) s
5 123 M
(  data in return need only wait to hear the connection was CLOSED) s
5 115 M
(  successfully to know that all his data was received at the destination) s
5 107 M
(  TCP.  Users must keep reading connections they close for sending until) s
5 99 M
(  the TCP says no more data.) s
5 91 M
( ) s
5 83 M
( ) s
5 75 M
(                                                               [Page 37]) s
377 531 M
( ) s
377 523 M
(                                                          September 1981) s
377 515 M
(Transmission Control Protocol) s
377 507 M
(Functional Specification) s
377 499 M
( ) s
377 491 M
( ) s
377 483 M
( ) s
377 475 M
(  There are essentially three cases:) s
377 467 M
( ) s
377 459 M
(    1\) The user initiates by telling the TCP to CLOSE the connection) s
377 451 M
( ) s
377 443 M
(    2\) The remote TCP initiates by sending a FIN control signal) s
377 435 M
( ) s
377 427 M
(    3\) Both users CLOSE simultaneously) s
377 419 M
( ) s
377 411 M
(  Case 1:  Local user initiates the close) s
377 403 M
( ) s
377 395 M
(    In this case, a FIN segment can be constructed and placed on the) s
377 387 M
(    outgoing segment queue.  No further SENDs from the user will be) s
377 379 M
(    accepted by the TCP, and it enters the FIN-WAIT-1 state.  RECEIVEs) s
377 371 M
(    are allowed in this state.  All segments preceding and including FIN) s
377 363 M
(    will be retransmitted until acknowledged.  When the other TCP has) s
377 355 M
(    both acknowledged the FIN and sent a FIN of its own, the first TCP) s
377 347 M
(    can ACK this FIN.  Note that a TCP receiving a FIN will ACK but not) s
377 339 M
(    send its own FIN until its user has CLOSED the connection also.) s
377 331 M
( ) s
377 323 M
(  Case 2:  TCP receives a FIN from the network) s
377 315 M
( ) s
377 307 M
(    If an unsolicited FIN arrives from the network, the receiving TCP) s
377 299 M
(    can ACK it and tell the user that the connection is closing.  The) s
377 291 M
(    user will respond with a CLOSE, upon which the TCP can send a FIN to) s
377 283 M
(    the other TCP after sending any remaining data.  The TCP then waits) s
377 275 M
(    until its own FIN is acknowledged whereupon it deletes the) s
377 267 M
(    connection.  If an ACK is not forthcoming, after the user timeout) s
377 259 M
(    the connection is aborted and the user is told.) s
377 251 M
( ) s
377 243 M
(  Case 3:  both users close simultaneously) s
377 235 M
( ) s
377 227 M
(    A simultaneous CLOSE by users at both ends of a connection causes) s
377 219 M
(    FIN segments to be exchanged.  When all segments preceding the FINs) s
377 211 M
(    have been processed and acknowledged, each TCP can ACK the FIN it) s
377 203 M
(    has received.  Both will, upon receiving these ACKs, delete the) s
377 195 M
(    connection.) s
377 187 M
( ) s
377 179 M
( ) s
377 171 M
( ) s
377 163 M
( ) s
377 155 M
( ) s
377 147 M
( ) s
377 139 M
( ) s
377 131 M
( ) s
377 123 M
( ) s
377 115 M
( ) s
377 107 M
( ) s
377 99 M
( ) s
377 91 M
( ) s
377 83 M
( ) s
377 75 M
([Page 38]                                                               ) s
_R
S
%%Page: (23) 23
%%BeginPageSetup
_S
90 rotate
24 -588 translate
/pagenum 23 def
/fname (rfc793.txt) def
/fdir () def
/ftail (rfc793.txt) def
% User defined strings:
/fmodstr (Thu Aug %2d 13:52:57 2000) def
%%EndPageSetup
do_header
5 531 M
( ) s
5 523 M
(September 1981                                                          ) s
5 515 M
(                                           Transmission Control Protocol) s
5 507 M
(                                                Functional Specification) s
5 499 M
( ) s
5 491 M
( ) s
5 483 M
( ) s
5 475 M
(  ) s
5 467 M
( ) s
5 459 M
(      TCP A                                                TCP B) s
5 451 M
( ) s
5 443 M
(  1.  ESTABLISHED                                          ESTABLISHED) s
5 435 M
( ) s
5 427 M
(  2.  \(Close\)) s
5 419 M
(      FIN-WAIT-1  --> <SEQ=100><ACK=300><CTL=FIN,ACK>  --> CLOSE-WAIT) s
5 411 M
( ) s
5 403 M
(  3.  FIN-WAIT-2  <-- <SEQ=300><ACK=101><CTL=ACK>      <-- CLOSE-WAIT) s
5 395 M
( ) s
5 387 M
(  4.                                                       \(Close\)) s
5 379 M
(      TIME-WAIT   <-- <SEQ=300><ACK=101><CTL=FIN,ACK>  <-- LAST-ACK) s
5 371 M
( ) s
5 363 M
(  5.  TIME-WAIT   --> <SEQ=101><ACK=301><CTL=ACK>      --> CLOSED) s
5 355 M
( ) s
5 347 M
(  6.  \(2 MSL\)) s
5 339 M
(      CLOSED                                                      ) s
5 331 M
( ) s
5 323 M
(                         Normal Close Sequence) s
5 315 M
( ) s
5 307 M
(                               Figure 13.) s
5 299 M
( ) s
5 291 M
(  ) s
5 283 M
( ) s
5 275 M
(      TCP A                                                TCP B) s
5 267 M
( ) s
5 259 M
(  1.  ESTABLISHED                                          ESTABLISHED) s
5 251 M
( ) s
5 243 M
(  2.  \(Close\)                                              \(Close\)) s
5 235 M
(      FIN-WAIT-1  --> <SEQ=100><ACK=300><CTL=FIN,ACK>  ... FIN-WAIT-1) s
5 227 M
(                  <-- <SEQ=300><ACK=100><CTL=FIN,ACK>  <--) s
5 219 M
(                  ... <SEQ=100><ACK=300><CTL=FIN,ACK>  -->) s
5 211 M
( ) s
5 203 M
(  3.  CLOSING     --> <SEQ=101><ACK=301><CTL=ACK>      ... CLOSING) s
5 195 M
(                  <-- <SEQ=301><ACK=101><CTL=ACK>      <--) s
5 187 M
(                  ... <SEQ=101><ACK=301><CTL=ACK>      -->) s
5 179 M
( ) s
5 171 M
(  4.  TIME-WAIT                                            TIME-WAIT) s
5 163 M
(      \(2 MSL\)                                              \(2 MSL\)) s
5 155 M
(      CLOSED                                               CLOSED) s
5 147 M
( ) s
5 139 M
(                      Simultaneous Close Sequence) s
5 131 M
( ) s
5 123 M
(                               Figure 14.) s
5 115 M
( ) s
5 107 M
( ) s
5 99 M
( ) s
5 91 M
( ) s
5 83 M
( ) s
5 75 M
(                                                               [Page 39]) s
377 531 M
( ) s
377 523 M
(                                                          September 1981) s
377 515 M
(Transmission Control Protocol) s
377 507 M
(Functional Specification) s
377 499 M
( ) s
377 491 M
( ) s
377 483 M
( ) s
377 475 M
(3.6.  Precedence and Security) s
377 467 M
( ) s
377 459 M
(  The intent is that connection be allowed only between ports operating) s
377 451 M
(  with exactly the same security and compartment values and at the) s
377 443 M
(  higher of the precedence level requested by the two ports.) s
377 435 M
( ) s
377 427 M
(  The precedence and security parameters used in TCP are exactly those) s
377 419 M
(  defined in the Internet Protocol \(IP\) [2].  Throughout this TCP) s
377 411 M
(  specification the term "security/compartment" is intended to indicate) s
377 403 M
(  the security parameters used in IP including security, compartment,) s
377 395 M
(  user group, and handling restriction.) s
377 387 M
( ) s
377 379 M
(  A connection attempt with mismatched security/compartment values or a) s
377 371 M
(  lower precedence value must be rejected by sending a reset.  Rejecting) s
377 363 M
(  a connection due to too low a precedence only occurs after an) s
377 355 M
(  acknowledgment of the SYN has been received.) s
377 347 M
( ) s
377 339 M
(  Note that TCP modules which operate only at the default value of) s
377 331 M
(  precedence will still have to check the precedence of incoming) s
377 323 M
(  segments and possibly raise the precedence level they use on the) s
377 315 M
(  connection.) s
377 307 M
( ) s
377 299 M
(  The security paramaters may be used even in a non-secure environment) s
377 291 M
(  \(the values would indicate unclassified data\), thus hosts in) s
377 283 M
(  non-secure environments must be prepared to receive the security) s
377 275 M
(  parameters, though they need not send them.) s
377 267 M
( ) s
377 259 M
(3.7.  Data Communication) s
377 251 M
( ) s
377 243 M
(  Once the connection is established data is communicated by the) s
377 235 M
(  exchange of segments.  Because segments may be lost due to errors) s
377 227 M
(  \(checksum test failure\), or network congestion, TCP uses) s
377 219 M
(  retransmission \(after a timeout\) to ensure delivery of every segment.) s
377 211 M
(  Duplicate segments may arrive due to network or TCP retransmission.) s
377 203 M
(  As discussed in the section on sequence numbers the TCP performs) s
377 195 M
(  certain tests on the sequence and acknowledgment numbers in the) s
377 187 M
(  segments to verify their acceptability.) s
377 179 M
( ) s
377 171 M
(  The sender of data keeps track of the next sequence number to use in) s
377 163 M
(  the variable SND.NXT.  The receiver of data keeps track of the next) s
377 155 M
(  sequence number to expect in the variable RCV.NXT.  The sender of data) s
377 147 M
(  keeps track of the oldest unacknowledged sequence number in the) s
377 139 M
(  variable SND.UNA.  If the data flow is momentarily idle and all data) s
377 131 M
(  sent has been acknowledged then the three variables will be equal.) s
377 123 M
( ) s
377 115 M
(  When the sender creates a segment and transmits it the sender advances) s
377 107 M
(  SND.NXT.  When the receiver accepts a segment it advances RCV.NXT and) s
377 99 M
(  sends an acknowledgment.  When the data sender receives an) s
377 91 M
( ) s
377 83 M
( ) s
377 75 M
([Page 40]                                                               ) s
_R
S
%%Page: (24) 24
%%BeginPageSetup
_S
90 rotate
24 -588 translate
/pagenum 24 def
/fname (rfc793.txt) def
/fdir () def
/ftail (rfc793.txt) def
% User defined strings:
/fmodstr (Thu Aug %2d 13:52:57 2000) def
%%EndPageSetup
do_header
5 531 M
( ) s
5 523 M
(September 1981                                                          ) s
5 515 M
(                                           Transmission Control Protocol) s
5 507 M
(                                                Functional Specification) s
5 499 M
( ) s
5 491 M
( ) s
5 483 M
( ) s
5 475 M
(  acknowledgment it advances SND.UNA.  The extent to which the values of) s
5 467 M
(  these variables differ is a measure of the delay in the communication.) s
5 459 M
(  The amount by which the variables are advanced is the length of the) s
5 451 M
(  data in the segment.  Note that once in the ESTABLISHED state all) s
5 443 M
(  segments must carry current acknowledgment information.) s
5 435 M
( ) s
5 427 M
(  The CLOSE user call implies a push function, as does the FIN control) s
5 419 M
(  flag in an incoming segment.) s
5 411 M
( ) s
5 403 M
(  Retransmission Timeout) s
5 395 M
( ) s
5 387 M
(  Because of the variability of the networks that compose an) s
5 379 M
(  internetwork system and the wide range of uses of TCP connections the) s
5 371 M
(  retransmission timeout must be dynamically determined.  One procedure) s
5 363 M
(  for determining a retransmission time out is given here as an) s
5 355 M
(  illustration.) s
5 347 M
( ) s
5 339 M
(    An Example Retransmission Timeout Procedure) s
5 331 M
( ) s
5 323 M
(      Measure the elapsed time between sending a data octet with a) s
5 315 M
(      particular sequence number and receiving an acknowledgment that) s
5 307 M
(      covers that sequence number \(segments sent do not have to match) s
5 299 M
(      segments received\).  This measured elapsed time is the Round Trip) s
5 291 M
(      Time \(RTT\).  Next compute a Smoothed Round Trip Time \(SRTT\) as:) s
5 283 M
( ) s
5 275 M
(        SRTT = \( ALPHA * SRTT \) + \(\(1-ALPHA\) * RTT\)) s
5 267 M
( ) s
5 259 M
(      and based on this, compute the retransmission timeout \(RTO\) as:) s
5 251 M
( ) s
5 243 M
(        RTO = min[UBOUND,max[LBOUND,\(BETA*SRTT\)]]) s
5 235 M
( ) s
5 227 M
(      where UBOUND is an upper bound on the timeout \(e.g., 1 minute\),) s
5 219 M
(      LBOUND is a lower bound on the timeout \(e.g., 1 second\), ALPHA is) s
5 211 M
(      a smoothing factor \(e.g., .8 to .9\), and BETA is a delay variance) s
5 203 M
(      factor \(e.g., 1.3 to 2.0\).) s
5 195 M
( ) s
5 187 M
(  The Communication of Urgent Information) s
5 179 M
( ) s
5 171 M
(  The objective of the TCP urgent mechanism is to allow the sending user) s
5 163 M
(  to stimulate the receiving user to accept some urgent data and to) s
5 155 M
(  permit the receiving TCP to indicate to the receiving user when all) s
5 147 M
(  the currently known urgent data has been received by the user.) s
5 139 M
( ) s
5 131 M
(  This mechanism permits a point in the data stream to be designated as) s
5 123 M
(  the end of urgent information.  Whenever this point is in advance of) s
5 115 M
(  the receive sequence number \(RCV.NXT\) at the receiving TCP, that TCP) s
5 107 M
(  must tell the user to go into "urgent mode"; when the receive sequence) s
5 99 M
(  number catches up to the urgent pointer, the TCP must tell user to go) s
5 91 M
( ) s
5 83 M
( ) s
5 75 M
(                                                               [Page 41]) s
377 531 M
( ) s
377 523 M
(                                                          September 1981) s
377 515 M
(Transmission Control Protocol) s
377 507 M
(Functional Specification) s
377 499 M
( ) s
377 491 M
( ) s
377 483 M
( ) s
377 475 M
(  into "normal mode".  If the urgent pointer is updated while the user) s
377 467 M
(  is in "urgent mode", the update will be invisible to the user.) s
377 459 M
( ) s
377 451 M
(  The method employs a urgent field which is carried in all segments) s
377 443 M
(  transmitted.  The URG control flag indicates that the urgent field is) s
377 435 M
(  meaningful and must be added to the segment sequence number to yield) s
377 427 M
(  the urgent pointer.  The absence of this flag indicates that there is) s
377 419 M
(  no urgent data outstanding.) s
377 411 M
( ) s
377 403 M
(  To send an urgent indication the user must also send at least one data) s
377 395 M
(  octet.  If the sending user also indicates a push, timely delivery of) s
377 387 M
(  the urgent information to the destination process is enhanced.) s
377 379 M
( ) s
377 371 M
(  Managing the Window) s
377 363 M
( ) s
377 355 M
(  The window sent in each segment indicates the range of sequence) s
377 347 M
(  numbers the sender of the window \(the data receiver\) is currently) s
377 339 M
(  prepared to accept.  There is an assumption that this is related to) s
377 331 M
(  the currently available data buffer space available for this) s
377 323 M
(  connection.) s
377 315 M
( ) s
377 307 M
(  Indicating a large window encourages transmissions.  If more data) s
377 299 M
(  arrives than can be accepted, it will be discarded.  This will result) s
377 291 M
(  in excessive retransmissions, adding unnecessarily to the load on the) s
377 283 M
(  network and the TCPs.  Indicating a small window may restrict the) s
377 275 M
(  transmission of data to the point of introducing a round trip delay) s
377 267 M
(  between each new segment transmitted.) s
377 259 M
( ) s
377 251 M
(  The mechanisms provided allow a TCP to advertise a large window and to) s
377 243 M
(  subsequently advertise a much smaller window without having accepted) s
377 235 M
(  that much data.  This, so called "shrinking the window," is strongly) s
377 227 M
(  discouraged.  The robustness principle dictates that TCPs will not) s
377 219 M
(  shrink the window themselves, but will be prepared for such behavior) s
377 211 M
(  on the part of other TCPs.) s
377 203 M
( ) s
377 195 M
(  The sending TCP must be prepared to accept from the user and send at) s
377 187 M
(  least one octet of new data even if the send window is zero.  The) s
377 179 M
(  sending TCP must regularly retransmit to the receiving TCP even when) s
377 171 M
(  the window is zero.  Two minutes is recommended for the retransmission) s
377 163 M
(  interval when the window is zero.  This retransmission is essential to) s
377 155 M
(  guarantee that when either TCP has a zero window the re-opening of the) s
377 147 M
(  window will be reliably reported to the other.) s
377 139 M
( ) s
377 131 M
(  When the receiving TCP has a zero window and a segment arrives it must) s
377 123 M
(  still send an acknowledgment showing its next expected sequence number) s
377 115 M
(  and current window \(zero\).) s
377 107 M
( ) s
377 99 M
(  The sending TCP packages the data to be transmitted into segments) s
377 91 M
( ) s
377 83 M
( ) s
377 75 M
([Page 42]                                                               ) s
_R
S
%%Page: (25) 25
%%BeginPageSetup
_S
90 rotate
24 -588 translate
/pagenum 25 def
/fname (rfc793.txt) def
/fdir () def
/ftail (rfc793.txt) def
% User defined strings:
/fmodstr (Thu Aug %2d 13:52:57 2000) def
%%EndPageSetup
do_header
5 531 M
( ) s
5 523 M
(September 1981                                                          ) s
5 515 M
(                                           Transmission Control Protocol) s
5 507 M
(                                                Functional Specification) s
5 499 M
( ) s
5 491 M
( ) s
5 483 M
( ) s
5 475 M
(  which fit the current window, and may repackage segments on the) s
5 467 M
(  retransmission queue.  Such repackaging is not required, but may be) s
5 459 M
(  helpful.) s
5 451 M
( ) s
5 443 M
(  In a connection with a one-way data flow, the window information will) s
5 435 M
(  be carried in acknowledgment segments that all have the same sequence) s
5 427 M
(  number so there will be no way to reorder them if they arrive out of) s
5 419 M
(  order.  This is not a serious problem, but it will allow the window) s
5 411 M
(  information to be on occasion temporarily based on old reports from) s
5 403 M
(  the data receiver.  A refinement to avoid this problem is to act on) s
5 395 M
(  the window information from segments that carry the highest) s
5 387 M
(  acknowledgment number \(that is segments with acknowledgment number) s
5 379 M
(  equal or greater than the highest previously received\).) s
5 371 M
( ) s
5 363 M
(  The window management procedure has significant influence on the) s
5 355 M
(  communication performance.  The following comments are suggestions to) s
5 347 M
(  implementers.) s
5 339 M
( ) s
5 331 M
(    Window Management Suggestions) s
5 323 M
( ) s
5 315 M
(      Allocating a very small window causes data to be transmitted in) s
5 307 M
(      many small segments when better performance is achieved using) s
5 299 M
(      fewer large segments.) s
5 291 M
( ) s
5 283 M
(      One suggestion for avoiding small windows is for the receiver to) s
5 275 M
(      defer updating a window until the additional allocation is at) s
5 267 M
(      least X percent of the maximum allocation possible for the) s
5 259 M
(      connection \(where X might be 20 to 40\).) s
5 251 M
( ) s
5 243 M
(      Another suggestion is for the sender to avoid sending small) s
5 235 M
(      segments by waiting until the window is large enough before) s
5 227 M
(      sending data.  If the the user signals a push function then the) s
5 219 M
(      data must be sent even if it is a small segment.) s
5 211 M
( ) s
5 203 M
(      Note that the acknowledgments should not be delayed or unnecessary) s
5 195 M
(      retransmissions will result.  One strategy would be to send an) s
5 187 M
(      acknowledgment when a small segment arrives \(with out updating the) s
5 179 M
(      window information\), and then to send another acknowledgment with) s
5 171 M
(      new window information when the window is larger.) s
5 163 M
( ) s
5 155 M
(      The segment sent to probe a zero window may also begin a break up) s
5 147 M
(      of transmitted data into smaller and smaller segments.  If a) s
5 139 M
(      segment containing a single data octet sent to probe a zero window) s
5 131 M
(      is accepted, it consumes one octet of the window now available.) s
5 123 M
(      If the sending TCP simply sends as much as it can whenever the) s
5 115 M
(      window is non zero, the transmitted data will be broken into) s
5 107 M
(      alternating big and small segments.  As time goes on, occasional) s
5 99 M
(      pauses in the receiver making window allocation available will) s
5 91 M
( ) s
5 83 M
( ) s
5 75 M
(                                                               [Page 43]) s
377 531 M
( ) s
377 523 M
(                                                          September 1981) s
377 515 M
(Transmission Control Protocol) s
377 507 M
(Functional Specification) s
377 499 M
( ) s
377 491 M
( ) s
377 483 M
( ) s
377 475 M
(      result in breaking the big segments into a small and not quite so) s
377 467 M
(      big pair. And after a while the data transmission will be in) s
377 459 M
(      mostly small segments.) s
377 451 M
( ) s
377 443 M
(      The suggestion here is that the TCP implementations need to) s
377 435 M
(      actively attempt to combine small window allocations into larger) s
377 427 M
(      windows, since the mechanisms for managing the window tend to lead) s
377 419 M
(      to many small windows in the simplest minded implementations.) s
377 411 M
( ) s
377 403 M
(3.8.  Interfaces) s
377 395 M
( ) s
377 387 M
(  There are of course two interfaces of concern:  the user/TCP interface) s
377 379 M
(  and the TCP/lower-level interface.  We have a fairly elaborate model) s
377 371 M
(  of the user/TCP interface, but the interface to the lower level) s
377 363 M
(  protocol module is left unspecified here, since it will be specified) s
377 355 M
(  in detail by the specification of the lowel level protocol.  For the) s
377 347 M
(  case that the lower level is IP we note some of the parameter values) s
377 339 M
(  that TCPs might use.) s
377 331 M
( ) s
377 323 M
(  User/TCP Interface) s
377 315 M
( ) s
377 307 M
(    The following functional description of user commands to the TCP is,) s
377 299 M
(    at best, fictional, since every operating system will have different) s
377 291 M
(    facilities.  Consequently, we must warn readers that different TCP) s
377 283 M
(    implementations may have different user interfaces.  However, all) s
377 275 M
(    TCPs must provide a certain minimum set of services to guarantee) s
377 267 M
(    that all TCP implementations can support the same protocol) s
377 259 M
(    hierarchy.  This section specifies the functional interfaces) s
377 251 M
(    required of all TCP implementations.) s
377 243 M
( ) s
377 235 M
(    TCP User Commands) s
377 227 M
( ) s
377 219 M
(      The following sections functionally characterize a USER/TCP) s
377 211 M
(      interface.  The notation used is similar to most procedure or) s
377 203 M
(      function calls in high level languages, but this usage is not) s
377 195 M
(      meant to rule out trap type service calls \(e.g., SVCs, UUOs,) s
377 187 M
(      EMTs\).) s
377 179 M
( ) s
377 171 M
(      The user commands described below specify the basic functions the) s
377 163 M
(      TCP must perform to support interprocess communication.) s
377 155 M
(      Individual implementations must define their own exact format, and) s
377 147 M
(      may provide combinations or subsets of the basic functions in) s
377 139 M
(      single calls.  In particular, some implementations may wish to) s
377 131 M
(      automatically OPEN a connection on the first SEND or RECEIVE) s
377 123 M
(      issued by the user for a given connection.) s
377 115 M
( ) s
377 107 M
( ) s
377 99 M
( ) s
377 91 M
( ) s
377 83 M
( ) s
377 75 M
([Page 44]                                                               ) s
_R
S
%%Page: (26) 26
%%BeginPageSetup
_S
90 rotate
24 -588 translate
/pagenum 26 def
/fname (rfc793.txt) def
/fdir () def
/ftail (rfc793.txt) def
% User defined strings:
/fmodstr (Thu Aug %2d 13:52:57 2000) def
%%EndPageSetup
do_header
5 531 M
( ) s
5 523 M
(September 1981                                                          ) s
5 515 M
(                                           Transmission Control Protocol) s
5 507 M
(                                                Functional Specification) s
5 499 M
( ) s
5 491 M
( ) s
5 483 M
( ) s
5 475 M
(      In providing interprocess communication facilities, the TCP must) s
5 467 M
(      not only accept commands, but must also return information to the) s
5 459 M
(      processes it serves.  The latter consists of:) s
5 451 M
( ) s
5 443 M
(        \(a\) general information about a connection \(e.g., interrupts,) s
5 435 M
(        remote close, binding of unspecified foreign socket\).) s
5 427 M
( ) s
5 419 M
(        \(b\) replies to specific user commands indicating success or) s
5 411 M
(        various types of failure.) s
5 403 M
( ) s
5 395 M
(      Open) s
5 387 M
( ) s
5 379 M
(        Format:  OPEN \(local port, foreign socket, active/passive) s
5 371 M
(        [, timeout] [, precedence] [, security/compartment] [, options]\)) s
5 363 M
(        -> local connection name) s
5 355 M
( ) s
5 347 M
(        We assume that the local TCP is aware of the identity of the) s
5 339 M
(        processes it serves and will check the authority of the process) s
5 331 M
(        to use the connection specified.  Depending upon the) s
5 323 M
(        implementation of the TCP, the local network and TCP identifiers) s
5 315 M
(        for the source address will either be supplied by the TCP or the) s
5 307 M
(        lower level protocol \(e.g., IP\).  These considerations are the) s
5 299 M
(        result of concern about security, to the extent that no TCP be) s
5 291 M
(        able to masquerade as another one, and so on.  Similarly, no) s
5 283 M
(        process can masquerade as another without the collusion of the) s
5 275 M
(        TCP.) s
5 267 M
( ) s
5 259 M
(        If the active/passive flag is set to passive, then this is a) s
5 251 M
(        call to LISTEN for an incoming connection.  A passive open may) s
5 243 M
(        have either a fully specified foreign socket to wait for a) s
5 235 M
(        particular connection or an unspecified foreign socket to wait) s
5 227 M
(        for any call.  A fully specified passive call can be made active) s
5 219 M
(        by the subsequent execution of a SEND.) s
5 211 M
( ) s
5 203 M
(        A transmission control block \(TCB\) is created and partially) s
5 195 M
(        filled in with data from the OPEN command parameters.) s
5 187 M
( ) s
5 179 M
(        On an active OPEN command, the TCP will begin the procedure to) s
5 171 M
(        synchronize \(i.e., establish\) the connection at once.) s
5 163 M
( ) s
5 155 M
(        The timeout, if present, permits the caller to set up a timeout) s
5 147 M
(        for all data submitted to TCP.  If data is not successfully) s
5 139 M
(        delivered to the destination within the timeout period, the TCP) s
5 131 M
(        will abort the connection.  The present global default is five) s
5 123 M
(        minutes.) s
5 115 M
( ) s
5 107 M
(        The TCP or some component of the operating system will verify) s
5 99 M
(        the users authority to open a connection with the specified) s
5 91 M
( ) s
5 83 M
( ) s
5 75 M
(                                                               [Page 45]) s
377 531 M
( ) s
377 523 M
(                                                          September 1981) s
377 515 M
(Transmission Control Protocol) s
377 507 M
(Functional Specification) s
377 499 M
( ) s
377 491 M
( ) s
377 483 M
( ) s
377 475 M
(        precedence or security/compartment.  The absence of precedence) s
377 467 M
(        or security/compartment specification in the OPEN call indicates) s
377 459 M
(        the default values must be used.) s
377 451 M
( ) s
377 443 M
(        TCP will accept incoming requests as matching only if the) s
377 435 M
(        security/compartment information is exactly the same and only if) s
377 427 M
(        the precedence is equal to or higher than the precedence) s
377 419 M
(        requested in the OPEN call.) s
377 411 M
( ) s
377 403 M
(        The precedence for the connection is the higher of the values) s
377 395 M
(        requested in the OPEN call and received from the incoming) s
377 387 M
(        request, and fixed at that value for the life of the) s
377 379 M
(        connection.Implementers may want to give the user control of) s
377 371 M
(        this precedence negotiation.  For example, the user might be) s
377 363 M
(        allowed to specify that the precedence must be exactly matched,) s
377 355 M
(        or that any attempt to raise the precedence be confirmed by the) s
377 347 M
(        user.) s
377 339 M
( ) s
377 331 M
(        A local connection name will be returned to the user by the TCP.) s
377 323 M
(        The local connection name can then be used as a short hand term) s
377 315 M
(        for the connection defined by the <local socket, foreign socket>) s
377 307 M
(        pair.) s
377 299 M
( ) s
377 291 M
(      Send) s
377 283 M
( ) s
377 275 M
(        Format:  SEND \(local connection name, buffer address, byte) s
377 267 M
(        count, PUSH flag, URGENT flag [,timeout]\)) s
377 259 M
( ) s
377 251 M
(        This call causes the data contained in the indicated user buffer) s
377 243 M
(        to be sent on the indicated connection.  If the connection has) s
377 235 M
(        not been opened, the SEND is considered an error.  Some) s
377 227 M
(        implementations may allow users to SEND first; in which case, an) s
377 219 M
(        automatic OPEN would be done.  If the calling process is not) s
377 211 M
(        authorized to use this connection, an error is returned.) s
377 203 M
( ) s
377 195 M
(        If the PUSH flag is set, the data must be transmitted promptly) s
377 187 M
(        to the receiver, and the PUSH bit will be set in the last TCP) s
377 179 M
(        segment created from the buffer.  If the PUSH flag is not set,) s
377 171 M
(        the data may be combined with data from subsequent SENDs for) s
377 163 M
(        transmission efficiency.) s
377 155 M
( ) s
377 147 M
(        If the URGENT flag is set, segments sent to the destination TCP) s
377 139 M
(        will have the urgent pointer set.  The receiving TCP will signal) s
377 131 M
(        the urgent condition to the receiving process if the urgent) s
377 123 M
(        pointer indicates that data preceding the urgent pointer has not) s
377 115 M
(        been consumed by the receiving process.  The purpose of urgent) s
377 107 M
(        is to stimulate the receiver to process the urgent data and to) s
377 99 M
(        indicate to the receiver when all the currently known urgent) s
377 91 M
( ) s
377 83 M
( ) s
377 75 M
([Page 46]                                                               ) s
_R
S
%%Page: (27) 27
%%BeginPageSetup
_S
90 rotate
24 -588 translate
/pagenum 27 def
/fname (rfc793.txt) def
/fdir () def
/ftail (rfc793.txt) def
% User defined strings:
/fmodstr (Thu Aug %2d 13:52:57 2000) def
%%EndPageSetup
do_header
5 531 M
( ) s
5 523 M
(September 1981                                                          ) s
5 515 M
(                                           Transmission Control Protocol) s
5 507 M
(                                                Functional Specification) s
5 499 M
( ) s
5 491 M
( ) s
5 483 M
( ) s
5 475 M
(        data has been received.  The number of times the sending user's) s
5 467 M
(        TCP signals urgent will not necessarily be equal to the number) s
5 459 M
(        of times the receiving user will be notified of the presence of) s
5 451 M
(        urgent data.) s
5 443 M
( ) s
5 435 M
(        If no foreign socket was specified in the OPEN, but the) s
5 427 M
(        connection is established \(e.g., because a LISTENing connection) s
5 419 M
(        has become specific due to a foreign segment arriving for the) s
5 411 M
(        local socket\), then the designated buffer is sent to the implied) s
5 403 M
(        foreign socket.  Users who make use of OPEN with an unspecified) s
5 395 M
(        foreign socket can make use of SEND without ever explicitly) s
5 387 M
(        knowing the foreign socket address.) s
5 379 M
( ) s
5 371 M
(        However, if a SEND is attempted before the foreign socket) s
5 363 M
(        becomes specified, an error will be returned.  Users can use the) s
5 355 M
(        STATUS call to determine the status of the connection.  In some) s
5 347 M
(        implementations the TCP may notify the user when an unspecified) s
5 339 M
(        socket is bound.) s
5 331 M
( ) s
5 323 M
(        If a timeout is specified, the current user timeout for this) s
5 315 M
(        connection is changed to the new one.) s
5 307 M
( ) s
5 299 M
(        In the simplest implementation, SEND would not return control to) s
5 291 M
(        the sending process until either the transmission was complete) s
5 283 M
(        or the timeout had been exceeded.  However, this simple method) s
5 275 M
(        is both subject to deadlocks \(for example, both sides of the) s
5 267 M
(        connection might try to do SENDs before doing any RECEIVEs\) and) s
5 259 M
(        offers poor performance, so it is not recommended.  A more) s
5 251 M
(        sophisticated implementation would return immediately to allow) s
5 243 M
(        the process to run concurrently with network I/O, and,) s
5 235 M
(        furthermore, to allow multiple SENDs to be in progress.) s
5 227 M
(        Multiple SENDs are served in first come, first served order, so) s
5 219 M
(        the TCP will queue those it cannot service immediately.) s
5 211 M
( ) s
5 203 M
(        We have implicitly assumed an asynchronous user interface in) s
5 195 M
(        which a SEND later elicits some kind of SIGNAL or) s
5 187 M
(        pseudo-interrupt from the serving TCP.  An alternative is to) s
5 179 M
(        return a response immediately.  For instance, SENDs might return) s
5 171 M
(        immediate local acknowledgment, even if the segment sent had not) s
5 163 M
(        been acknowledged by the distant TCP.  We could optimistically) s
5 155 M
(        assume eventual success.  If we are wrong, the connection will) s
5 147 M
(        close anyway due to the timeout.  In implementations of this) s
5 139 M
(        kind \(synchronous\), there will still be some asynchronous) s
5 131 M
(        signals, but these will deal with the connection itself, and not) s
5 123 M
(        with specific segments or buffers.) s
5 115 M
( ) s
5 107 M
(        In order for the process to distinguish among error or success) s
5 99 M
(        indications for different SENDs, it might be appropriate for the) s
5 91 M
( ) s
5 83 M
( ) s
5 75 M
(                                                               [Page 47]) s
377 531 M
( ) s
377 523 M
(                                                          September 1981) s
377 515 M
(Transmission Control Protocol) s
377 507 M
(Functional Specification) s
377 499 M
( ) s
377 491 M
( ) s
377 483 M
( ) s
377 475 M
(        buffer address to be returned along with the coded response to) s
377 467 M
(        the SEND request.  TCP-to-user signals are discussed below,) s
377 459 M
(        indicating the information which should be returned to the) s
377 451 M
(        calling process.) s
377 443 M
( ) s
377 435 M
(      Receive) s
377 427 M
( ) s
377 419 M
(        Format:  RECEIVE \(local connection name, buffer address, byte) s
377 411 M
(        count\) -> byte count, urgent flag, push flag) s
377 403 M
( ) s
377 395 M
(        This command allocates a receiving buffer associated with the) s
377 387 M
(        specified connection.  If no OPEN precedes this command or the) s
377 379 M
(        calling process is not authorized to use this connection, an) s
377 371 M
(        error is returned.) s
377 363 M
( ) s
377 355 M
(        In the simplest implementation, control would not return to the) s
377 347 M
(        calling program until either the buffer was filled, or some) s
377 339 M
(        error occurred, but this scheme is highly subject to deadlocks.) s
377 331 M
(        A more sophisticated implementation would permit several) s
377 323 M
(        RECEIVEs to be outstanding at once.  These would be filled as) s
377 315 M
(        segments arrive.  This strategy permits increased throughput at) s
377 307 M
(        the cost of a more elaborate scheme \(possibly asynchronous\) to) s
377 299 M
(        notify the calling program that a PUSH has been seen or a buffer) s
377 291 M
(        filled.) s
377 283 M
( ) s
377 275 M
(        If enough data arrive to fill the buffer before a PUSH is seen,) s
377 267 M
(        the PUSH flag will not be set in the response to the RECEIVE.) s
377 259 M
(        The buffer will be filled with as much data as it can hold.  If) s
377 251 M
(        a PUSH is seen before the buffer is filled the buffer will be) s
377 243 M
(        returned partially filled and PUSH indicated.) s
377 235 M
( ) s
377 227 M
(        If there is urgent data the user will have been informed as soon) s
377 219 M
(        as it arrived via a TCP-to-user signal.  The receiving user) s
377 211 M
(        should thus be in "urgent mode".  If the URGENT flag is on,) s
377 203 M
(        additional urgent data remains.  If the URGENT flag is off, this) s
377 195 M
(        call to RECEIVE has returned all the urgent data, and the user) s
377 187 M
(        may now leave "urgent mode".  Note that data following the) s
377 179 M
(        urgent pointer \(non-urgent data\) cannot be delivered to the user) s
377 171 M
(        in the same buffer with preceeding urgent data unless the) s
377 163 M
(        boundary is clearly marked for the user.) s
377 155 M
( ) s
377 147 M
(        To distinguish among several outstanding RECEIVEs and to take) s
377 139 M
(        care of the case that a buffer is not completely filled, the) s
377 131 M
(        return code is accompanied by both a buffer pointer and a byte) s
377 123 M
(        count indicating the actual length of the data received.) s
377 115 M
( ) s
377 107 M
(        Alternative implementations of RECEIVE might have the TCP) s
377 99 M
( ) s
377 91 M
( ) s
377 83 M
( ) s
377 75 M
([Page 48]                                                               ) s
_R
S
%%Page: (28) 28
%%BeginPageSetup
_S
90 rotate
24 -588 translate
/pagenum 28 def
/fname (rfc793.txt) def
/fdir () def
/ftail (rfc793.txt) def
% User defined strings:
/fmodstr (Thu Aug %2d 13:52:57 2000) def
%%EndPageSetup
do_header
5 531 M
( ) s
5 523 M
(September 1981                                                          ) s
5 515 M
(                                           Transmission Control Protocol) s
5 507 M
(                                                Functional Specification) s
5 499 M
( ) s
5 491 M
( ) s
5 483 M
( ) s
5 475 M
(        allocate buffer storage, or the TCP might share a ring buffer) s
5 467 M
(        with the user.) s
5 459 M
( ) s
5 451 M
(      Close) s
5 443 M
( ) s
5 435 M
(        Format:  CLOSE \(local connection name\)) s
5 427 M
( ) s
5 419 M
(        This command causes the connection specified to be closed.  If) s
5 411 M
(        the connection is not open or the calling process is not) s
5 403 M
(        authorized to use this connection, an error is returned.) s
5 395 M
(        Closing connections is intended to be a graceful operation in) s
5 387 M
(        the sense that outstanding SENDs will be transmitted \(and) s
5 379 M
(        retransmitted\), as flow control permits, until all have been) s
5 371 M
(        serviced.  Thus, it should be acceptable to make several SEND) s
5 363 M
(        calls, followed by a CLOSE, and expect all the data to be sent) s
5 355 M
(        to the destination.  It should also be clear that users should) s
5 347 M
(        continue to RECEIVE on CLOSING connections, since the other side) s
5 339 M
(        may be trying to transmit the last of its data.  Thus, CLOSE) s
5 331 M
(        means "I have no more to send" but does not mean "I will not) s
5 323 M
(        receive any more."  It may happen \(if the user level protocol is) s
5 315 M
(        not well thought out\) that the closing side is unable to get rid) s
5 307 M
(        of all its data before timing out.  In this event, CLOSE turns) s
5 299 M
(        into ABORT, and the closing TCP gives up.) s
5 291 M
( ) s
5 283 M
(        The user may CLOSE the connection at any time on his own) s
5 275 M
(        initiative, or in response to various prompts from the TCP) s
5 267 M
(        \(e.g., remote close executed, transmission timeout exceeded,) s
5 259 M
(        destination inaccessible\).) s
5 251 M
( ) s
5 243 M
(        Because closing a connection requires communication with the) s
5 235 M
(        foreign TCP, connections may remain in the closing state for a) s
5 227 M
(        short time.  Attempts to reopen the connection before the TCP) s
5 219 M
(        replies to the CLOSE command will result in error responses.) s
5 211 M
( ) s
5 203 M
(        Close also implies push function.) s
5 195 M
( ) s
5 187 M
(      Status) s
5 179 M
( ) s
5 171 M
(        Format:  STATUS \(local connection name\) -> status data) s
5 163 M
( ) s
5 155 M
(        This is an implementation dependent user command and could be) s
5 147 M
(        excluded without adverse effect.  Information returned would) s
5 139 M
(        typically come from the TCB associated with the connection.) s
5 131 M
( ) s
5 123 M
(        This command returns a data block containing the following) s
5 115 M
(        information:) s
5 107 M
( ) s
5 99 M
(          local socket,) s
5 91 M
( ) s
5 83 M
( ) s
5 75 M
(                                                               [Page 49]) s
377 531 M
( ) s
377 523 M
(                                                          September 1981) s
377 515 M
(Transmission Control Protocol) s
377 507 M
(Functional Specification) s
377 499 M
( ) s
377 491 M
( ) s
377 483 M
( ) s
377 475 M
(          foreign socket,) s
377 467 M
(          local connection name,) s
377 459 M
(          receive window,) s
377 451 M
(          send window,) s
377 443 M
(          connection state,) s
377 435 M
(          number of buffers awaiting acknowledgment,) s
377 427 M
(          number of buffers pending receipt,) s
377 419 M
(          urgent state,) s
377 411 M
(          precedence,) s
377 403 M
(          security/compartment,) s
377 395 M
(          and transmission timeout.) s
377 387 M
( ) s
377 379 M
(        Depending on the state of the connection, or on the) s
377 371 M
(        implementation itself, some of this information may not be) s
377 363 M
(        available or meaningful.  If the calling process is not) s
377 355 M
(        authorized to use this connection, an error is returned.  This) s
377 347 M
(        prevents unauthorized processes from gaining information about a) s
377 339 M
(        connection.) s
377 331 M
( ) s
377 323 M
(      Abort) s
377 315 M
( ) s
377 307 M
(        Format:  ABORT \(local connection name\)) s
377 299 M
( ) s
377 291 M
(        This command causes all pending SENDs and RECEIVES to be) s
377 283 M
(        aborted, the TCB to be removed, and a special RESET message to) s
377 275 M
(        be sent to the TCP on the other side of the connection.) s
377 267 M
(        Depending on the implementation, users may receive abort) s
377 259 M
(        indications for each outstanding SEND or RECEIVE, or may simply) s
377 251 M
(        receive an ABORT-acknowledgment.) s
377 243 M
( ) s
377 235 M
(    TCP-to-User Messages) s
377 227 M
( ) s
377 219 M
(      It is assumed that the operating system environment provides a) s
377 211 M
(      means for the TCP to asynchronously signal the user program.  When) s
377 203 M
(      the TCP does signal a user program, certain information is passed) s
377 195 M
(      to the user.  Often in the specification the information will be) s
377 187 M
(      an error message.  In other cases there will be information) s
377 179 M
(      relating to the completion of processing a SEND or RECEIVE or) s
377 171 M
(      other user call.) s
377 163 M
( ) s
377 155 M
(      The following information is provided:) s
377 147 M
( ) s
377 139 M
(        Local Connection Name                    Always) s
377 131 M
(        Response String                          Always) s
377 123 M
(        Buffer Address                           Send & Receive) s
377 115 M
(        Byte count \(counts bytes received\)       Receive) s
377 107 M
(        Push flag                                Receive) s
377 99 M
(        Urgent flag                              Receive) s
377 91 M
( ) s
377 83 M
( ) s
377 75 M
([Page 50]                                                               ) s
_R
S
%%Page: (29) 29
%%BeginPageSetup
_S
90 rotate
24 -588 translate
/pagenum 29 def
/fname (rfc793.txt) def
/fdir () def
/ftail (rfc793.txt) def
% User defined strings:
/fmodstr (Thu Aug %2d 13:52:57 2000) def
%%EndPageSetup
do_header
5 531 M
( ) s
5 523 M
(September 1981                                                          ) s
5 515 M
(                                           Transmission Control Protocol) s
5 507 M
(                                                Functional Specification) s
5 499 M
( ) s
5 491 M
( ) s
5 483 M
( ) s
5 475 M
(  TCP/Lower-Level Interface) s
5 467 M
( ) s
5 459 M
(    The TCP calls on a lower level protocol module to actually send and) s
5 451 M
(    receive information over a network.  One case is that of the ARPA) s
5 443 M
(    internetwork system where the lower level module is the Internet) s
5 435 M
(    Protocol \(IP\) [2].) s
5 427 M
( ) s
5 419 M
(    If the lower level protocol is IP it provides arguments for a type) s
5 411 M
(    of service and for a time to live.  TCP uses the following settings) s
5 403 M
(    for these parameters:) s
5 395 M
( ) s
5 387 M
(      Type of Service = Precedence: routine, Delay: normal, Throughput:) s
5 379 M
(      normal, Reliability: normal; or 00000000.) s
5 371 M
( ) s
5 363 M
(      Time to Live    = one minute, or 00111100.) s
5 355 M
( ) s
5 347 M
(        Note that the assumed maximum segment lifetime is two minutes.) s
5 339 M
(        Here we explicitly ask that a segment be destroyed if it cannot) s
5 331 M
(        be delivered by the internet system within one minute.) s
5 323 M
( ) s
5 315 M
(    If the lower level is IP \(or other protocol that provides this) s
5 307 M
(    feature\) and source routing is used, the interface must allow the) s
5 299 M
(    route information to be communicated.  This is especially important) s
5 291 M
(    so that the source and destination addresses used in the TCP) s
5 283 M
(    checksum be the originating source and ultimate destination. It is) s
5 275 M
(    also important to preserve the return route to answer connection) s
5 267 M
(    requests.) s
5 259 M
( ) s
5 251 M
(    Any lower level protocol will have to provide the source address,) s
5 243 M
(    destination address, and protocol fields, and some way to determine) s
5 235 M
(    the "TCP length", both to provide the functional equivlent service) s
5 227 M
(    of IP and to be used in the TCP checksum.) s
5 219 M
( ) s
5 211 M
( ) s
5 203 M
( ) s
5 195 M
( ) s
5 187 M
( ) s
5 179 M
( ) s
5 171 M
( ) s
5 163 M
( ) s
5 155 M
( ) s
5 147 M
( ) s
5 139 M
( ) s
5 131 M
( ) s
5 123 M
( ) s
5 115 M
( ) s
5 107 M
( ) s
5 99 M
( ) s
5 91 M
( ) s
5 83 M
( ) s
5 75 M
(                                                               [Page 51]) s
377 531 M
( ) s
377 523 M
(                                                          September 1981) s
377 515 M
(Transmission Control Protocol) s
377 507 M
(Functional Specification) s
377 499 M
( ) s
377 491 M
( ) s
377 483 M
( ) s
377 475 M
(3.9.  Event Processing) s
377 467 M
( ) s
377 459 M
(  The processing depicted in this section is an example of one possible) s
377 451 M
(  implementation.  Other implementations may have slightly different) s
377 443 M
(  processing sequences, but they should differ from those in this) s
377 435 M
(  section only in detail, not in substance.) s
377 427 M
( ) s
377 419 M
(  The activity of the TCP can be characterized as responding to events.) s
377 411 M
(  The events that occur can be cast into three categories:  user calls,) s
377 403 M
(  arriving segments, and timeouts.  This section describes the) s
377 395 M
(  processing the TCP does in response to each of the events.  In many) s
377 387 M
(  cases the processing required depends on the state of the connection.) s
377 379 M
( ) s
377 371 M
(    Events that occur:) s
377 363 M
( ) s
377 355 M
(      User Calls) s
377 347 M
( ) s
377 339 M
(        OPEN) s
377 331 M
(        SEND) s
377 323 M
(        RECEIVE) s
377 315 M
(        CLOSE) s
377 307 M
(        ABORT) s
377 299 M
(        STATUS) s
377 291 M
( ) s
377 283 M
(      Arriving Segments) s
377 275 M
( ) s
377 267 M
(        SEGMENT ARRIVES) s
377 259 M
( ) s
377 251 M
(      Timeouts) s
377 243 M
( ) s
377 235 M
(        USER TIMEOUT) s
377 227 M
(        RETRANSMISSION TIMEOUT) s
377 219 M
(        TIME-WAIT TIMEOUT) s
377 211 M
( ) s
377 203 M
(  The model of the TCP/user interface is that user commands receive an) s
377 195 M
(  immediate return and possibly a delayed response via an event or) s
377 187 M
(  pseudo interrupt.  In the following descriptions, the term "signal") s
377 179 M
(  means cause a delayed response.) s
377 171 M
( ) s
377 163 M
(  Error responses are given as character strings.  For example, user) s
377 155 M
(  commands referencing connections that do not exist receive "error:) s
377 147 M
(  connection not open".) s
377 139 M
( ) s
377 131 M
(  Please note in the following that all arithmetic on sequence numbers,) s
377 123 M
(  acknowledgment numbers, windows, et cetera, is modulo 2**32 the size) s
377 115 M
(  of the sequence number space.  Also note that "=<" means less than or) s
377 107 M
(  equal to \(modulo 2**32\).) s
377 99 M
( ) s
377 91 M
( ) s
377 83 M
( ) s
377 75 M
([Page 52]                                                               ) s
_R
S
%%Page: (30) 30
%%BeginPageSetup
_S
90 rotate
24 -588 translate
/pagenum 30 def
/fname (rfc793.txt) def
/fdir () def
/ftail (rfc793.txt) def
% User defined strings:
/fmodstr (Thu Aug %2d 13:52:57 2000) def
%%EndPageSetup
do_header
5 531 M
( ) s
5 523 M
(September 1981                                                          ) s
5 515 M
(                                           Transmission Control Protocol) s
5 507 M
(                                                Functional Specification) s
5 499 M
( ) s
5 491 M
( ) s
5 483 M
( ) s
5 475 M
(  A natural way to think about processing incoming segments is to) s
5 467 M
(  imagine that they are first tested for proper sequence number \(i.e.,) s
5 459 M
(  that their contents lie in the range of the expected "receive window") s
5 451 M
(  in the sequence number space\) and then that they are generally queued) s
5 443 M
(  and processed in sequence number order.) s
5 435 M
( ) s
5 427 M
(  When a segment overlaps other already received segments we reconstruct) s
5 419 M
(  the segment to contain just the new data, and adjust the header fields) s
5 411 M
(  to be consistent.) s
5 403 M
( ) s
5 395 M
(  Note that if no state change is mentioned the TCP stays in the same) s
5 387 M
(  state.) s
5 379 M
( ) s
5 371 M
( ) s
5 363 M
( ) s
5 355 M
( ) s
5 347 M
( ) s
5 339 M
( ) s
5 331 M
( ) s
5 323 M
( ) s
5 315 M
( ) s
5 307 M
( ) s
5 299 M
( ) s
5 291 M
( ) s
5 283 M
( ) s
5 275 M
( ) s
5 267 M
( ) s
5 259 M
( ) s
5 251 M
( ) s
5 243 M
( ) s
5 235 M
( ) s
5 227 M
( ) s
5 219 M
( ) s
5 211 M
( ) s
5 203 M
( ) s
5 195 M
( ) s
5 187 M
( ) s
5 179 M
( ) s
5 171 M
( ) s
5 163 M
( ) s
5 155 M
( ) s
5 147 M
( ) s
5 139 M
( ) s
5 131 M
( ) s
5 123 M
( ) s
5 115 M
( ) s
5 107 M
( ) s
5 99 M
( ) s
5 91 M
( ) s
5 83 M
( ) s
5 75 M
(                                                               [Page 53]) s
377 531 M
( ) s
377 523 M
(                                                          September 1981) s
377 515 M
(Transmission Control Protocol) s
377 507 M
(Functional Specification) s
377 499 M
(                                                               OPEN Call) s
377 491 M
( ) s
377 483 M
( ) s
377 475 M
( ) s
377 467 M
(  OPEN Call) s
377 459 M
( ) s
377 451 M
(    CLOSED STATE \(i.e., TCB does not exist\)) s
377 443 M
( ) s
377 435 M
(      Create a new transmission control block \(TCB\) to hold connection) s
377 427 M
(      state information.  Fill in local socket identifier, foreign) s
377 419 M
(      socket, precedence, security/compartment, and user timeout) s
377 411 M
(      information.  Note that some parts of the foreign socket may be) s
377 403 M
(      unspecified in a passive OPEN and are to be filled in by the) s
377 395 M
(      parameters of the incoming SYN segment.  Verify the security and) s
377 387 M
(      precedence requested are allowed for this user, if not return) s
377 379 M
(      "error:  precedence not allowed" or "error:  security/compartment) s
377 371 M
(      not allowed."  If passive enter the LISTEN state and return.  If) s
377 363 M
(      active and the foreign socket is unspecified, return "error:) s
377 355 M
(      foreign socket unspecified"; if active and the foreign socket is) s
377 347 M
(      specified, issue a SYN segment.  An initial send sequence number) s
377 339 M
(      \(ISS\) is selected.  A SYN segment of the form <SEQ=ISS><CTL=SYN>) s
377 331 M
(      is sent.  Set SND.UNA to ISS, SND.NXT to ISS+1, enter SYN-SENT) s
377 323 M
(      state, and return.) s
377 315 M
( ) s
377 307 M
(      If the caller does not have access to the local socket specified,) s
377 299 M
(      return "error:  connection illegal for this process".  If there is) s
377 291 M
(      no room to create a new connection, return "error:  insufficient) s
377 283 M
(      resources".) s
377 275 M
( ) s
377 267 M
(    LISTEN STATE) s
377 259 M
( ) s
377 251 M
(      If active and the foreign socket is specified, then change the) s
377 243 M
(      connection from passive to active, select an ISS.  Send a SYN) s
377 235 M
(      segment, set SND.UNA to ISS, SND.NXT to ISS+1.  Enter SYN-SENT) s
377 227 M
(      state.  Data associated with SEND may be sent with SYN segment or) s
377 219 M
(      queued for transmission after entering ESTABLISHED state.  The) s
377 211 M
(      urgent bit if requested in the command must be sent with the data) s
377 203 M
(      segments sent as a result of this command.  If there is no room to) s
377 195 M
(      queue the request, respond with "error:  insufficient resources".) s
377 187 M
(      If Foreign socket was not specified, then return "error:  foreign) s
377 179 M
(      socket unspecified".) s
377 171 M
( ) s
377 163 M
( ) s
377 155 M
( ) s
377 147 M
( ) s
377 139 M
( ) s
377 131 M
( ) s
377 123 M
( ) s
377 115 M
( ) s
377 107 M
( ) s
377 99 M
( ) s
377 91 M
( ) s
377 83 M
( ) s
377 75 M
([Page 54]                                                               ) s
_R
S
%%Page: (31) 31
%%BeginPageSetup
_S
90 rotate
24 -588 translate
/pagenum 31 def
/fname (rfc793.txt) def
/fdir () def
/ftail (rfc793.txt) def
% User defined strings:
/fmodstr (Thu Aug %2d 13:52:57 2000) def
%%EndPageSetup
do_header
5 531 M
( ) s
5 523 M
(September 1981                                                          ) s
5 515 M
(                                           Transmission Control Protocol) s
5 507 M
(                                                Functional Specification) s
5 499 M
(OPEN Call) s
5 491 M
( ) s
5 483 M
( ) s
5 475 M
( ) s
5 467 M
(    SYN-SENT STATE) s
5 459 M
(    SYN-RECEIVED STATE) s
5 451 M
(    ESTABLISHED STATE) s
5 443 M
(    FIN-WAIT-1 STATE) s
5 435 M
(    FIN-WAIT-2 STATE) s
5 427 M
(    CLOSE-WAIT STATE) s
5 419 M
(    CLOSING STATE) s
5 411 M
(    LAST-ACK STATE) s
5 403 M
(    TIME-WAIT STATE) s
5 395 M
( ) s
5 387 M
(      Return "error:  connection already exists".) s
5 379 M
( ) s
5 371 M
( ) s
5 363 M
( ) s
5 355 M
( ) s
5 347 M
( ) s
5 339 M
( ) s
5 331 M
( ) s
5 323 M
( ) s
5 315 M
( ) s
5 307 M
( ) s
5 299 M
( ) s
5 291 M
( ) s
5 283 M
( ) s
5 275 M
( ) s
5 267 M
( ) s
5 259 M
( ) s
5 251 M
( ) s
5 243 M
( ) s
5 235 M
( ) s
5 227 M
( ) s
5 219 M
( ) s
5 211 M
( ) s
5 203 M
( ) s
5 195 M
( ) s
5 187 M
( ) s
5 179 M
( ) s
5 171 M
( ) s
5 163 M
( ) s
5 155 M
( ) s
5 147 M
( ) s
5 139 M
( ) s
5 131 M
( ) s
5 123 M
( ) s
5 115 M
( ) s
5 107 M
( ) s
5 99 M
( ) s
5 91 M
( ) s
5 83 M
( ) s
5 75 M
(                                                               [Page 55]) s
377 531 M
( ) s
377 523 M
(                                                          September 1981) s
377 515 M
(Transmission Control Protocol) s
377 507 M
(Functional Specification) s
377 499 M
(                                                               SEND Call) s
377 491 M
( ) s
377 483 M
( ) s
377 475 M
( ) s
377 467 M
(  SEND Call) s
377 459 M
( ) s
377 451 M
(    CLOSED STATE \(i.e., TCB does not exist\)) s
377 443 M
( ) s
377 435 M
(      If the user does not have access to such a connection, then return) s
377 427 M
(      "error:  connection illegal for this process".) s
377 419 M
( ) s
377 411 M
(      Otherwise, return "error:  connection does not exist".) s
377 403 M
( ) s
377 395 M
(    LISTEN STATE) s
377 387 M
( ) s
377 379 M
(      If the foreign socket is specified, then change the connection) s
377 371 M
(      from passive to active, select an ISS.  Send a SYN segment, set) s
377 363 M
(      SND.UNA to ISS, SND.NXT to ISS+1.  Enter SYN-SENT state.  Data) s
377 355 M
(      associated with SEND may be sent with SYN segment or queued for) s
377 347 M
(      transmission after entering ESTABLISHED state.  The urgent bit if) s
377 339 M
(      requested in the command must be sent with the data segments sent) s
377 331 M
(      as a result of this command.  If there is no room to queue the) s
377 323 M
(      request, respond with "error:  insufficient resources".  If) s
377 315 M
(      Foreign socket was not specified, then return "error:  foreign) s
377 307 M
(      socket unspecified".) s
377 299 M
( ) s
377 291 M
(    SYN-SENT STATE) s
377 283 M
(    SYN-RECEIVED STATE) s
377 275 M
( ) s
377 267 M
(      Queue the data for transmission after entering ESTABLISHED state.) s
377 259 M
(      If no space to queue, respond with "error:  insufficient) s
377 251 M
(      resources".) s
377 243 M
( ) s
377 235 M
(    ESTABLISHED STATE) s
377 227 M
(    CLOSE-WAIT STATE) s
377 219 M
( ) s
377 211 M
(      Segmentize the buffer and send it with a piggybacked) s
377 203 M
(      acknowledgment \(acknowledgment value = RCV.NXT\).  If there is) s
377 195 M
(      insufficient space to remember this buffer, simply return "error:) s
377 187 M
(      insufficient resources".) s
377 179 M
( ) s
377 171 M
(      If the urgent flag is set, then SND.UP <- SND.NXT-1 and set the) s
377 163 M
(      urgent pointer in the outgoing segments.) s
377 155 M
( ) s
377 147 M
( ) s
377 139 M
( ) s
377 131 M
( ) s
377 123 M
( ) s
377 115 M
( ) s
377 107 M
( ) s
377 99 M
( ) s
377 91 M
( ) s
377 83 M
( ) s
377 75 M
([Page 56]                                                               ) s
_R
S
%%Page: (32) 32
%%BeginPageSetup
_S
90 rotate
24 -588 translate
/pagenum 32 def
/fname (rfc793.txt) def
/fdir () def
/ftail (rfc793.txt) def
% User defined strings:
/fmodstr (Thu Aug %2d 13:52:57 2000) def
%%EndPageSetup
do_header
5 531 M
( ) s
5 523 M
(September 1981                                                          ) s
5 515 M
(                                           Transmission Control Protocol) s
5 507 M
(                                                Functional Specification) s
5 499 M
(SEND Call) s
5 491 M
( ) s
5 483 M
( ) s
5 475 M
( ) s
5 467 M
(    FIN-WAIT-1 STATE) s
5 459 M
(    FIN-WAIT-2 STATE) s
5 451 M
(    CLOSING STATE) s
5 443 M
(    LAST-ACK STATE) s
5 435 M
(    TIME-WAIT STATE) s
5 427 M
( ) s
5 419 M
(      Return "error:  connection closing" and do not service request.) s
5 411 M
( ) s
5 403 M
( ) s
5 395 M
( ) s
5 387 M
( ) s
5 379 M
( ) s
5 371 M
( ) s
5 363 M
( ) s
5 355 M
( ) s
5 347 M
( ) s
5 339 M
( ) s
5 331 M
( ) s
5 323 M
( ) s
5 315 M
( ) s
5 307 M
( ) s
5 299 M
( ) s
5 291 M
( ) s
5 283 M
( ) s
5 275 M
( ) s
5 267 M
( ) s
5 259 M
( ) s
5 251 M
( ) s
5 243 M
( ) s
5 235 M
( ) s
5 227 M
( ) s
5 219 M
( ) s
5 211 M
( ) s
5 203 M
( ) s
5 195 M
( ) s
5 187 M
( ) s
5 179 M
( ) s
5 171 M
( ) s
5 163 M
( ) s
5 155 M
( ) s
5 147 M
( ) s
5 139 M
( ) s
5 131 M
( ) s
5 123 M
( ) s
5 115 M
( ) s
5 107 M
( ) s
5 99 M
( ) s
5 91 M
( ) s
5 83 M
( ) s
5 75 M
(                                                               [Page 57]) s
377 531 M
( ) s
377 523 M
(                                                          September 1981) s
377 515 M
(Transmission Control Protocol) s
377 507 M
(Functional Specification) s
377 499 M
(                                                            RECEIVE Call) s
377 491 M
( ) s
377 483 M
( ) s
377 475 M
( ) s
377 467 M
(  RECEIVE Call) s
377 459 M
( ) s
377 451 M
(    CLOSED STATE \(i.e., TCB does not exist\)) s
377 443 M
( ) s
377 435 M
(      If the user does not have access to such a connection, return) s
377 427 M
(      "error:  connection illegal for this process".) s
377 419 M
( ) s
377 411 M
(      Otherwise return "error:  connection does not exist".) s
377 403 M
( ) s
377 395 M
(    LISTEN STATE) s
377 387 M
(    SYN-SENT STATE) s
377 379 M
(    SYN-RECEIVED STATE) s
377 371 M
( ) s
377 363 M
(      Queue for processing after entering ESTABLISHED state.  If there) s
377 355 M
(      is no room to queue this request, respond with "error:) s
377 347 M
(      insufficient resources".) s
377 339 M
( ) s
377 331 M
(    ESTABLISHED STATE) s
377 323 M
(    FIN-WAIT-1 STATE) s
377 315 M
(    FIN-WAIT-2 STATE) s
377 307 M
( ) s
377 299 M
(      If insufficient incoming segments are queued to satisfy the) s
377 291 M
(      request, queue the request.  If there is no queue space to) s
377 283 M
(      remember the RECEIVE, respond with "error:  insufficient) s
377 275 M
(      resources".) s
377 267 M
( ) s
377 259 M
(      Reassemble queued incoming segments into receive buffer and return) s
377 251 M
(      to user.  Mark "push seen" \(PUSH\) if this is the case.) s
377 243 M
( ) s
377 235 M
(      If RCV.UP is in advance of the data currently being passed to the) s
377 227 M
(      user notify the user of the presence of urgent data.) s
377 219 M
( ) s
377 211 M
(      When the TCP takes responsibility for delivering data to the user) s
377 203 M
(      that fact must be communicated to the sender via an) s
377 195 M
(      acknowledgment.  The formation of such an acknowledgment is) s
377 187 M
(      described below in the discussion of processing an incoming) s
377 179 M
(      segment.) s
377 171 M
( ) s
377 163 M
( ) s
377 155 M
( ) s
377 147 M
( ) s
377 139 M
( ) s
377 131 M
( ) s
377 123 M
( ) s
377 115 M
( ) s
377 107 M
( ) s
377 99 M
( ) s
377 91 M
( ) s
377 83 M
( ) s
377 75 M
([Page 58]                                                               ) s
_R
S
%%Page: (33) 33
%%BeginPageSetup
_S
90 rotate
24 -588 translate
/pagenum 33 def
/fname (rfc793.txt) def
/fdir () def
/ftail (rfc793.txt) def
% User defined strings:
/fmodstr (Thu Aug %2d 13:52:57 2000) def
%%EndPageSetup
do_header
5 531 M
( ) s
5 523 M
(September 1981                                                          ) s
5 515 M
(                                           Transmission Control Protocol) s
5 507 M
(                                                Functional Specification) s
5 499 M
(RECEIVE Call) s
5 491 M
( ) s
5 483 M
( ) s
5 475 M
( ) s
5 467 M
(    CLOSE-WAIT STATE) s
5 459 M
( ) s
5 451 M
(      Since the remote side has already sent FIN, RECEIVEs must be) s
5 443 M
(      satisfied by text already on hand, but not yet delivered to the) s
5 435 M
(      user.  If no text is awaiting delivery, the RECEIVE will get a) s
5 427 M
(      "error:  connection closing" response.  Otherwise, any remaining) s
5 419 M
(      text can be used to satisfy the RECEIVE.) s
5 411 M
( ) s
5 403 M
(    CLOSING STATE) s
5 395 M
(    LAST-ACK STATE) s
5 387 M
(    TIME-WAIT STATE) s
5 379 M
( ) s
5 371 M
(      Return "error:  connection closing".) s
5 363 M
( ) s
5 355 M
( ) s
5 347 M
( ) s
5 339 M
( ) s
5 331 M
( ) s
5 323 M
( ) s
5 315 M
( ) s
5 307 M
( ) s
5 299 M
( ) s
5 291 M
( ) s
5 283 M
( ) s
5 275 M
( ) s
5 267 M
( ) s
5 259 M
( ) s
5 251 M
( ) s
5 243 M
( ) s
5 235 M
( ) s
5 227 M
( ) s
5 219 M
( ) s
5 211 M
( ) s
5 203 M
( ) s
5 195 M
( ) s
5 187 M
( ) s
5 179 M
( ) s
5 171 M
( ) s
5 163 M
( ) s
5 155 M
( ) s
5 147 M
( ) s
5 139 M
( ) s
5 131 M
( ) s
5 123 M
( ) s
5 115 M
( ) s
5 107 M
( ) s
5 99 M
( ) s
5 91 M
( ) s
5 83 M
( ) s
5 75 M
(                                                               [Page 59]) s
377 531 M
( ) s
377 523 M
(                                                          September 1981) s
377 515 M
(Transmission Control Protocol) s
377 507 M
(Functional Specification) s
377 499 M
(                                                              CLOSE Call) s
377 491 M
( ) s
377 483 M
( ) s
377 475 M
( ) s
377 467 M
(  CLOSE Call) s
377 459 M
( ) s
377 451 M
(    CLOSED STATE \(i.e., TCB does not exist\)) s
377 443 M
( ) s
377 435 M
(      If the user does not have access to such a connection, return) s
377 427 M
(      "error:  connection illegal for this process".) s
377 419 M
( ) s
377 411 M
(      Otherwise, return "error:  connection does not exist".) s
377 403 M
( ) s
377 395 M
(    LISTEN STATE) s
377 387 M
( ) s
377 379 M
(      Any outstanding RECEIVEs are returned with "error:  closing") s
377 371 M
(      responses.  Delete TCB, enter CLOSED state, and return.) s
377 363 M
( ) s
377 355 M
(    SYN-SENT STATE) s
377 347 M
( ) s
377 339 M
(      Delete the TCB and return "error:  closing" responses to any) s
377 331 M
(      queued SENDs, or RECEIVEs.) s
377 323 M
( ) s
377 315 M
(    SYN-RECEIVED STATE) s
377 307 M
( ) s
377 299 M
(      If no SENDs have been issued and there is no pending data to send,) s
377 291 M
(      then form a FIN segment and send it, and enter FIN-WAIT-1 state;) s
377 283 M
(      otherwise queue for processing after entering ESTABLISHED state.) s
377 275 M
( ) s
377 267 M
(    ESTABLISHED STATE) s
377 259 M
( ) s
377 251 M
(      Queue this until all preceding SENDs have been segmentized, then) s
377 243 M
(      form a FIN segment and send it.  In any case, enter FIN-WAIT-1) s
377 235 M
(      state.) s
377 227 M
( ) s
377 219 M
(    FIN-WAIT-1 STATE) s
377 211 M
(    FIN-WAIT-2 STATE) s
377 203 M
( ) s
377 195 M
(      Strictly speaking, this is an error and should receive a "error:) s
377 187 M
(      connection closing" response.  An "ok" response would be) s
377 179 M
(      acceptable, too, as long as a second FIN is not emitted \(the first) s
377 171 M
(      FIN may be retransmitted though\).) s
377 163 M
( ) s
377 155 M
( ) s
377 147 M
( ) s
377 139 M
( ) s
377 131 M
( ) s
377 123 M
( ) s
377 115 M
( ) s
377 107 M
( ) s
377 99 M
( ) s
377 91 M
( ) s
377 83 M
( ) s
377 75 M
([Page 60]                                                               ) s
_R
S
%%Page: (34) 34
%%BeginPageSetup
_S
90 rotate
24 -588 translate
/pagenum 34 def
/fname (rfc793.txt) def
/fdir () def
/ftail (rfc793.txt) def
% User defined strings:
/fmodstr (Thu Aug %2d 13:52:57 2000) def
%%EndPageSetup
do_header
5 531 M
( ) s
5 523 M
(September 1981                                                          ) s
5 515 M
(                                           Transmission Control Protocol) s
5 507 M
(                                                Functional Specification) s
5 499 M
(CLOSE Call) s
5 491 M
( ) s
5 483 M
( ) s
5 475 M
( ) s
5 467 M
(    CLOSE-WAIT STATE) s
5 459 M
( ) s
5 451 M
(      Queue this request until all preceding SENDs have been) s
5 443 M
(      segmentized; then send a FIN segment, enter CLOSING state.) s
5 435 M
( ) s
5 427 M
(    CLOSING STATE) s
5 419 M
(    LAST-ACK STATE) s
5 411 M
(    TIME-WAIT STATE) s
5 403 M
( ) s
5 395 M
(      Respond with "error:  connection closing".) s
5 387 M
( ) s
5 379 M
( ) s
5 371 M
( ) s
5 363 M
( ) s
5 355 M
( ) s
5 347 M
( ) s
5 339 M
( ) s
5 331 M
( ) s
5 323 M
( ) s
5 315 M
( ) s
5 307 M
( ) s
5 299 M
( ) s
5 291 M
( ) s
5 283 M
( ) s
5 275 M
( ) s
5 267 M
( ) s
5 259 M
( ) s
5 251 M
( ) s
5 243 M
( ) s
5 235 M
( ) s
5 227 M
( ) s
5 219 M
( ) s
5 211 M
( ) s
5 203 M
( ) s
5 195 M
( ) s
5 187 M
( ) s
5 179 M
( ) s
5 171 M
( ) s
5 163 M
( ) s
5 155 M
( ) s
5 147 M
( ) s
5 139 M
( ) s
5 131 M
( ) s
5 123 M
( ) s
5 115 M
( ) s
5 107 M
( ) s
5 99 M
( ) s
5 91 M
( ) s
5 83 M
( ) s
5 75 M
(                                                               [Page 61]) s
377 531 M
( ) s
377 523 M
(                                                          September 1981) s
377 515 M
(Transmission Control Protocol) s
377 507 M
(Functional Specification) s
377 499 M
(                                                              ABORT Call) s
377 491 M
( ) s
377 483 M
( ) s
377 475 M
( ) s
377 467 M
(  ABORT Call) s
377 459 M
( ) s
377 451 M
(    CLOSED STATE \(i.e., TCB does not exist\)) s
377 443 M
( ) s
377 435 M
(      If the user should not have access to such a connection, return) s
377 427 M
(      "error:  connection illegal for this process".) s
377 419 M
( ) s
377 411 M
(      Otherwise return "error:  connection does not exist".) s
377 403 M
( ) s
377 395 M
(    LISTEN STATE) s
377 387 M
( ) s
377 379 M
(      Any outstanding RECEIVEs should be returned with "error:) s
377 371 M
(      connection reset" responses.  Delete TCB, enter CLOSED state, and) s
377 363 M
(      return.) s
377 355 M
( ) s
377 347 M
(    SYN-SENT STATE) s
377 339 M
( ) s
377 331 M
(      All queued SENDs and RECEIVEs should be given "connection reset") s
377 323 M
(      notification, delete the TCB, enter CLOSED state, and return.) s
377 315 M
( ) s
377 307 M
(    SYN-RECEIVED STATE) s
377 299 M
(    ESTABLISHED STATE) s
377 291 M
(    FIN-WAIT-1 STATE) s
377 283 M
(    FIN-WAIT-2 STATE) s
377 275 M
(    CLOSE-WAIT STATE) s
377 267 M
( ) s
377 259 M
(      Send a reset segment:) s
377 251 M
( ) s
377 243 M
(        <SEQ=SND.NXT><CTL=RST>) s
377 235 M
( ) s
377 227 M
(      All queued SENDs and RECEIVEs should be given "connection reset") s
377 219 M
(      notification; all segments queued for transmission \(except for the) s
377 211 M
(      RST formed above\) or retransmission should be flushed, delete the) s
377 203 M
(      TCB, enter CLOSED state, and return.) s
377 195 M
( ) s
377 187 M
(    CLOSING STATE) s
377 179 M
(    LAST-ACK STATE) s
377 171 M
(    TIME-WAIT STATE) s
377 163 M
( ) s
377 155 M
(      Respond with "ok" and delete the TCB, enter CLOSED state, and) s
377 147 M
(      return.) s
377 139 M
( ) s
377 131 M
( ) s
377 123 M
( ) s
377 115 M
( ) s
377 107 M
( ) s
377 99 M
( ) s
377 91 M
( ) s
377 83 M
( ) s
377 75 M
([Page 62]                                                               ) s
_R
S
%%Page: (35) 35
%%BeginPageSetup
_S
90 rotate
24 -588 translate
/pagenum 35 def
/fname (rfc793.txt) def
/fdir () def
/ftail (rfc793.txt) def
% User defined strings:
/fmodstr (Thu Aug %2d 13:52:57 2000) def
%%EndPageSetup
do_header
5 531 M
( ) s
5 523 M
(September 1981                                                          ) s
5 515 M
(                                           Transmission Control Protocol) s
5 507 M
(                                                Functional Specification) s
5 499 M
(STATUS Call) s
5 491 M
( ) s
5 483 M
( ) s
5 475 M
( ) s
5 467 M
(  STATUS Call) s
5 459 M
( ) s
5 451 M
(    CLOSED STATE \(i.e., TCB does not exist\)) s
5 443 M
( ) s
5 435 M
(      If the user should not have access to such a connection, return) s
5 427 M
(      "error:  connection illegal for this process".) s
5 419 M
( ) s
5 411 M
(      Otherwise return "error:  connection does not exist".) s
5 403 M
( ) s
5 395 M
(    LISTEN STATE) s
5 387 M
( ) s
5 379 M
(      Return "state = LISTEN", and the TCB pointer.) s
5 371 M
( ) s
5 363 M
(    SYN-SENT STATE) s
5 355 M
( ) s
5 347 M
(      Return "state = SYN-SENT", and the TCB pointer.) s
5 339 M
( ) s
5 331 M
(    SYN-RECEIVED STATE) s
5 323 M
( ) s
5 315 M
(      Return "state = SYN-RECEIVED", and the TCB pointer.) s
5 307 M
( ) s
5 299 M
(    ESTABLISHED STATE) s
5 291 M
( ) s
5 283 M
(      Return "state = ESTABLISHED", and the TCB pointer.) s
5 275 M
( ) s
5 267 M
(    FIN-WAIT-1 STATE) s
5 259 M
( ) s
5 251 M
(      Return "state = FIN-WAIT-1", and the TCB pointer.) s
5 243 M
( ) s
5 235 M
(    FIN-WAIT-2 STATE) s
5 227 M
( ) s
5 219 M
(      Return "state = FIN-WAIT-2", and the TCB pointer.) s
5 211 M
( ) s
5 203 M
(    CLOSE-WAIT STATE) s
5 195 M
( ) s
5 187 M
(      Return "state = CLOSE-WAIT", and the TCB pointer.) s
5 179 M
( ) s
5 171 M
(    CLOSING STATE) s
5 163 M
( ) s
5 155 M
(      Return "state = CLOSING", and the TCB pointer.) s
5 147 M
( ) s
5 139 M
(    LAST-ACK STATE) s
5 131 M
( ) s
5 123 M
(      Return "state = LAST-ACK", and the TCB pointer.) s
5 115 M
( ) s
5 107 M
( ) s
5 99 M
( ) s
5 91 M
( ) s
5 83 M
( ) s
5 75 M
(                                                               [Page 63]) s
377 531 M
( ) s
377 523 M
(                                                          September 1981) s
377 515 M
(Transmission Control Protocol) s
377 507 M
(Functional Specification) s
377 499 M
(                                                             STATUS Call) s
377 491 M
( ) s
377 483 M
( ) s
377 475 M
( ) s
377 467 M
(    TIME-WAIT STATE) s
377 459 M
( ) s
377 451 M
(      Return "state = TIME-WAIT", and the TCB pointer.) s
377 443 M
( ) s
377 435 M
( ) s
377 427 M
( ) s
377 419 M
( ) s
377 411 M
( ) s
377 403 M
( ) s
377 395 M
( ) s
377 387 M
( ) s
377 379 M
( ) s
377 371 M
( ) s
377 363 M
( ) s
377 355 M
( ) s
377 347 M
( ) s
377 339 M
( ) s
377 331 M
( ) s
377 323 M
( ) s
377 315 M
( ) s
377 307 M
( ) s
377 299 M
( ) s
377 291 M
( ) s
377 283 M
( ) s
377 275 M
( ) s
377 267 M
( ) s
377 259 M
( ) s
377 251 M
( ) s
377 243 M
( ) s
377 235 M
( ) s
377 227 M
( ) s
377 219 M
( ) s
377 211 M
( ) s
377 203 M
( ) s
377 195 M
( ) s
377 187 M
( ) s
377 179 M
( ) s
377 171 M
( ) s
377 163 M
( ) s
377 155 M
( ) s
377 147 M
( ) s
377 139 M
( ) s
377 131 M
( ) s
377 123 M
( ) s
377 115 M
( ) s
377 107 M
( ) s
377 99 M
( ) s
377 91 M
( ) s
377 83 M
( ) s
377 75 M
([Page 64]                                                               ) s
_R
S
%%Page: (36) 36
%%BeginPageSetup
_S
90 rotate
24 -588 translate
/pagenum 36 def
/fname (rfc793.txt) def
/fdir () def
/ftail (rfc793.txt) def
% User defined strings:
/fmodstr (Thu Aug %2d 13:52:57 2000) def
%%EndPageSetup
do_header
5 531 M
( ) s
5 523 M
(September 1981                                                          ) s
5 515 M
(                                           Transmission Control Protocol) s
5 507 M
(                                                Functional Specification) s
5 499 M
(SEGMENT ARRIVES) s
5 491 M
( ) s
5 483 M
( ) s
5 475 M
( ) s
5 467 M
(  SEGMENT ARRIVES) s
5 459 M
( ) s
5 451 M
(    If the state is CLOSED \(i.e., TCB does not exist\) then) s
5 443 M
( ) s
5 435 M
(      all data in the incoming segment is discarded.  An incoming) s
5 427 M
(      segment containing a RST is discarded.  An incoming segment not) s
5 419 M
(      containing a RST causes a RST to be sent in response.  The) s
5 411 M
(      acknowledgment and sequence field values are selected to make the) s
5 403 M
(      reset sequence acceptable to the TCP that sent the offending) s
5 395 M
(      segment.) s
5 387 M
( ) s
5 379 M
(      If the ACK bit is off, sequence number zero is used,) s
5 371 M
( ) s
5 363 M
(        <SEQ=0><ACK=SEG.SEQ+SEG.LEN><CTL=RST,ACK>) s
5 355 M
( ) s
5 347 M
(      If the ACK bit is on,) s
5 339 M
( ) s
5 331 M
(        <SEQ=SEG.ACK><CTL=RST>) s
5 323 M
( ) s
5 315 M
(      Return.) s
5 307 M
( ) s
5 299 M
(    If the state is LISTEN then) s
5 291 M
( ) s
5 283 M
(      first check for an RST) s
5 275 M
( ) s
5 267 M
(        An incoming RST should be ignored.  Return.) s
5 259 M
( ) s
5 251 M
(      second check for an ACK) s
5 243 M
( ) s
5 235 M
(        Any acknowledgment is bad if it arrives on a connection still in) s
5 227 M
(        the LISTEN state.  An acceptable reset segment should be formed) s
5 219 M
(        for any arriving ACK-bearing segment.  The RST should be) s
5 211 M
(        formatted as follows:) s
5 203 M
( ) s
5 195 M
(          <SEQ=SEG.ACK><CTL=RST>) s
5 187 M
( ) s
5 179 M
(        Return.) s
5 171 M
( ) s
5 163 M
(      third check for a SYN) s
5 155 M
( ) s
5 147 M
(        If the SYN bit is set, check the security.  If the) s
5 139 M
(        security/compartment on the incoming segment does not exactly) s
5 131 M
(        match the security/compartment in the TCB then send a reset and) s
5 123 M
(        return.) s
5 115 M
( ) s
5 107 M
(          <SEQ=SEG.ACK><CTL=RST>) s
5 99 M
( ) s
5 91 M
( ) s
5 83 M
( ) s
5 75 M
(                                                               [Page 65]) s
377 531 M
( ) s
377 523 M
(                                                          September 1981) s
377 515 M
(Transmission Control Protocol) s
377 507 M
(Functional Specification) s
377 499 M
(                                                         SEGMENT ARRIVES) s
377 491 M
( ) s
377 483 M
( ) s
377 475 M
( ) s
377 467 M
(        If the SEG.PRC is greater than the TCB.PRC then if allowed by) s
377 459 M
(        the user and the system set TCB.PRC<-SEG.PRC, if not allowed) s
377 451 M
(        send a reset and return.) s
377 443 M
( ) s
377 435 M
(          <SEQ=SEG.ACK><CTL=RST>) s
377 427 M
( ) s
377 419 M
(        If the SEG.PRC is less than the TCB.PRC then continue.) s
377 411 M
( ) s
377 403 M
(        Set RCV.NXT to SEG.SEQ+1, IRS is set to SEG.SEQ and any other) s
377 395 M
(        control or text should be queued for processing later.  ISS) s
377 387 M
(        should be selected and a SYN segment sent of the form:) s
377 379 M
( ) s
377 371 M
(          <SEQ=ISS><ACK=RCV.NXT><CTL=SYN,ACK>) s
377 363 M
( ) s
377 355 M
(        SND.NXT is set to ISS+1 and SND.UNA to ISS.  The connection) s
377 347 M
(        state should be changed to SYN-RECEIVED.  Note that any other) s
377 339 M
(        incoming control or data \(combined with SYN\) will be processed) s
377 331 M
(        in the SYN-RECEIVED state, but processing of SYN and ACK should) s
377 323 M
(        not be repeated.  If the listen was not fully specified \(i.e.,) s
377 315 M
(        the foreign socket was not fully specified\), then the) s
377 307 M
(        unspecified fields should be filled in now.) s
377 299 M
( ) s
377 291 M
(      fourth other text or control) s
377 283 M
( ) s
377 275 M
(        Any other control or text-bearing segment \(not containing SYN\)) s
377 267 M
(        must have an ACK and thus would be discarded by the ACK) s
377 259 M
(        processing.  An incoming RST segment could not be valid, since) s
377 251 M
(        it could not have been sent in response to anything sent by this) s
377 243 M
(        incarnation of the connection.  So you are unlikely to get here,) s
377 235 M
(        but if you do, drop the segment, and return.) s
377 227 M
( ) s
377 219 M
(    If the state is SYN-SENT then) s
377 211 M
( ) s
377 203 M
(      first check the ACK bit) s
377 195 M
( ) s
377 187 M
(        If the ACK bit is set) s
377 179 M
( ) s
377 171 M
(          If SEG.ACK =< ISS, or SEG.ACK > SND.NXT, send a reset \(unless) s
377 163 M
(          the RST bit is set, if so drop the segment and return\)) s
377 155 M
( ) s
377 147 M
(            <SEQ=SEG.ACK><CTL=RST>) s
377 139 M
( ) s
377 131 M
(          and discard the segment.  Return.) s
377 123 M
( ) s
377 115 M
(          If SND.UNA =< SEG.ACK =< SND.NXT then the ACK is acceptable.) s
377 107 M
( ) s
377 99 M
(      second check the RST bit) s
377 91 M
( ) s
377 83 M
( ) s
377 75 M
([Page 66]                                                               ) s
_R
S
%%Page: (37) 37
%%BeginPageSetup
_S
90 rotate
24 -588 translate
/pagenum 37 def
/fname (rfc793.txt) def
/fdir () def
/ftail (rfc793.txt) def
% User defined strings:
/fmodstr (Thu Aug %2d 13:52:57 2000) def
%%EndPageSetup
do_header
5 531 M
( ) s
5 523 M
(September 1981                                                          ) s
5 515 M
(                                           Transmission Control Protocol) s
5 507 M
(                                                Functional Specification) s
5 499 M
(SEGMENT ARRIVES) s
5 491 M
( ) s
5 483 M
( ) s
5 475 M
( ) s
5 467 M
(        If the RST bit is set) s
5 459 M
( ) s
5 451 M
(          If the ACK was acceptable then signal the user "error:) s
5 443 M
(          connection reset", drop the segment, enter CLOSED state,) s
5 435 M
(          delete TCB, and return.  Otherwise \(no ACK\) drop the segment) s
5 427 M
(          and return.) s
5 419 M
( ) s
5 411 M
(      third check the security and precedence) s
5 403 M
( ) s
5 395 M
(        If the security/compartment in the segment does not exactly) s
5 387 M
(        match the security/compartment in the TCB, send a reset) s
5 379 M
( ) s
5 371 M
(          If there is an ACK) s
5 363 M
( ) s
5 355 M
(            <SEQ=SEG.ACK><CTL=RST>) s
5 347 M
( ) s
5 339 M
(          Otherwise) s
5 331 M
( ) s
5 323 M
(            <SEQ=0><ACK=SEG.SEQ+SEG.LEN><CTL=RST,ACK>) s
5 315 M
( ) s
5 307 M
(        If there is an ACK) s
5 299 M
( ) s
5 291 M
(          The precedence in the segment must match the precedence in the) s
5 283 M
(          TCB, if not, send a reset) s
5 275 M
( ) s
5 267 M
(            <SEQ=SEG.ACK><CTL=RST>) s
5 259 M
( ) s
5 251 M
(        If there is no ACK) s
5 243 M
( ) s
5 235 M
(          If the precedence in the segment is higher than the precedence) s
5 227 M
(          in the TCB then if allowed by the user and the system raise) s
5 219 M
(          the precedence in the TCB to that in the segment, if not) s
5 211 M
(          allowed to raise the prec then send a reset.) s
5 203 M
( ) s
5 195 M
(            <SEQ=0><ACK=SEG.SEQ+SEG.LEN><CTL=RST,ACK>) s
5 187 M
( ) s
5 179 M
(          If the precedence in the segment is lower than the precedence) s
5 171 M
(          in the TCB continue.) s
5 163 M
( ) s
5 155 M
(        If a reset was sent, discard the segment and return.) s
5 147 M
( ) s
5 139 M
(      fourth check the SYN bit) s
5 131 M
( ) s
5 123 M
(        This step should be reached only if the ACK is ok, or there is) s
5 115 M
(        no ACK, and it the segment did not contain a RST.) s
5 107 M
( ) s
5 99 M
(        If the SYN bit is on and the security/compartment and precedence) s
5 91 M
( ) s
5 83 M
( ) s
5 75 M
(                                                               [Page 67]) s
377 531 M
( ) s
377 523 M
(                                                          September 1981) s
377 515 M
(Transmission Control Protocol) s
377 507 M
(Functional Specification) s
377 499 M
(                                                         SEGMENT ARRIVES) s
377 491 M
( ) s
377 483 M
( ) s
377 475 M
( ) s
377 467 M
(        are acceptable then, RCV.NXT is set to SEG.SEQ+1, IRS is set to) s
377 459 M
(        SEG.SEQ.  SND.UNA should be advanced to equal SEG.ACK \(if there) s
377 451 M
(        is an ACK\), and any segments on the retransmission queue which) s
377 443 M
(        are thereby acknowledged should be removed.) s
377 435 M
( ) s
377 427 M
(        If SND.UNA > ISS \(our SYN has been ACKed\), change the connection) s
377 419 M
(        state to ESTABLISHED, form an ACK segment) s
377 411 M
( ) s
377 403 M
(          <SEQ=SND.NXT><ACK=RCV.NXT><CTL=ACK>) s
377 395 M
( ) s
377 387 M
(        and send it.  Data or controls which were queued for) s
377 379 M
(        transmission may be included.  If there are other controls or) s
377 371 M
(        text in the segment then continue processing at the sixth step) s
377 363 M
(        below where the URG bit is checked, otherwise return.) s
377 355 M
( ) s
377 347 M
(        Otherwise enter SYN-RECEIVED, form a SYN,ACK segment) s
377 339 M
( ) s
377 331 M
(          <SEQ=ISS><ACK=RCV.NXT><CTL=SYN,ACK>) s
377 323 M
( ) s
377 315 M
(        and send it.  If there are other controls or text in the) s
377 307 M
(        segment, queue them for processing after the ESTABLISHED state) s
377 299 M
(        has been reached, return.) s
377 291 M
( ) s
377 283 M
(      fifth, if neither of the SYN or RST bits is set then drop the) s
377 275 M
(      segment and return.) s
377 267 M
( ) s
377 259 M
( ) s
377 251 M
( ) s
377 243 M
( ) s
377 235 M
( ) s
377 227 M
( ) s
377 219 M
( ) s
377 211 M
( ) s
377 203 M
( ) s
377 195 M
( ) s
377 187 M
( ) s
377 179 M
( ) s
377 171 M
( ) s
377 163 M
( ) s
377 155 M
( ) s
377 147 M
( ) s
377 139 M
( ) s
377 131 M
( ) s
377 123 M
( ) s
377 115 M
( ) s
377 107 M
( ) s
377 99 M
( ) s
377 91 M
( ) s
377 83 M
( ) s
377 75 M
([Page 68]                                                               ) s
_R
S
%%Page: (38) 38
%%BeginPageSetup
_S
90 rotate
24 -588 translate
/pagenum 38 def
/fname (rfc793.txt) def
/fdir () def
/ftail (rfc793.txt) def
% User defined strings:
/fmodstr (Thu Aug %2d 13:52:57 2000) def
%%EndPageSetup
do_header
5 531 M
( ) s
5 523 M
(September 1981                                                          ) s
5 515 M
(                                           Transmission Control Protocol) s
5 507 M
(                                                Functional Specification) s
5 499 M
(SEGMENT ARRIVES) s
5 491 M
( ) s
5 483 M
( ) s
5 475 M
( ) s
5 467 M
(    Otherwise,) s
5 459 M
( ) s
5 451 M
(    first check sequence number) s
5 443 M
( ) s
5 435 M
(      SYN-RECEIVED STATE) s
5 427 M
(      ESTABLISHED STATE) s
5 419 M
(      FIN-WAIT-1 STATE) s
5 411 M
(      FIN-WAIT-2 STATE) s
5 403 M
(      CLOSE-WAIT STATE) s
5 395 M
(      CLOSING STATE) s
5 387 M
(      LAST-ACK STATE) s
5 379 M
(      TIME-WAIT STATE) s
5 371 M
( ) s
5 363 M
(        Segments are processed in sequence.  Initial tests on arrival) s
5 355 M
(        are used to discard old duplicates, but further processing is) s
5 347 M
(        done in SEG.SEQ order.  If a segment's contents straddle the) s
5 339 M
(        boundary between old and new, only the new parts should be) s
5 331 M
(        processed.) s
5 323 M
( ) s
5 315 M
(        There are four cases for the acceptability test for an incoming) s
5 307 M
(        segment:) s
5 299 M
( ) s
5 291 M
(        Segment Receive  Test) s
5 283 M
(        Length  Window) s
5 275 M
(        ------- -------  -------------------------------------------) s
5 267 M
( ) s
5 259 M
(           0       0     SEG.SEQ = RCV.NXT) s
5 251 M
( ) s
5 243 M
(           0      >0     RCV.NXT =< SEG.SEQ < RCV.NXT+RCV.WND) s
5 235 M
( ) s
5 227 M
(          >0       0     not acceptable) s
5 219 M
( ) s
5 211 M
(          >0      >0     RCV.NXT =< SEG.SEQ < RCV.NXT+RCV.WND) s
5 203 M
(                      or RCV.NXT =< SEG.SEQ+SEG.LEN-1 < RCV.NXT+RCV.WND) s
5 195 M
( ) s
5 187 M
(        If the RCV.WND is zero, no segments will be acceptable, but) s
5 179 M
(        special allowance should be made to accept valid ACKs, URGs and) s
5 171 M
(        RSTs.) s
5 163 M
( ) s
5 155 M
(        If an incoming segment is not acceptable, an acknowledgment) s
5 147 M
(        should be sent in reply \(unless the RST bit is set, if so drop) s
5 139 M
(        the segment and return\):) s
5 131 M
( ) s
5 123 M
(          <SEQ=SND.NXT><ACK=RCV.NXT><CTL=ACK>) s
5 115 M
( ) s
5 107 M
(        After sending the acknowledgment, drop the unacceptable segment) s
5 99 M
(        and return.) s
5 91 M
( ) s
5 83 M
( ) s
5 75 M
(                                                               [Page 69]) s
377 531 M
( ) s
377 523 M
(                                                          September 1981) s
377 515 M
(Transmission Control Protocol) s
377 507 M
(Functional Specification) s
377 499 M
(                                                         SEGMENT ARRIVES) s
377 491 M
( ) s
377 483 M
( ) s
377 475 M
( ) s
377 467 M
(        In the following it is assumed that the segment is the idealized) s
377 459 M
(        segment that begins at RCV.NXT and does not exceed the window.) s
377 451 M
(        One could tailor actual segments to fit this assumption by) s
377 443 M
(        trimming off any portions that lie outside the window \(including) s
377 435 M
(        SYN and FIN\), and only processing further if the segment then) s
377 427 M
(        begins at RCV.NXT.  Segments with higher begining sequence) s
377 419 M
(        numbers may be held for later processing.) s
377 411 M
( ) s
377 403 M
(    second check the RST bit,) s
377 395 M
( ) s
377 387 M
(      SYN-RECEIVED STATE) s
377 379 M
( ) s
377 371 M
(        If the RST bit is set) s
377 363 M
( ) s
377 355 M
(          If this connection was initiated with a passive OPEN \(i.e.,) s
377 347 M
(          came from the LISTEN state\), then return this connection to) s
377 339 M
(          LISTEN state and return.  The user need not be informed.  If) s
377 331 M
(          this connection was initiated with an active OPEN \(i.e., came) s
377 323 M
(          from SYN-SENT state\) then the connection was refused, signal) s
377 315 M
(          the user "connection refused".  In either case, all segments) s
377 307 M
(          on the retransmission queue should be removed.  And in the) s
377 299 M
(          active OPEN case, enter the CLOSED state and delete the TCB,) s
377 291 M
(          and return.) s
377 283 M
( ) s
377 275 M
(      ESTABLISHED) s
377 267 M
(      FIN-WAIT-1) s
377 259 M
(      FIN-WAIT-2) s
377 251 M
(      CLOSE-WAIT) s
377 243 M
( ) s
377 235 M
(        If the RST bit is set then, any outstanding RECEIVEs and SEND) s
377 227 M
(        should receive "reset" responses.  All segment queues should be) s
377 219 M
(        flushed.  Users should also receive an unsolicited general) s
377 211 M
(        "connection reset" signal.  Enter the CLOSED state, delete the) s
377 203 M
(        TCB, and return.) s
377 195 M
( ) s
377 187 M
(      CLOSING STATE) s
377 179 M
(      LAST-ACK STATE) s
377 171 M
(      TIME-WAIT) s
377 163 M
( ) s
377 155 M
(        If the RST bit is set then, enter the CLOSED state, delete the) s
377 147 M
(        TCB, and return.) s
377 139 M
( ) s
377 131 M
( ) s
377 123 M
( ) s
377 115 M
( ) s
377 107 M
( ) s
377 99 M
( ) s
377 91 M
( ) s
377 83 M
( ) s
377 75 M
([Page 70]                                                               ) s
_R
S
%%Page: (39) 39
%%BeginPageSetup
_S
90 rotate
24 -588 translate
/pagenum 39 def
/fname (rfc793.txt) def
/fdir () def
/ftail (rfc793.txt) def
% User defined strings:
/fmodstr (Thu Aug %2d 13:52:57 2000) def
%%EndPageSetup
do_header
5 531 M
( ) s
5 523 M
(September 1981                                                          ) s
5 515 M
(                                           Transmission Control Protocol) s
5 507 M
(                                                Functional Specification) s
5 499 M
(SEGMENT ARRIVES) s
5 491 M
( ) s
5 483 M
( ) s
5 475 M
( ) s
5 467 M
(    third check security and precedence) s
5 459 M
( ) s
5 451 M
(      SYN-RECEIVED) s
5 443 M
( ) s
5 435 M
(        If the security/compartment and precedence in the segment do not) s
5 427 M
(        exactly match the security/compartment and precedence in the TCB) s
5 419 M
(        then send a reset, and return.) s
5 411 M
( ) s
5 403 M
(      ESTABLISHED STATE) s
5 395 M
( ) s
5 387 M
(        If the security/compartment and precedence in the segment do not) s
5 379 M
(        exactly match the security/compartment and precedence in the TCB) s
5 371 M
(        then send a reset, any outstanding RECEIVEs and SEND should) s
5 363 M
(        receive "reset" responses.  All segment queues should be) s
5 355 M
(        flushed.  Users should also receive an unsolicited general) s
5 347 M
(        "connection reset" signal.  Enter the CLOSED state, delete the) s
5 339 M
(        TCB, and return.) s
5 331 M
( ) s
5 323 M
(      Note this check is placed following the sequence check to prevent) s
5 315 M
(      a segment from an old connection between these ports with a) s
5 307 M
(      different security or precedence from causing an abort of the) s
5 299 M
(      current connection.) s
5 291 M
( ) s
5 283 M
(    fourth, check the SYN bit,) s
5 275 M
( ) s
5 267 M
(      SYN-RECEIVED) s
5 259 M
(      ESTABLISHED STATE) s
5 251 M
(      FIN-WAIT STATE-1) s
5 243 M
(      FIN-WAIT STATE-2) s
5 235 M
(      CLOSE-WAIT STATE) s
5 227 M
(      CLOSING STATE) s
5 219 M
(      LAST-ACK STATE) s
5 211 M
(      TIME-WAIT STATE) s
5 203 M
( ) s
5 195 M
(        If the SYN is in the window it is an error, send a reset, any) s
5 187 M
(        outstanding RECEIVEs and SEND should receive "reset" responses,) s
5 179 M
(        all segment queues should be flushed, the user should also) s
5 171 M
(        receive an unsolicited general "connection reset" signal, enter) s
5 163 M
(        the CLOSED state, delete the TCB, and return.) s
5 155 M
( ) s
5 147 M
(        If the SYN is not in the window this step would not be reached) s
5 139 M
(        and an ack would have been sent in the first step \(sequence) s
5 131 M
(        number check\).) s
5 123 M
( ) s
5 115 M
( ) s
5 107 M
( ) s
5 99 M
( ) s
5 91 M
( ) s
5 83 M
( ) s
5 75 M
(                                                               [Page 71]) s
377 531 M
( ) s
377 523 M
(                                                          September 1981) s
377 515 M
(Transmission Control Protocol) s
377 507 M
(Functional Specification) s
377 499 M
(                                                         SEGMENT ARRIVES) s
377 491 M
( ) s
377 483 M
( ) s
377 475 M
( ) s
377 467 M
(    fifth check the ACK field,) s
377 459 M
( ) s
377 451 M
(      if the ACK bit is off drop the segment and return) s
377 443 M
( ) s
377 435 M
(      if the ACK bit is on) s
377 427 M
( ) s
377 419 M
(        SYN-RECEIVED STATE) s
377 411 M
( ) s
377 403 M
(          If SND.UNA =< SEG.ACK =< SND.NXT then enter ESTABLISHED state) s
377 395 M
(          and continue processing.) s
377 387 M
( ) s
377 379 M
(            If the segment acknowledgment is not acceptable, form a) s
377 371 M
(            reset segment,) s
377 363 M
( ) s
377 355 M
(              <SEQ=SEG.ACK><CTL=RST>) s
377 347 M
( ) s
377 339 M
(            and send it.) s
377 331 M
( ) s
377 323 M
(        ESTABLISHED STATE) s
377 315 M
( ) s
377 307 M
(          If SND.UNA < SEG.ACK =< SND.NXT then, set SND.UNA <- SEG.ACK.) s
377 299 M
(          Any segments on the retransmission queue which are thereby) s
377 291 M
(          entirely acknowledged are removed.  Users should receive) s
377 283 M
(          positive acknowledgments for buffers which have been SENT and) s
377 275 M
(          fully acknowledged \(i.e., SEND buffer should be returned with) s
377 267 M
(          "ok" response\).  If the ACK is a duplicate) s
377 259 M
(          \(SEG.ACK < SND.UNA\), it can be ignored.  If the ACK acks) s
377 251 M
(          something not yet sent \(SEG.ACK > SND.NXT\) then send an ACK,) s
377 243 M
(          drop the segment, and return.) s
377 235 M
( ) s
377 227 M
(          If SND.UNA < SEG.ACK =< SND.NXT, the send window should be) s
377 219 M
(          updated.  If \(SND.WL1 < SEG.SEQ or \(SND.WL1 = SEG.SEQ and) s
377 211 M
(          SND.WL2 =< SEG.ACK\)\), set SND.WND <- SEG.WND, set) s
377 203 M
(          SND.WL1 <- SEG.SEQ, and set SND.WL2 <- SEG.ACK.) s
377 195 M
( ) s
377 187 M
(          Note that SND.WND is an offset from SND.UNA, that SND.WL1) s
377 179 M
(          records the sequence number of the last segment used to update) s
377 171 M
(          SND.WND, and that SND.WL2 records the acknowledgment number of) s
377 163 M
(          the last segment used to update SND.WND.  The check here) s
377 155 M
(          prevents using old segments to update the window.) s
377 147 M
( ) s
377 139 M
( ) s
377 131 M
( ) s
377 123 M
( ) s
377 115 M
( ) s
377 107 M
( ) s
377 99 M
( ) s
377 91 M
( ) s
377 83 M
( ) s
377 75 M
([Page 72]                                                               ) s
_R
S
%%Page: (40) 40
%%BeginPageSetup
_S
90 rotate
24 -588 translate
/pagenum 40 def
/fname (rfc793.txt) def
/fdir () def
/ftail (rfc793.txt) def
% User defined strings:
/fmodstr (Thu Aug %2d 13:52:57 2000) def
%%EndPageSetup
do_header
5 531 M
( ) s
5 523 M
(September 1981                                                          ) s
5 515 M
(                                           Transmission Control Protocol) s
5 507 M
(                                                Functional Specification) s
5 499 M
(SEGMENT ARRIVES) s
5 491 M
( ) s
5 483 M
( ) s
5 475 M
( ) s
5 467 M
(        FIN-WAIT-1 STATE) s
5 459 M
( ) s
5 451 M
(          In addition to the processing for the ESTABLISHED state, if) s
5 443 M
(          our FIN is now acknowledged then enter FIN-WAIT-2 and continue) s
5 435 M
(          processing in that state.) s
5 427 M
( ) s
5 419 M
(        FIN-WAIT-2 STATE) s
5 411 M
( ) s
5 403 M
(          In addition to the processing for the ESTABLISHED state, if) s
5 395 M
(          the retransmission queue is empty, the user's CLOSE can be) s
5 387 M
(          acknowledged \("ok"\) but do not delete the TCB.) s
5 379 M
( ) s
5 371 M
(        CLOSE-WAIT STATE) s
5 363 M
( ) s
5 355 M
(          Do the same processing as for the ESTABLISHED state.) s
5 347 M
( ) s
5 339 M
(        CLOSING STATE) s
5 331 M
( ) s
5 323 M
(          In addition to the processing for the ESTABLISHED state, if) s
5 315 M
(          the ACK acknowledges our FIN then enter the TIME-WAIT state,) s
5 307 M
(          otherwise ignore the segment.) s
5 299 M
( ) s
5 291 M
(        LAST-ACK STATE) s
5 283 M
( ) s
5 275 M
(          The only thing that can arrive in this state is an) s
5 267 M
(          acknowledgment of our FIN.  If our FIN is now acknowledged,) s
5 259 M
(          delete the TCB, enter the CLOSED state, and return.) s
5 251 M
( ) s
5 243 M
(        TIME-WAIT STATE) s
5 235 M
( ) s
5 227 M
(          The only thing that can arrive in this state is a) s
5 219 M
(          retransmission of the remote FIN.  Acknowledge it, and restart) s
5 211 M
(          the 2 MSL timeout.) s
5 203 M
( ) s
5 195 M
(    sixth, check the URG bit,) s
5 187 M
( ) s
5 179 M
(      ESTABLISHED STATE) s
5 171 M
(      FIN-WAIT-1 STATE) s
5 163 M
(      FIN-WAIT-2 STATE) s
5 155 M
( ) s
5 147 M
(        If the URG bit is set, RCV.UP <- max\(RCV.UP,SEG.UP\), and signal) s
5 139 M
(        the user that the remote side has urgent data if the urgent) s
5 131 M
(        pointer \(RCV.UP\) is in advance of the data consumed.  If the) s
5 123 M
(        user has already been signaled \(or is still in the "urgent) s
5 115 M
(        mode"\) for this continuous sequence of urgent data, do not) s
5 107 M
(        signal the user again.) s
5 99 M
( ) s
5 91 M
( ) s
5 83 M
( ) s
5 75 M
(                                                               [Page 73]) s
377 531 M
( ) s
377 523 M
(                                                          September 1981) s
377 515 M
(Transmission Control Protocol) s
377 507 M
(Functional Specification) s
377 499 M
(                                                         SEGMENT ARRIVES) s
377 491 M
( ) s
377 483 M
( ) s
377 475 M
( ) s
377 467 M
(      CLOSE-WAIT STATE) s
377 459 M
(      CLOSING STATE) s
377 451 M
(      LAST-ACK STATE) s
377 443 M
(      TIME-WAIT) s
377 435 M
( ) s
377 427 M
(        This should not occur, since a FIN has been received from the) s
377 419 M
(        remote side.  Ignore the URG.) s
377 411 M
( ) s
377 403 M
(    seventh, process the segment text,) s
377 395 M
( ) s
377 387 M
(      ESTABLISHED STATE) s
377 379 M
(      FIN-WAIT-1 STATE) s
377 371 M
(      FIN-WAIT-2 STATE) s
377 363 M
( ) s
377 355 M
(        Once in the ESTABLISHED state, it is possible to deliver segment) s
377 347 M
(        text to user RECEIVE buffers.  Text from segments can be moved) s
377 339 M
(        into buffers until either the buffer is full or the segment is) s
377 331 M
(        empty.  If the segment empties and carries an PUSH flag, then) s
377 323 M
(        the user is informed, when the buffer is returned, that a PUSH) s
377 315 M
(        has been received.) s
377 307 M
( ) s
377 299 M
(        When the TCP takes responsibility for delivering the data to the) s
377 291 M
(        user it must also acknowledge the receipt of the data.) s
377 283 M
( ) s
377 275 M
(        Once the TCP takes responsibility for the data it advances) s
377 267 M
(        RCV.NXT over the data accepted, and adjusts RCV.WND as) s
377 259 M
(        apporopriate to the current buffer availability.  The total of) s
377 251 M
(        RCV.NXT and RCV.WND should not be reduced.) s
377 243 M
( ) s
377 235 M
(        Please note the window management suggestions in section 3.7.) s
377 227 M
( ) s
377 219 M
(        Send an acknowledgment of the form:) s
377 211 M
( ) s
377 203 M
(          <SEQ=SND.NXT><ACK=RCV.NXT><CTL=ACK>) s
377 195 M
( ) s
377 187 M
(        This acknowledgment should be piggybacked on a segment being) s
377 179 M
(        transmitted if possible without incurring undue delay.) s
377 171 M
( ) s
377 163 M
( ) s
377 155 M
( ) s
377 147 M
( ) s
377 139 M
( ) s
377 131 M
( ) s
377 123 M
( ) s
377 115 M
( ) s
377 107 M
( ) s
377 99 M
( ) s
377 91 M
( ) s
377 83 M
( ) s
377 75 M
([Page 74]                                                               ) s
_R
S
%%Page: (41) 41
%%BeginPageSetup
_S
90 rotate
24 -588 translate
/pagenum 41 def
/fname (rfc793.txt) def
/fdir () def
/ftail (rfc793.txt) def
% User defined strings:
/fmodstr (Thu Aug %2d 13:52:57 2000) def
%%EndPageSetup
do_header
5 531 M
( ) s
5 523 M
(September 1981                                                          ) s
5 515 M
(                                           Transmission Control Protocol) s
5 507 M
(                                                Functional Specification) s
5 499 M
(SEGMENT ARRIVES) s
5 491 M
( ) s
5 483 M
( ) s
5 475 M
( ) s
5 467 M
(      CLOSE-WAIT STATE) s
5 459 M
(      CLOSING STATE) s
5 451 M
(      LAST-ACK STATE) s
5 443 M
(      TIME-WAIT STATE) s
5 435 M
( ) s
5 427 M
(        This should not occur, since a FIN has been received from the) s
5 419 M
(        remote side.  Ignore the segment text.) s
5 411 M
( ) s
5 403 M
(    eighth, check the FIN bit,) s
5 395 M
( ) s
5 387 M
(      Do not process the FIN if the state is CLOSED, LISTEN or SYN-SENT) s
5 379 M
(      since the SEG.SEQ cannot be validated; drop the segment and) s
5 371 M
(      return.) s
5 363 M
( ) s
5 355 M
(      If the FIN bit is set, signal the user "connection closing" and) s
5 347 M
(      return any pending RECEIVEs with same message, advance RCV.NXT) s
5 339 M
(      over the FIN, and send an acknowledgment for the FIN.  Note that) s
5 331 M
(      FIN implies PUSH for any segment text not yet delivered to the) s
5 323 M
(      user.) s
5 315 M
( ) s
5 307 M
(        SYN-RECEIVED STATE) s
5 299 M
(        ESTABLISHED STATE) s
5 291 M
( ) s
5 283 M
(          Enter the CLOSE-WAIT state.) s
5 275 M
( ) s
5 267 M
(        FIN-WAIT-1 STATE) s
5 259 M
( ) s
5 251 M
(          If our FIN has been ACKed \(perhaps in this segment\), then) s
5 243 M
(          enter TIME-WAIT, start the time-wait timer, turn off the other) s
5 235 M
(          timers; otherwise enter the CLOSING state.) s
5 227 M
( ) s
5 219 M
(        FIN-WAIT-2 STATE) s
5 211 M
( ) s
5 203 M
(          Enter the TIME-WAIT state.  Start the time-wait timer, turn) s
5 195 M
(          off the other timers.) s
5 187 M
( ) s
5 179 M
(        CLOSE-WAIT STATE) s
5 171 M
( ) s
5 163 M
(          Remain in the CLOSE-WAIT state.) s
5 155 M
( ) s
5 147 M
(        CLOSING STATE) s
5 139 M
( ) s
5 131 M
(          Remain in the CLOSING state.) s
5 123 M
( ) s
5 115 M
(        LAST-ACK STATE) s
5 107 M
( ) s
5 99 M
(          Remain in the LAST-ACK state.) s
5 91 M
( ) s
5 83 M
( ) s
5 75 M
(                                                               [Page 75]) s
377 531 M
( ) s
377 523 M
(                                                          September 1981) s
377 515 M
(Transmission Control Protocol) s
377 507 M
(Functional Specification) s
377 499 M
(                                                         SEGMENT ARRIVES) s
377 491 M
( ) s
377 483 M
( ) s
377 475 M
( ) s
377 467 M
(        TIME-WAIT STATE) s
377 459 M
( ) s
377 451 M
(          Remain in the TIME-WAIT state.  Restart the 2 MSL time-wait) s
377 443 M
(          timeout.) s
377 435 M
( ) s
377 427 M
(    and return.) s
377 419 M
( ) s
377 411 M
( ) s
377 403 M
( ) s
377 395 M
( ) s
377 387 M
( ) s
377 379 M
( ) s
377 371 M
( ) s
377 363 M
( ) s
377 355 M
( ) s
377 347 M
( ) s
377 339 M
( ) s
377 331 M
( ) s
377 323 M
( ) s
377 315 M
( ) s
377 307 M
( ) s
377 299 M
( ) s
377 291 M
( ) s
377 283 M
( ) s
377 275 M
( ) s
377 267 M
( ) s
377 259 M
( ) s
377 251 M
( ) s
377 243 M
( ) s
377 235 M
( ) s
377 227 M
( ) s
377 219 M
( ) s
377 211 M
( ) s
377 203 M
( ) s
377 195 M
( ) s
377 187 M
( ) s
377 179 M
( ) s
377 171 M
( ) s
377 163 M
( ) s
377 155 M
( ) s
377 147 M
( ) s
377 139 M
( ) s
377 131 M
( ) s
377 123 M
( ) s
377 115 M
( ) s
377 107 M
( ) s
377 99 M
( ) s
377 91 M
( ) s
377 83 M
( ) s
377 75 M
([Page 76]                                                               ) s
_R
S
%%Page: (42) 42
%%BeginPageSetup
_S
90 rotate
24 -588 translate
/pagenum 42 def
/fname (rfc793.txt) def
/fdir () def
/ftail (rfc793.txt) def
% User defined strings:
/fmodstr (Thu Aug %2d 13:52:57 2000) def
%%EndPageSetup
do_header
5 531 M
( ) s
5 523 M
(September 1981                                                          ) s
5 515 M
(                                           Transmission Control Protocol) s
5 507 M
(                                                Functional Specification) s
5 499 M
(USER TIMEOUT) s
5 491 M
( ) s
5 483 M
( ) s
5 475 M
( ) s
5 467 M
(  USER TIMEOUT) s
5 459 M
( ) s
5 451 M
(    For any state if the user timeout expires, flush all queues, signal) s
5 443 M
(    the user "error:  connection aborted due to user timeout" in general) s
5 435 M
(    and for any outstanding calls, delete the TCB, enter the CLOSED) s
5 427 M
(    state and return.) s
5 419 M
( ) s
5 411 M
(  RETRANSMISSION TIMEOUT) s
5 403 M
( ) s
5 395 M
(    For any state if the retransmission timeout expires on a segment in) s
5 387 M
(    the retransmission queue, send the segment at the front of the) s
5 379 M
(    retransmission queue again, reinitialize the retransmission timer,) s
5 371 M
(    and return.) s
5 363 M
( ) s
5 355 M
(  TIME-WAIT TIMEOUT) s
5 347 M
( ) s
5 339 M
(    If the time-wait timeout expires on a connection delete the TCB,) s
5 331 M
(    enter the CLOSED state and return.) s
5 323 M
( ) s
5 315 M
(   ) s
5 307 M
( ) s
5 299 M
( ) s
5 291 M
( ) s
5 283 M
( ) s
5 275 M
( ) s
5 267 M
( ) s
5 259 M
( ) s
5 251 M
( ) s
5 243 M
( ) s
5 235 M
( ) s
5 227 M
( ) s
5 219 M
( ) s
5 211 M
( ) s
5 203 M
( ) s
5 195 M
( ) s
5 187 M
( ) s
5 179 M
( ) s
5 171 M
( ) s
5 163 M
( ) s
5 155 M
( ) s
5 147 M
( ) s
5 139 M
( ) s
5 131 M
( ) s
5 123 M
( ) s
5 115 M
( ) s
5 107 M
( ) s
5 99 M
( ) s
5 91 M
( ) s
5 83 M
( ) s
5 75 M
(                                                               [Page 77]) s
377 531 M
( ) s
377 523 M
(                                                          September 1981) s
377 515 M
(Transmission Control Protocol) s
377 507 M
( ) s
377 499 M
( ) s
377 491 M
( ) s
377 483 M
( ) s
377 475 M
( ) s
377 467 M
( ) s
377 459 M
( ) s
377 451 M
( ) s
377 443 M
( ) s
377 435 M
( ) s
377 427 M
( ) s
377 419 M
( ) s
377 411 M
( ) s
377 403 M
( ) s
377 395 M
( ) s
377 387 M
( ) s
377 379 M
( ) s
377 371 M
( ) s
377 363 M
( ) s
377 355 M
( ) s
377 347 M
( ) s
377 339 M
( ) s
377 331 M
( ) s
377 323 M
( ) s
377 315 M
( ) s
377 307 M
( ) s
377 299 M
( ) s
377 291 M
( ) s
377 283 M
( ) s
377 275 M
( ) s
377 267 M
( ) s
377 259 M
( ) s
377 251 M
( ) s
377 243 M
( ) s
377 235 M
( ) s
377 227 M
( ) s
377 219 M
( ) s
377 211 M
( ) s
377 203 M
( ) s
377 195 M
( ) s
377 187 M
( ) s
377 179 M
( ) s
377 171 M
( ) s
377 163 M
( ) s
377 155 M
( ) s
377 147 M
( ) s
377 139 M
( ) s
377 131 M
( ) s
377 123 M
( ) s
377 115 M
( ) s
377 107 M
( ) s
377 99 M
( ) s
377 91 M
( ) s
377 83 M
( ) s
377 75 M
([Page 78]                                                               ) s
_R
S
%%Page: (43) 43
%%BeginPageSetup
_S
90 rotate
24 -588 translate
/pagenum 43 def
/fname (rfc793.txt) def
/fdir () def
/ftail (rfc793.txt) def
% User defined strings:
/fmodstr (Thu Aug %2d 13:52:57 2000) def
%%EndPageSetup
do_header
5 531 M
( ) s
5 523 M
(September 1981                                                          ) s
5 515 M
(                                           Transmission Control Protocol) s
5 507 M
( ) s
5 499 M
( ) s
5 491 M
( ) s
5 483 M
(                                GLOSSARY) s
5 475 M
( ) s
5 467 M
( ) s
5 459 M
( ) s
5 451 M
(1822) s
5 443 M
(          BBN Report 1822, "The Specification of the Interconnection of) s
5 435 M
(          a Host and an IMP".  The specification of interface between a) s
5 427 M
(          host and the ARPANET.) s
5 419 M
( ) s
5 411 M
(ACK) s
5 403 M
(          A control bit \(acknowledge\) occupying no sequence space, which) s
5 395 M
(          indicates that the acknowledgment field of this segment) s
5 387 M
(          specifies the next sequence number the sender of this segment) s
5 379 M
(          is expecting to receive, hence acknowledging receipt of all) s
5 371 M
(          previous sequence numbers.) s
5 363 M
( ) s
5 355 M
(ARPANET message) s
5 347 M
(          The unit of transmission between a host and an IMP in the) s
5 339 M
(          ARPANET.  The maximum size is about 1012 octets \(8096 bits\).) s
5 331 M
( ) s
5 323 M
(ARPANET packet) s
5 315 M
(          A unit of transmission used internally in the ARPANET between) s
5 307 M
(          IMPs.  The maximum size is about 126 octets \(1008 bits\).) s
5 299 M
( ) s
5 291 M
(connection) s
5 283 M
(          A logical communication path identified by a pair of sockets.) s
5 275 M
( ) s
5 267 M
(datagram) s
5 259 M
(          A message sent in a packet switched computer communications) s
5 251 M
(          network.) s
5 243 M
( ) s
5 235 M
(Destination Address) s
5 227 M
(          The destination address, usually the network and host) s
5 219 M
(          identifiers.) s
5 211 M
( ) s
5 203 M
(FIN) s
5 195 M
(          A control bit \(finis\) occupying one sequence number, which) s
5 187 M
(          indicates that the sender will send no more data or control) s
5 179 M
(          occupying sequence space.) s
5 171 M
( ) s
5 163 M
(fragment) s
5 155 M
(          A portion of a logical unit of data, in particular an internet) s
5 147 M
(          fragment is a portion of an internet datagram.) s
5 139 M
( ) s
5 131 M
(FTP) s
5 123 M
(          A file transfer protocol.) s
5 115 M
( ) s
5 107 M
( ) s
5 99 M
( ) s
5 91 M
( ) s
5 83 M
( ) s
5 75 M
(                                                               [Page 79]) s
377 531 M
( ) s
377 523 M
(                                                          September 1981) s
377 515 M
(Transmission Control Protocol) s
377 507 M
(Glossary) s
377 499 M
( ) s
377 491 M
( ) s
377 483 M
( ) s
377 475 M
(header) s
377 467 M
(          Control information at the beginning of a message, segment,) s
377 459 M
(          fragment, packet or block of data.) s
377 451 M
( ) s
377 443 M
(host) s
377 435 M
(          A computer.  In particular a source or destination of messages) s
377 427 M
(          from the point of view of the communication network.) s
377 419 M
( ) s
377 411 M
(Identification) s
377 403 M
(          An Internet Protocol field.  This identifying value assigned) s
377 395 M
(          by the sender aids in assembling the fragments of a datagram.) s
377 387 M
( ) s
377 379 M
(IMP) s
377 371 M
(          The Interface Message Processor, the packet switch of the) s
377 363 M
(          ARPANET.) s
377 355 M
( ) s
377 347 M
(internet address) s
377 339 M
(          A source or destination address specific to the host level.) s
377 331 M
( ) s
377 323 M
(internet datagram) s
377 315 M
(          The unit of data exchanged between an internet module and the) s
377 307 M
(          higher level protocol together with the internet header.) s
377 299 M
( ) s
377 291 M
(internet fragment) s
377 283 M
(          A portion of the data of an internet datagram with an internet) s
377 275 M
(          header.) s
377 267 M
( ) s
377 259 M
(IP) s
377 251 M
(          Internet Protocol.) s
377 243 M
( ) s
377 235 M
(IRS) s
377 227 M
(          The Initial Receive Sequence number.  The first sequence) s
377 219 M
(          number used by the sender on a connection.) s
377 211 M
( ) s
377 203 M
(ISN) s
377 195 M
(          The Initial Sequence Number.  The first sequence number used) s
377 187 M
(          on a connection, \(either ISS or IRS\).  Selected on a clock) s
377 179 M
(          based procedure.) s
377 171 M
( ) s
377 163 M
(ISS) s
377 155 M
(          The Initial Send Sequence number.  The first sequence number) s
377 147 M
(          used by the sender on a connection.) s
377 139 M
( ) s
377 131 M
(leader) s
377 123 M
(          Control information at the beginning of a message or block of) s
377 115 M
(          data.  In particular, in the ARPANET, the control information) s
377 107 M
(          on an ARPANET message at the host-IMP interface.) s
377 99 M
( ) s
377 91 M
( ) s
377 83 M
( ) s
377 75 M
([Page 80]                                                               ) s
_R
S
%%Page: (44) 44
%%BeginPageSetup
_S
90 rotate
24 -588 translate
/pagenum 44 def
/fname (rfc793.txt) def
/fdir () def
/ftail (rfc793.txt) def
% User defined strings:
/fmodstr (Thu Aug %2d 13:52:57 2000) def
%%EndPageSetup
do_header
5 531 M
( ) s
5 523 M
(September 1981                                                          ) s
5 515 M
(                                           Transmission Control Protocol) s
5 507 M
(                                                                Glossary) s
5 499 M
( ) s
5 491 M
( ) s
5 483 M
( ) s
5 475 M
(left sequence) s
5 467 M
(          This is the next sequence number to be acknowledged by the) s
5 459 M
(          data receiving TCP \(or the lowest currently unacknowledged) s
5 451 M
(          sequence number\) and is sometimes referred to as the left edge) s
5 443 M
(          of the send window.) s
5 435 M
( ) s
5 427 M
(local packet) s
5 419 M
(          The unit of transmission within a local network.) s
5 411 M
( ) s
5 403 M
(module) s
5 395 M
(          An implementation, usually in software, of a protocol or other) s
5 387 M
(          procedure.) s
5 379 M
( ) s
5 371 M
(MSL) s
5 363 M
(          Maximum Segment Lifetime, the time a TCP segment can exist in) s
5 355 M
(          the internetwork system.  Arbitrarily defined to be 2 minutes.) s
5 347 M
( ) s
5 339 M
(octet) s
5 331 M
(          An eight bit byte.) s
5 323 M
( ) s
5 315 M
(Options) s
5 307 M
(          An Option field may contain several options, and each option) s
5 299 M
(          may be several octets in length.  The options are used) s
5 291 M
(          primarily in testing situations; for example, to carry) s
5 283 M
(          timestamps.  Both the Internet Protocol and TCP provide for) s
5 275 M
(          options fields.) s
5 267 M
( ) s
5 259 M
(packet) s
5 251 M
(          A package of data with a header which may or may not be) s
5 243 M
(          logically complete.  More often a physical packaging than a) s
5 235 M
(          logical packaging of data.) s
5 227 M
( ) s
5 219 M
(port) s
5 211 M
(          The portion of a socket that specifies which logical input or) s
5 203 M
(          output channel of a process is associated with the data.) s
5 195 M
( ) s
5 187 M
(process) s
5 179 M
(          A program in execution.  A source or destination of data from) s
5 171 M
(          the point of view of the TCP or other host-to-host protocol.) s
5 163 M
( ) s
5 155 M
(PUSH) s
5 147 M
(          A control bit occupying no sequence space, indicating that) s
5 139 M
(          this segment contains data that must be pushed through to the) s
5 131 M
(          receiving user.) s
5 123 M
( ) s
5 115 M
(RCV.NXT) s
5 107 M
(          receive next sequence number) s
5 99 M
( ) s
5 91 M
( ) s
5 83 M
( ) s
5 75 M
(                                                               [Page 81]) s
377 531 M
( ) s
377 523 M
(                                                          September 1981) s
377 515 M
(Transmission Control Protocol) s
377 507 M
(Glossary) s
377 499 M
( ) s
377 491 M
( ) s
377 483 M
( ) s
377 475 M
(RCV.UP) s
377 467 M
(          receive urgent pointer) s
377 459 M
( ) s
377 451 M
(RCV.WND) s
377 443 M
(          receive window) s
377 435 M
( ) s
377 427 M
(receive next sequence number) s
377 419 M
(          This is the next sequence number the local TCP is expecting to) s
377 411 M
(          receive.) s
377 403 M
( ) s
377 395 M
(receive window) s
377 387 M
(          This represents the sequence numbers the local \(receiving\) TCP) s
377 379 M
(          is willing to receive.  Thus, the local TCP considers that) s
377 371 M
(          segments overlapping the range RCV.NXT to) s
377 363 M
(          RCV.NXT + RCV.WND - 1 carry acceptable data or control.) s
377 355 M
(          Segments containing sequence numbers entirely outside of this) s
377 347 M
(          range are considered duplicates and discarded.) s
377 339 M
( ) s
377 331 M
(RST) s
377 323 M
(          A control bit \(reset\), occupying no sequence space, indicating) s
377 315 M
(          that the receiver should delete the connection without further) s
377 307 M
(          interaction.  The receiver can determine, based on the) s
377 299 M
(          sequence number and acknowledgment fields of the incoming) s
377 291 M
(          segment, whether it should honor the reset command or ignore) s
377 283 M
(          it.  In no case does receipt of a segment containing RST give) s
377 275 M
(          rise to a RST in response.) s
377 267 M
( ) s
377 259 M
(RTP) s
377 251 M
(          Real Time Protocol:  A host-to-host protocol for communication) s
377 243 M
(          of time critical information.) s
377 235 M
( ) s
377 227 M
(SEG.ACK) s
377 219 M
(          segment acknowledgment) s
377 211 M
( ) s
377 203 M
(SEG.LEN) s
377 195 M
(          segment length) s
377 187 M
( ) s
377 179 M
(SEG.PRC) s
377 171 M
(          segment precedence value) s
377 163 M
( ) s
377 155 M
(SEG.SEQ) s
377 147 M
(          segment sequence) s
377 139 M
( ) s
377 131 M
(SEG.UP) s
377 123 M
(          segment urgent pointer field) s
377 115 M
( ) s
377 107 M
( ) s
377 99 M
( ) s
377 91 M
( ) s
377 83 M
( ) s
377 75 M
([Page 82]                                                               ) s
_R
S
%%Page: (45) 45
%%BeginPageSetup
_S
90 rotate
24 -588 translate
/pagenum 45 def
/fname (rfc793.txt) def
/fdir () def
/ftail (rfc793.txt) def
% User defined strings:
/fmodstr (Thu Aug %2d 13:52:57 2000) def
%%EndPageSetup
do_header
5 531 M
( ) s
5 523 M
(September 1981                                                          ) s
5 515 M
(                                           Transmission Control Protocol) s
5 507 M
(                                                                Glossary) s
5 499 M
( ) s
5 491 M
( ) s
5 483 M
( ) s
5 475 M
(SEG.WND) s
5 467 M
(          segment window field) s
5 459 M
( ) s
5 451 M
(segment) s
5 443 M
(          A logical unit of data, in particular a TCP segment is the) s
5 435 M
(          unit of data transfered between a pair of TCP modules.) s
5 427 M
( ) s
5 419 M
(segment acknowledgment) s
5 411 M
(          The sequence number in the acknowledgment field of the) s
5 403 M
(          arriving segment.) s
5 395 M
( ) s
5 387 M
(segment length) s
5 379 M
(          The amount of sequence number space occupied by a segment,) s
5 371 M
(          including any controls which occupy sequence space.) s
5 363 M
( ) s
5 355 M
(segment sequence) s
5 347 M
(          The number in the sequence field of the arriving segment.) s
5 339 M
( ) s
5 331 M
(send sequence) s
5 323 M
(          This is the next sequence number the local \(sending\) TCP will) s
5 315 M
(          use on the connection.  It is initially selected from an) s
5 307 M
(          initial sequence number curve \(ISN\) and is incremented for) s
5 299 M
(          each octet of data or sequenced control transmitted.) s
5 291 M
( ) s
5 283 M
(send window) s
5 275 M
(          This represents the sequence numbers which the remote) s
5 267 M
(          \(receiving\) TCP is willing to receive.  It is the value of the) s
5 259 M
(          window field specified in segments from the remote \(data) s
5 251 M
(          receiving\) TCP.  The range of new sequence numbers which may) s
5 243 M
(          be emitted by a TCP lies between SND.NXT and) s
5 235 M
(          SND.UNA + SND.WND - 1. \(Retransmissions of sequence numbers) s
5 227 M
(          between SND.UNA and SND.NXT are expected, of course.\)) s
5 219 M
( ) s
5 211 M
(SND.NXT) s
5 203 M
(          send sequence) s
5 195 M
( ) s
5 187 M
(SND.UNA) s
5 179 M
(          left sequence) s
5 171 M
( ) s
5 163 M
(SND.UP) s
5 155 M
(          send urgent pointer) s
5 147 M
( ) s
5 139 M
(SND.WL1) s
5 131 M
(          segment sequence number at last window update) s
5 123 M
( ) s
5 115 M
(SND.WL2) s
5 107 M
(          segment acknowledgment number at last window update) s
5 99 M
( ) s
5 91 M
( ) s
5 83 M
( ) s
5 75 M
(                                                               [Page 83]) s
377 531 M
( ) s
377 523 M
(                                                          September 1981) s
377 515 M
(Transmission Control Protocol) s
377 507 M
(Glossary) s
377 499 M
( ) s
377 491 M
( ) s
377 483 M
( ) s
377 475 M
(SND.WND) s
377 467 M
(          send window) s
377 459 M
( ) s
377 451 M
(socket) s
377 443 M
(          An address which specifically includes a port identifier, that) s
377 435 M
(          is, the concatenation of an Internet Address with a TCP port.) s
377 427 M
( ) s
377 419 M
(Source Address) s
377 411 M
(          The source address, usually the network and host identifiers.) s
377 403 M
( ) s
377 395 M
(SYN) s
377 387 M
(          A control bit in the incoming segment, occupying one sequence) s
377 379 M
(          number, used at the initiation of a connection, to indicate) s
377 371 M
(          where the sequence numbering will start.) s
377 363 M
( ) s
377 355 M
(TCB) s
377 347 M
(          Transmission control block, the data structure that records) s
377 339 M
(          the state of a connection.) s
377 331 M
( ) s
377 323 M
(TCB.PRC) s
377 315 M
(          The precedence of the connection.) s
377 307 M
( ) s
377 299 M
(TCP) s
377 291 M
(          Transmission Control Protocol:  A host-to-host protocol for) s
377 283 M
(          reliable communication in internetwork environments.) s
377 275 M
( ) s
377 267 M
(TOS) s
377 259 M
(          Type of Service, an Internet Protocol field.) s
377 251 M
( ) s
377 243 M
(Type of Service) s
377 235 M
(          An Internet Protocol field which indicates the type of service) s
377 227 M
(          for this internet fragment.) s
377 219 M
( ) s
377 211 M
(URG) s
377 203 M
(          A control bit \(urgent\), occupying no sequence space, used to) s
377 195 M
(          indicate that the receiving user should be notified to do) s
377 187 M
(          urgent processing as long as there is data to be consumed with) s
377 179 M
(          sequence numbers less than the value indicated in the urgent) s
377 171 M
(          pointer.) s
377 163 M
( ) s
377 155 M
(urgent pointer) s
377 147 M
(          A control field meaningful only when the URG bit is on.  This) s
377 139 M
(          field communicates the value of the urgent pointer which) s
377 131 M
(          indicates the data octet associated with the sending user's) s
377 123 M
(          urgent call.) s
377 115 M
( ) s
377 107 M
(          ) s
377 99 M
( ) s
377 91 M
( ) s
377 83 M
( ) s
377 75 M
([Page 84]                                                               ) s
_R
S
%%Page: (46) 46
%%BeginPageSetup
_S
90 rotate
24 -588 translate
/pagenum 46 def
/fname (rfc793.txt) def
/fdir () def
/ftail (rfc793.txt) def
% User defined strings:
/fmodstr (Thu Aug %2d 13:52:57 2000) def
%%EndPageSetup
do_header
5 531 M
( ) s
5 523 M
(September 1981                                                          ) s
5 515 M
(                                           Transmission Control Protocol) s
5 507 M
( ) s
5 499 M
( ) s
5 491 M
( ) s
5 483 M
(                               REFERENCES) s
5 475 M
( ) s
5 467 M
( ) s
5 459 M
( ) s
5 451 M
([1]  Cerf, V., and R. Kahn, "A Protocol for Packet Network) s
5 443 M
(     Intercommunication", IEEE Transactions on Communications,) s
5 435 M
(     Vol. COM-22, No. 5, pp 637-648, May 1974.) s
5 427 M
( ) s
5 419 M
([2]  Postel, J. \(ed.\), "Internet Protocol - DARPA Internet Program) s
5 411 M
(     Protocol Specification", RFC 791, USC/Information Sciences) s
5 403 M
(     Institute, September 1981.) s
5 395 M
( ) s
5 387 M
([3]  Dalal, Y. and C. Sunshine, "Connection Management in Transport) s
5 379 M
(     Protocols", Computer Networks, Vol. 2, No. 6, pp. 454-473,) s
5 371 M
(     December 1978.) s
5 363 M
( ) s
5 355 M
([4]  Postel, J., "Assigned Numbers", RFC 790, USC/Information Sciences) s
5 347 M
(     Institute, September 1981.) s
5 339 M
( ) s
5 331 M
( ) s
5 323 M
( ) s
5 315 M
( ) s
5 307 M
( ) s
5 299 M
( ) s
5 291 M
( ) s
5 283 M
( ) s
5 275 M
( ) s
5 267 M
( ) s
5 259 M
( ) s
5 251 M
( ) s
5 243 M
( ) s
5 235 M
( ) s
5 227 M
( ) s
5 219 M
( ) s
5 211 M
( ) s
5 203 M
( ) s
5 195 M
( ) s
5 187 M
( ) s
5 179 M
( ) s
5 171 M
( ) s
5 163 M
( ) s
5 155 M
( ) s
5 147 M
( ) s
5 139 M
( ) s
5 131 M
( ) s
5 123 M
( ) s
5 115 M
( ) s
5 107 M
( ) s
5 99 M
( ) s
5 91 M
( ) s
5 83 M
( ) s
5 75 M
(                                                               [Page 85]) s
_R
S
%%Trailer
%%Pages: 46
%%DocumentNeededResources: font Courier-Bold Courier 
%%EOF
